2026-01-29 14:13:24.230 -03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2026-01-29 14:13:24.582 -03:00 [DBG] The index {'ProductoId'} was not created on entity type 'Stock' as the properties are already covered by the index {'ProductoId', 'SucursalId'}.
2026-01-29 14:13:24.584 -03:00 [DBG] The index {'EmpresaId'} was not created on entity type 'Usuario' as the properties are already covered by the index {'EmpresaId', 'Email'}.
2026-01-29 14:13:24.585 -03:00 [DBG] The index {'EmpresaId'} was not created on entity type 'Usuario' as the properties are already covered by the index {'EmpresaId', 'Rut'}.
2026-01-29 14:13:24.660 -03:00 [DBG] The property 'MovimientoStock.DevolucionId' was created in shadow state because there are no eligible CLR members with a matching name.
2026-01-29 14:13:24.721 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:13:24.733 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:13:24.750 -03:00 [DBG] Created DbConnection. (16ms).
2026-01-29 14:13:24.753 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:13:24.861 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:13:24.865 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:13:24.868 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2026-01-29 14:13:24.870 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2026-01-29 14:13:24.878 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:13:24.900 -03:00 [INF] Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:13:24.927 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:13:24.933 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 28ms reading results.
2026-01-29 14:13:24.935 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:13:24.938 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (2ms).
2026-01-29 14:13:25.051 -03:00 [DBG] Migrating using database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:13:25.054 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:13:25.057 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:13:25.092 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:13:25.093 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:13:25.094 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (1ms).
2026-01-29 14:13:25.095 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:13:25.096 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:13:25.126 -03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2026-01-29 14:13:25.127 -03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2026-01-29 14:13:25.128 -03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2026-01-29 14:13:25.128 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2026-01-29 14:13:25.139 -03:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2026-01-29 14:13:25.143 -03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2026-01-29 14:13:25.146 -03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2026-01-29 14:13:25.147 -03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2026-01-29 14:13:25.148 -03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2026-01-29 14:13:25.148 -03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2026-01-29 14:13:25.149 -03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2026-01-29 14:13:25.150 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2026-01-29 14:13:25.152 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2026-01-29 14:13:25.153 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:13:25.153 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:13:25.154 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:13:25.154 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:13:25.156 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:13:25.157 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:13:25.158 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 14:13:25.163 -03:00 [INF] No migrations were applied. The database is already up to date.
2026-01-29 14:13:25.164 -03:00 [DBG] Committing transaction.
2026-01-29 14:13:25.168 -03:00 [DBG] Committed transaction.
2026-01-29 14:13:25.169 -03:00 [DBG] Disposing transaction.
2026-01-29 14:13:25.169 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:13:25.170 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:13:25.171 -03:00 [INF] Database migrations applied successfully
2026-01-29 14:13:25.173 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:13:25.174 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:13:25.175 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:13:25.217 -03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2026-01-29 14:13:25.258 -03:00 [DBG] Registered SignalR Protocol: json, implemented by Microsoft.AspNetCore.SignalR.Protocol.JsonHubProtocol.
2026-01-29 14:13:25.274 -03:00 [INF] Project Gon API iniciada en ambiente: Development
2026-01-29 14:13:25.276 -03:00 [DBG] Hosting starting
2026-01-29 14:13:25.288 -03:00 [INF] User profile is available. Using 'C:\Users\Jossan\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2026-01-29 14:13:25.295 -03:00 [DBG] Reading data from file 'C:\Users\Jossan\AppData\Local\ASP.NET\DataProtection-Keys\key-7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c.xml'.
2026-01-29 14:13:25.313 -03:00 [DBG] Found key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c}.
2026-01-29 14:13:25.323 -03:00 [DBG] Considering key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c} with expiration date 2026-04-28 18:20:11Z as default key.
2026-01-29 14:13:25.326 -03:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=9.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2026-01-29 14:13:25.327 -03:00 [DBG] Decrypting secret element using Windows DPAPI.
2026-01-29 14:13:25.328 -03:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=9.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2026-01-29 14:13:25.330 -03:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2026-01-29 14:13:25.332 -03:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2026-01-29 14:13:25.333 -03:00 [DBG] Using key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c} as the default key.
2026-01-29 14:13:25.333 -03:00 [DBG] Key ring with default key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c} was loaded during application startup.
2026-01-29 14:13:25.337 -03:00 [DBG] Middleware loaded
2026-01-29 14:13:25.338 -03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16515 B).
2026-01-29 14:13:25.341 -03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2026-01-29 14:13:25.409 -03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2026-01-29 14:13:25.410 -03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2026-01-29 14:13:25.413 -03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2026-01-29 14:13:25.451 -03:00 [INF] Now listening on: https://localhost:7058
2026-01-29 14:13:25.452 -03:00 [INF] Now listening on: http://localhost:5070
2026-01-29 14:13:25.453 -03:00 [DBG] Loaded hosting startup assembly Project_Gon.Api
2026-01-29 14:13:25.453 -03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2026-01-29 14:13:25.454 -03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2026-01-29 14:13:25.454 -03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2026-01-29 14:13:25.458 -03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2026-01-29 14:13:25.463 -03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2026-01-29 14:13:25.490 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2026-01-29 14:13:25.490 -03:00 [DBG] Connection id "0HNIVB6RAVRMQ" accepted.
2026-01-29 14:13:25.490 -03:00 [INF] Hosting environment: Development
2026-01-29 14:13:25.491 -03:00 [DBG] Connection id "0HNIVB6RAVRMQ" started.
2026-01-29 14:13:25.492 -03:00 [INF] Content root path: C:\Proyectos\Project_Gon\Project_Gon.Api
2026-01-29 14:13:25.494 -03:00 [DBG] Hosting started
2026-01-29 14:13:25.530 -03:00 [DBG] Connection 0HNIVB6RAVRMQ established using the following protocol: "Tls12"
2026-01-29 14:13:25.557 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7058/api/usuarios - application/json 69
2026-01-29 14:13:25.576 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios'
2026-01-29 14:13:25.577 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)' with route pattern 'api/Usuarios' is valid for the request path '/api/usuarios'
2026-01-29 14:13:25.579 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:13:25.584 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:13:25.614 -03:00 [INF] Failed to validate the token.
System.ArgumentException: IDX14102: Unable to decode the header '[PII of type 'Microsoft.IdentityModel.Logging.SecurityArtifact' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' as Base64Url encoded string.
 ---> System.FormatException: IDX10400: Unable to decode: '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' as Base64url encoded string.
   at Microsoft.IdentityModel.Tokens.Base64UrlEncoding.ValidateAndGetOutputSize(ReadOnlySpan`1 strSpan, Int32 offset, Int32 length)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.CreateClaimSet(ReadOnlySpan`1 strSpan, Int32 startIndex, Int32 length, Boolean createHeaderClaimSet)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(ReadOnlyMemory`1 encodedTokenMemory)
   --- End of inner exception stack trace ---
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(ReadOnlyMemory`1 encodedTokenMemory)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
2026-01-29 14:13:25.624 -03:00 [WRN] JWT Authentication failed: IDX14102: Unable to decode the header '[PII of type 'Microsoft.IdentityModel.Logging.SecurityArtifact' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' as Base64Url encoded string.
2026-01-29 14:13:25.625 -03:00 [INF] Bearer was not authenticated. Failure message: IDX14102: Unable to decode the header '[PII of type 'Microsoft.IdentityModel.Logging.SecurityArtifact' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' as Base64Url encoded string.
2026-01-29 14:13:25.628 -03:00 [DBG] Policy authentication schemes  did not succeed
2026-01-29 14:13:25.630 -03:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2026-01-29 14:13:25.633 -03:00 [WRN] JWT Challenge triggered: invalid_token
2026-01-29 14:13:25.634 -03:00 [INF] AuthenticationScheme: Bearer was challenged.
2026-01-29 14:13:25.635 -03:00 [INF] HTTP GET /api/usuarios responded 401 in 48.6633 ms
2026-01-29 14:13:25.640 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7058/api/usuarios - 401 0 null 84.1182ms
2026-01-29 14:13:25.642 -03:00 [DBG] Connection id "0HNIVB6RAVRMQ", Request id "0HNIVB6RAVRMQ:00000001": started reading request body.
2026-01-29 14:13:25.643 -03:00 [DBG] Connection id "0HNIVB6RAVRMQ", Request id "0HNIVB6RAVRMQ:00000001": done reading request body.
2026-01-29 14:14:36.966 -03:00 [INF] Request starting HTTP/2 POST https://localhost:7058/api/auth/login - application/json 69
2026-01-29 14:14:36.969 -03:00 [DBG] 1 candidate(s) found for the request path '/api/auth/login'
2026-01-29 14:14:36.969 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)' with route pattern 'api/Auth/login' is valid for the request path '/api/auth/login'
2026-01-29 14:14:36.970 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)'
2026-01-29 14:14:36.971 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:14:36.973 -03:00 [INF] Failed to validate the token.
System.ArgumentException: IDX14102: Unable to decode the header '[PII of type 'Microsoft.IdentityModel.Logging.SecurityArtifact' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' as Base64Url encoded string.
 ---> System.FormatException: IDX10400: Unable to decode: '[PII of type 'System.String' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' as Base64url encoded string.
   at Microsoft.IdentityModel.Tokens.Base64UrlEncoding.ValidateAndGetOutputSize(ReadOnlySpan`1 strSpan, Int32 offset, Int32 length)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.CreateClaimSet(ReadOnlySpan`1 strSpan, Int32 startIndex, Int32 length, Boolean createHeaderClaimSet)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(ReadOnlyMemory`1 encodedTokenMemory)
   --- End of inner exception stack trace ---
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken.ReadToken(ReadOnlyMemory`1 encodedTokenMemory)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebToken..ctor(String jwtEncodedString)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ReadToken(String token, TokenValidationParameters validationParameters)
2026-01-29 14:14:36.975 -03:00 [WRN] JWT Authentication failed: IDX14102: Unable to decode the header '[PII of type 'Microsoft.IdentityModel.Logging.SecurityArtifact' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' as Base64Url encoded string.
2026-01-29 14:14:36.976 -03:00 [INF] Bearer was not authenticated. Failure message: IDX14102: Unable to decode the header '[PII of type 'Microsoft.IdentityModel.Logging.SecurityArtifact' is hidden. For more details, see https://aka.ms/IdentityModel/PII.]' as Base64Url encoded string.
2026-01-29 14:14:36.977 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)'
2026-01-29 14:14:36.987 -03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Project_Gon.Core.DTOs.Auth.LoginDto) on controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api).
2026-01-29 14:14:36.989 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:14:36.990 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:14:36.991 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:14:36.992 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:14:36.993 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:14:36.994 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api)
2026-01-29 14:14:37.074 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api)
2026-01-29 14:14:37.077 -03:00 [DBG] Attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto' ...
2026-01-29 14:14:37.078 -03:00 [DBG] Attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto' using the name '' in request data ...
2026-01-29 14:14:37.080 -03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2026-01-29 14:14:37.083 -03:00 [DBG] Connection id "0HNIVB6RAVRMQ", Request id "0HNIVB6RAVRMQ:00000003": started reading request body.
2026-01-29 14:14:37.084 -03:00 [DBG] Connection id "0HNIVB6RAVRMQ", Request id "0HNIVB6RAVRMQ:00000003": done reading request body.
2026-01-29 14:14:37.088 -03:00 [DBG] JSON input formatter succeeded, deserializing to type 'Project_Gon.Core.DTOs.Auth.LoginDto'
2026-01-29 14:14:37.088 -03:00 [DBG] Done attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto'.
2026-01-29 14:14:37.089 -03:00 [DBG] Done attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto'.
2026-01-29 14:14:37.090 -03:00 [DBG] Attempting to validate the bound parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto' ...
2026-01-29 14:14:37.109 -03:00 [DBG] Done attempting to validate the bound parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto'.
2026-01-29 14:14:37.112 -03:00 [INF] [LOGIN] Intento de login con: vendedor@empresa.com
2026-01-29 14:14:37.114 -03:00 [INF] [FIND] Buscando por EMAIL: vendedor@empresa.com
2026-01-29 14:14:37.129 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:14:37.165 -03:00 [DBG] Compiling query expression: 
'DbSet<Usuario>()
    .Where(u => u.Email == __emailOrRut_0 && u.Activo)
    .AsNoTracking()
    .FirstOrDefault()'
2026-01-29 14:14:37.298 -03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Usuario>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Usuario>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
            SELECT TOP(1) u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt
            FROM Usuarios AS u
            WHERE (u.Email == @__emailOrRut_0) && u.Activo) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
            SELECT TOP(1) u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt
            FROM Usuarios AS u
            WHERE (u.Email == @__emailOrRut_0) && u.Activo, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Usuario entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Usuario instance1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Usuario);
                (object)dataReader.GetInt32(0) != null ? 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]: 
                            {
                                return 
                                {
                                    Usuario instance;
                                    instance = new Usuario();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Activo>k__BackingField = dataReader.GetBoolean(1);
                                    instance.<Apellido>k__BackingField = dataReader.GetString(2);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(3);
                                    instance.<Email>k__BackingField = dataReader.IsDBNull(4) ? default(string) : dataReader.GetString(4);
                                    instance.<EmpresaId>k__BackingField = dataReader.GetInt32(5);
                                    instance.<Nombre>k__BackingField = dataReader.GetString(6);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(7);
                                    instance.<Rol>k__BackingField = Invoke(((EnumToNumberConverter<RolUsuario, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Usuario.Rol (RolUsuario) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindProperty("Rol")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(8));
                                    instance.<Rut>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                    instance.<SucursalId>k__BackingField = dataReader.IsDBNull(10) ? default(int?) : (int?)dataReader.GetInt32(10);
                                    instance.<UltimoAcceso>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(11);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(12) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: NoTracking, 
                                        structuralType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Usuario)
                    }
                    ;
                    return instance1;
                } : 
                {
                    object[] keyValues1;
                    keyValues1 = new object[]{ (object)dataReader.GetInt32(0) };
                    return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                        entityType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")], 
                        properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindPrimaryKey().Properties], 
                        keyValues: keyValues1);
                };
                return instance1;
            };
            return entity;
        }, 
        contextType: Project_Gon.Infrastructure.Data.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2026-01-29 14:14:37.326 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:14:37.327 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 14:14:37.328 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:14:37.330 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:14:37.330 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:14:37.331 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:14:37.333 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2026-01-29 14:14:37.335 -03:00 [DBG] Executing DbCommand [Parameters=[@__emailOrRut_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt"
FROM "Usuarios" AS u
WHERE u."Email" = @__emailOrRut_0 AND u."Activo"
LIMIT 1
2026-01-29 14:14:37.347 -03:00 [INF] Executed DbCommand (13ms) [Parameters=[@__emailOrRut_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt"
FROM "Usuarios" AS u
WHERE u."Email" = @__emailOrRut_0 AND u."Activo"
LIMIT 1
2026-01-29 14:14:37.356 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:14:37.357 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 8ms reading results.
2026-01-29 14:14:37.359 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:14:37.360 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:14:37.361 -03:00 [INF] [FIND] Usuario encontrado - ID: 3, RUT: 12345678-9
2026-01-29 14:14:37.367 -03:00 [DBG] Compiling query expression: 
'DbSet<Empresa>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2026-01-29 14:14:37.376 -03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Empresa>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Empresa>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Empresa.Activo (bool) Required, 1], [Property: Empresa.Ciudad (string), 2], [Property: Empresa.CreatedAt (DateTime) Required, 3], [Property: Empresa.Direccion (string), 4], [Property: Empresa.Nombre (string) Required MaxLength(255), 5], [Property: Empresa.Region (string), 6], [Property: Empresa.Rut (string), 7], [Property: Empresa.UpdatedAt (DateTime?), 8] }
            SELECT TOP(1) e.Id, e.Activo, e.Ciudad, e.CreatedAt, e.Direccion, e.Nombre, e.Region, e.Rut, e.UpdatedAt
            FROM Empresas AS e
            WHERE e.Id == @__p_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Empresa.Activo (bool) Required, 1], [Property: Empresa.Ciudad (string), 2], [Property: Empresa.CreatedAt (DateTime) Required, 3], [Property: Empresa.Direccion (string), 4], [Property: Empresa.Nombre (string) Required MaxLength(255), 5], [Property: Empresa.Region (string), 6], [Property: Empresa.Rut (string), 7], [Property: Empresa.UpdatedAt (DateTime?), 8] }
            SELECT TOP(1) e.Id, e.Activo, e.Ciudad, e.CreatedAt, e.Direccion, e.Nombre, e.Region, e.Rut, e.UpdatedAt
            FROM Empresas AS e
            WHERE e.Id == @__p_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Empresa entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Empresa instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Empresa);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Empresa.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Empresa)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")]: 
                            {
                                return 
                                {
                                    Empresa instance;
                                    instance = new Empresa();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Activo>k__BackingField = dataReader.GetBoolean(1);
                                    instance.<Ciudad>k__BackingField = dataReader.IsDBNull(2) ? default(string) : dataReader.GetString(2);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(3);
                                    instance.<Direccion>k__BackingField = dataReader.IsDBNull(4) ? default(string) : dataReader.GetString(4);
                                    instance.<Nombre>k__BackingField = dataReader.GetString(5);
                                    instance.<Region>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                    instance.<Rut>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Empresa)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Project_Gon.Infrastructure.Data.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2026-01-29 14:14:37.383 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:14:37.384 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:14:37.384 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:14:37.385 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:14:37.386 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:14:37.386 -03:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt"
FROM "Empresas" AS e
WHERE e."Id" = @__p_0
LIMIT 1
2026-01-29 14:14:37.390 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt"
FROM "Empresas" AS e
WHERE e."Id" = @__p_0
LIMIT 1
2026-01-29 14:14:37.413 -03:00 [DBG] Context 'AppDbContext' started tracking 'Empresa' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2026-01-29 14:14:37.431 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:14:37.431 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 40ms reading results.
2026-01-29 14:14:37.432 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:14:37.433 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:14:37.435 -03:00 [DBG] Compiling query expression: 
'DbSet<Sucursal>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2026-01-29 14:14:37.439 -03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Sucursal>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Sucursal>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Sucursal.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Sucursal.Activo (bool) Required, 1], [Property: Sucursal.Ciudad (string), 2], [Property: Sucursal.CreatedAt (DateTime) Required, 3], [Property: Sucursal.Direccion (string), 4], [Property: Sucursal.EmpresaId (int) Required FK Index, 5], [Property: Sucursal.Nombre (string) Required MaxLength(255), 6], [Property: Sucursal.Region (string), 7], [Property: Sucursal.Telefono (string), 8], [Property: Sucursal.UpdatedAt (DateTime?), 9] }
            SELECT TOP(1) s.Id, s.Activo, s.Ciudad, s.CreatedAt, s.Direccion, s.EmpresaId, s.Nombre, s.Region, s.Telefono, s.UpdatedAt
            FROM Sucursales AS s
            WHERE s.Id == @__p_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Sucursal.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Sucursal.Activo (bool) Required, 1], [Property: Sucursal.Ciudad (string), 2], [Property: Sucursal.CreatedAt (DateTime) Required, 3], [Property: Sucursal.Direccion (string), 4], [Property: Sucursal.EmpresaId (int) Required FK Index, 5], [Property: Sucursal.Nombre (string) Required MaxLength(255), 6], [Property: Sucursal.Region (string), 7], [Property: Sucursal.Telefono (string), 8], [Property: Sucursal.UpdatedAt (DateTime?), 9] }
            SELECT TOP(1) s.Id, s.Activo, s.Ciudad, s.CreatedAt, s.Direccion, s.EmpresaId, s.Nombre, s.Region, s.Telefono, s.UpdatedAt
            FROM Sucursales AS s
            WHERE s.Id == @__p_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Sucursal entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Sucursal instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Sucursal);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Sucursal.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Sucursal)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")]: 
                            {
                                return 
                                {
                                    Sucursal instance;
                                    instance = new Sucursal();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Activo>k__BackingField = dataReader.GetBoolean(1);
                                    instance.<Ciudad>k__BackingField = dataReader.IsDBNull(2) ? default(string) : dataReader.GetString(2);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(3);
                                    instance.<Direccion>k__BackingField = dataReader.IsDBNull(4) ? default(string) : dataReader.GetString(4);
                                    instance.<EmpresaId>k__BackingField = dataReader.GetInt32(5);
                                    instance.<Nombre>k__BackingField = dataReader.GetString(6);
                                    instance.<Region>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<Telefono>k__BackingField = dataReader.IsDBNull(8) ? default(string) : dataReader.GetString(8);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(9) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(9);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Sucursal)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Project_Gon.Infrastructure.Data.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2026-01-29 14:14:37.446 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:14:37.447 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:14:37.447 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:14:37.448 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:14:37.449 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:14:37.449 -03:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Sucursales" AS s
WHERE s."Id" = @__p_0
LIMIT 1
2026-01-29 14:14:37.452 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Sucursales" AS s
WHERE s."Id" = @__p_0
LIMIT 1
2026-01-29 14:14:37.470 -03:00 [DBG] Context 'AppDbContext' started tracking 'Sucursal' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2026-01-29 14:14:37.479 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:14:37.479 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 25ms reading results.
2026-01-29 14:14:37.480 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:14:37.481 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:14:37.482 -03:00 [INF] [LOGIN] Usuario encontrado: true
2026-01-29 14:14:37.482 -03:00 [INF] [LOGIN] Usuario ID: 3, RUT: 12345678-9, Email: vendedor@empresa.com, Activo: true
2026-01-29 14:14:37.483 -03:00 [INF] [LOGIN] Verificando contrasea para usuario ID: 3
2026-01-29 14:14:38.204 -03:00 [INF] [LOGIN] Password vlido: true
2026-01-29 14:14:38.239 -03:00 [DBG] Context 'AppDbContext' started tracking 'Usuario' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2026-01-29 14:14:38.242 -03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2026-01-29 14:14:38.244 -03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2026-01-29 14:14:38.260 -03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2026-01-29 14:14:38.296 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:14:38.297 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:14:38.299 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:14:38.299 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:14:38.301 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:14:38.301 -03:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?', @p2='?' (DbType = DateTime), @p3='?', @p4='?' (DbType = Int32), @p5='?', @p6='?', @p7='?' (DbType = Int32), @p8='?', @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Usuarios" SET "Activo" = @p0, "Apellido" = @p1, "CreatedAt" = @p2, "Email" = @p3, "EmpresaId" = @p4, "Nombre" = @p5, "PasswordHash" = @p6, "Rol" = @p7, "Rut" = @p8, "SucursalId" = @p9, "UltimoAcceso" = @p10, "UpdatedAt" = @p11
WHERE "Id" = @p12;
2026-01-29 14:14:38.306 -03:00 [INF] Executed DbCommand (5ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?', @p2='?' (DbType = DateTime), @p3='?', @p4='?' (DbType = Int32), @p5='?', @p6='?', @p7='?' (DbType = Int32), @p8='?', @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Usuarios" SET "Activo" = @p0, "Apellido" = @p1, "CreatedAt" = @p2, "Email" = @p3, "EmpresaId" = @p4, "Nombre" = @p5, "PasswordHash" = @p6, "Rol" = @p7, "Rut" = @p8, "SucursalId" = @p9, "UltimoAcceso" = @p10, "UpdatedAt" = @p11
WHERE "Id" = @p12;
2026-01-29 14:14:38.310 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:14:38.310 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 2ms reading results.
2026-01-29 14:14:38.311 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:14:38.312 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:14:38.316 -03:00 [DBG] An entity of type 'Usuario' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2026-01-29 14:14:38.319 -03:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2026-01-29 14:14:38.319 -03:00 [INF] [LOGIN] Login exitoso para usuario ID: 3
2026-01-29 14:14:38.335 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:14:38.338 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:14:38.338 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 14:14:38.339 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 14:14:38.340 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 14:14:38.340 -03:00 [INF] Executing OkObjectResult, writing value of type 'Project_Gon.Core.DTOs.Auth.LoginResponseDto'.
2026-01-29 14:14:38.349 -03:00 [INF] Executed action Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api) in 1353.533ms
2026-01-29 14:14:38.349 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)'
2026-01-29 14:14:38.350 -03:00 [INF] HTTP POST /api/auth/login responded 200 in 1378.9657 ms
2026-01-29 14:14:38.353 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:14:38.355 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:14:38.356 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (1ms).
2026-01-29 14:14:38.357 -03:00 [INF] Request finished HTTP/2 POST https://localhost:7058/api/auth/login - 200 null application/json; charset=utf-8 1391.0856ms
2026-01-29 14:15:35.771 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7058/api/auth/login - application/json 0
2026-01-29 14:15:35.773 -03:00 [DBG] 1 candidate(s) found for the request path '/api/auth/login'
2026-01-29 14:15:35.774 -03:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2026-01-29 14:15:35.774 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:15:35.794 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:15:35.795 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:15:35.796 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:15:35.797 -03:00 [INF] Executing endpoint '405 HTTP Method Not Supported'
2026-01-29 14:15:35.797 -03:00 [INF] Executed endpoint '405 HTTP Method Not Supported'
2026-01-29 14:15:35.798 -03:00 [INF] HTTP GET /api/auth/login responded 405 in 22.8713 ms
2026-01-29 14:15:35.799 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7058/api/auth/login - 405 0 null 27.3838ms
2026-01-29 14:17:13.153 -03:00 [INF] Request starting HTTP/2 POST https://localhost:7058/api/auth/login - application/json 0
2026-01-29 14:17:13.155 -03:00 [DBG] 1 candidate(s) found for the request path '/api/auth/login'
2026-01-29 14:17:13.155 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)' with route pattern 'api/Auth/login' is valid for the request path '/api/auth/login'
2026-01-29 14:17:13.157 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)'
2026-01-29 14:17:13.157 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:17:13.158 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:17:13.158 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:17:13.159 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:17:13.160 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)'
2026-01-29 14:17:13.160 -03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Project_Gon.Core.DTOs.Auth.LoginDto) on controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api).
2026-01-29 14:17:13.162 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:17:13.162 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:17:13.163 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:17:13.164 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:17:13.165 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:17:13.166 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api)
2026-01-29 14:17:13.169 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api)
2026-01-29 14:17:13.170 -03:00 [DBG] Attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto' ...
2026-01-29 14:17:13.171 -03:00 [DBG] Attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto' using the name '' in request data ...
2026-01-29 14:17:13.172 -03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2026-01-29 14:17:13.173 -03:00 [DBG] Done attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto'.
2026-01-29 14:17:13.174 -03:00 [DBG] Done attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto'.
2026-01-29 14:17:13.175 -03:00 [DBG] Attempting to validate the bound parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto' ...
2026-01-29 14:17:13.177 -03:00 [DBG] Done attempting to validate the bound parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto'.
2026-01-29 14:17:13.178 -03:00 [DBG] The request has model state errors, returning an error response.
2026-01-29 14:17:13.179 -03:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2026-01-29 14:17:13.179 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:17:13.181 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:17:13.181 -03:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2026-01-29 14:17:13.182 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2026-01-29 14:17:13.183 -03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2026-01-29 14:17:13.191 -03:00 [INF] Executed action Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api) in 25.62ms
2026-01-29 14:17:13.192 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)'
2026-01-29 14:17:13.192 -03:00 [INF] HTTP POST /api/auth/login responded 400 in 34.7033 ms
2026-01-29 14:17:13.193 -03:00 [INF] Request finished HTTP/2 POST https://localhost:7058/api/auth/login - 400 null application/problem+json; charset=utf-8 40.152ms
2026-01-29 14:17:28.367 -03:00 [INF] Request starting HTTP/2 POST https://localhost:7058/api/auth/login - application/json 0
2026-01-29 14:17:28.368 -03:00 [DBG] 1 candidate(s) found for the request path '/api/auth/login'
2026-01-29 14:17:28.369 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)' with route pattern 'api/Auth/login' is valid for the request path '/api/auth/login'
2026-01-29 14:17:28.370 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)'
2026-01-29 14:17:28.370 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:17:28.371 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:17:28.371 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:17:28.372 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:17:28.372 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)'
2026-01-29 14:17:28.373 -03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Project_Gon.Core.DTOs.Auth.LoginDto) on controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api).
2026-01-29 14:17:28.374 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:17:28.375 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:17:28.375 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:17:28.376 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:17:28.377 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:17:28.378 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api)
2026-01-29 14:17:28.380 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api)
2026-01-29 14:17:28.381 -03:00 [DBG] Attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto' ...
2026-01-29 14:17:28.382 -03:00 [DBG] Attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto' using the name '' in request data ...
2026-01-29 14:17:28.382 -03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2026-01-29 14:17:28.383 -03:00 [DBG] Done attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto'.
2026-01-29 14:17:28.384 -03:00 [DBG] Done attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto'.
2026-01-29 14:17:28.384 -03:00 [DBG] Attempting to validate the bound parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto' ...
2026-01-29 14:17:28.385 -03:00 [DBG] Done attempting to validate the bound parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto'.
2026-01-29 14:17:28.385 -03:00 [DBG] The request has model state errors, returning an error response.
2026-01-29 14:17:28.386 -03:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2026-01-29 14:17:28.386 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:17:28.388 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:17:28.388 -03:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2026-01-29 14:17:28.389 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2026-01-29 14:17:28.390 -03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2026-01-29 14:17:28.391 -03:00 [INF] Executed action Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api) in 13.1498ms
2026-01-29 14:17:28.392 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)'
2026-01-29 14:17:28.392 -03:00 [INF] HTTP POST /api/auth/login responded 400 in 21.4568 ms
2026-01-29 14:17:28.393 -03:00 [INF] Request finished HTTP/2 POST https://localhost:7058/api/auth/login - 400 null application/problem+json; charset=utf-8 25.7303ms
2026-01-29 14:19:40.418 -03:00 [DBG] Connection id "0HNIVB6RAVRMQ" is closing.
2026-01-29 14:19:40.418 -03:00 [DBG] Connection id "0HNIVB6RAVRMQ" is closed. The last processed stream ID was 9.
2026-01-29 14:19:40.456 -03:00 [DBG] The connection queue processing loop for 0HNIVB6RAVRMQ completed.
2026-01-29 14:19:40.458 -03:00 [DBG] Connection id "0HNIVB6RAVRMQ" stopped.
2026-01-29 14:19:40.458 -03:00 [DBG] Connection id "0HNIVB6RAVRMQ" sending FIN because: "The Socket transport's send loop completed gracefully."
2026-01-29 14:20:05.173 -03:00 [DBG] Connection id "0HNIVB6RAVRMR" accepted.
2026-01-29 14:20:05.174 -03:00 [DBG] Connection id "0HNIVB6RAVRMR" started.
2026-01-29 14:20:05.182 -03:00 [DBG] Connection 0HNIVB6RAVRMR established using the following protocol: "Tls12"
2026-01-29 14:20:05.183 -03:00 [INF] Request starting HTTP/2 POST https://localhost:7058/api/auth/login - application/json 69
2026-01-29 14:20:05.184 -03:00 [DBG] 1 candidate(s) found for the request path '/api/auth/login'
2026-01-29 14:20:05.185 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)' with route pattern 'api/Auth/login' is valid for the request path '/api/auth/login'
2026-01-29 14:20:05.186 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)'
2026-01-29 14:20:05.187 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:20:05.187 -03:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2026-01-29 14:20:05.190 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)'
2026-01-29 14:20:05.191 -03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Project_Gon.Core.DTOs.Auth.LoginDto) on controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api).
2026-01-29 14:20:05.192 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:20:05.193 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:20:05.194 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:20:05.195 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:20:05.196 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:20:05.197 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api)
2026-01-29 14:20:05.198 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api)
2026-01-29 14:20:05.199 -03:00 [DBG] Attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto' ...
2026-01-29 14:20:05.200 -03:00 [DBG] Attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto' using the name '' in request data ...
2026-01-29 14:20:05.201 -03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2026-01-29 14:20:05.202 -03:00 [DBG] Connection id "0HNIVB6RAVRMR", Request id "0HNIVB6RAVRMR:00000001": started reading request body.
2026-01-29 14:20:05.202 -03:00 [DBG] Connection id "0HNIVB6RAVRMR", Request id "0HNIVB6RAVRMR:00000001": done reading request body.
2026-01-29 14:20:05.205 -03:00 [DBG] JSON input formatter succeeded, deserializing to type 'Project_Gon.Core.DTOs.Auth.LoginDto'
2026-01-29 14:20:05.206 -03:00 [DBG] Done attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto'.
2026-01-29 14:20:05.207 -03:00 [DBG] Done attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto'.
2026-01-29 14:20:05.207 -03:00 [DBG] Attempting to validate the bound parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto' ...
2026-01-29 14:20:05.209 -03:00 [DBG] Done attempting to validate the bound parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto'.
2026-01-29 14:20:05.210 -03:00 [INF] [LOGIN] Intento de login con: vendedor@empresa.com
2026-01-29 14:20:05.210 -03:00 [INF] [FIND] Buscando por EMAIL: vendedor@empresa.com
2026-01-29 14:20:05.240 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:20:05.243 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:20:05.243 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 14:20:05.244 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:20:05.279 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:20:05.279 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:20:05.280 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:20:05.281 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:20:05.282 -03:00 [DBG] Executing DbCommand [Parameters=[@__emailOrRut_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt"
FROM "Usuarios" AS u
WHERE u."Email" = @__emailOrRut_0 AND u."Activo"
LIMIT 1
2026-01-29 14:20:05.286 -03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__emailOrRut_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt"
FROM "Usuarios" AS u
WHERE u."Email" = @__emailOrRut_0 AND u."Activo"
LIMIT 1
2026-01-29 14:20:05.288 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:20:05.288 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 14:20:05.289 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:20:05.290 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:20:05.291 -03:00 [INF] [FIND] Usuario encontrado - ID: 3, RUT: 12345678-9
2026-01-29 14:20:05.292 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:20:05.293 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:20:05.294 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:20:05.294 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:20:05.295 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:20:05.296 -03:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt"
FROM "Empresas" AS e
WHERE e."Id" = @__p_0
LIMIT 1
2026-01-29 14:20:05.301 -03:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt"
FROM "Empresas" AS e
WHERE e."Id" = @__p_0
LIMIT 1
2026-01-29 14:20:05.303 -03:00 [DBG] Context 'AppDbContext' started tracking 'Empresa' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2026-01-29 14:20:05.304 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:20:05.304 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 1ms reading results.
2026-01-29 14:20:05.305 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:20:05.306 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:20:05.307 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:20:05.308 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:20:05.309 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:20:05.309 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:20:05.310 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:20:05.311 -03:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Sucursales" AS s
WHERE s."Id" = @__p_0
LIMIT 1
2026-01-29 14:20:05.314 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Sucursales" AS s
WHERE s."Id" = @__p_0
LIMIT 1
2026-01-29 14:20:05.317 -03:00 [DBG] Context 'AppDbContext' started tracking 'Sucursal' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2026-01-29 14:20:05.318 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:20:05.319 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 1ms reading results.
2026-01-29 14:20:05.320 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:20:05.320 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:20:05.321 -03:00 [INF] [LOGIN] Usuario encontrado: true
2026-01-29 14:20:05.322 -03:00 [INF] [LOGIN] Usuario ID: 3, RUT: 12345678-9, Email: vendedor@empresa.com, Activo: true
2026-01-29 14:20:05.323 -03:00 [INF] [LOGIN] Verificando contrasea para usuario ID: 3
2026-01-29 14:20:05.530 -03:00 [INF] [LOGIN] Password vlido: true
2026-01-29 14:20:05.532 -03:00 [DBG] Context 'AppDbContext' started tracking 'Usuario' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2026-01-29 14:20:05.533 -03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2026-01-29 14:20:05.533 -03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2026-01-29 14:20:05.534 -03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2026-01-29 14:20:05.535 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:20:05.536 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:20:05.537 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:20:05.537 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:20:05.538 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:20:05.539 -03:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?', @p2='?' (DbType = DateTime), @p3='?', @p4='?' (DbType = Int32), @p5='?', @p6='?', @p7='?' (DbType = Int32), @p8='?', @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Usuarios" SET "Activo" = @p0, "Apellido" = @p1, "CreatedAt" = @p2, "Email" = @p3, "EmpresaId" = @p4, "Nombre" = @p5, "PasswordHash" = @p6, "Rol" = @p7, "Rut" = @p8, "SucursalId" = @p9, "UltimoAcceso" = @p10, "UpdatedAt" = @p11
WHERE "Id" = @p12;
2026-01-29 14:20:05.542 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?', @p2='?' (DbType = DateTime), @p3='?', @p4='?' (DbType = Int32), @p5='?', @p6='?', @p7='?' (DbType = Int32), @p8='?', @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Usuarios" SET "Activo" = @p0, "Apellido" = @p1, "CreatedAt" = @p2, "Email" = @p3, "EmpresaId" = @p4, "Nombre" = @p5, "PasswordHash" = @p6, "Rol" = @p7, "Rut" = @p8, "SucursalId" = @p9, "UltimoAcceso" = @p10, "UpdatedAt" = @p11
WHERE "Id" = @p12;
2026-01-29 14:20:05.544 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:20:05.545 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 14:20:05.546 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:20:05.547 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:20:05.548 -03:00 [DBG] An entity of type 'Usuario' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2026-01-29 14:20:05.549 -03:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2026-01-29 14:20:05.551 -03:00 [INF] [LOGIN] Login exitoso para usuario ID: 3
2026-01-29 14:20:05.552 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:20:05.554 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:20:05.554 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 14:20:05.555 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 14:20:05.556 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 14:20:05.557 -03:00 [INF] Executing OkObjectResult, writing value of type 'Project_Gon.Core.DTOs.Auth.LoginResponseDto'.
2026-01-29 14:20:05.558 -03:00 [INF] Executed action Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api) in 360.2625ms
2026-01-29 14:20:05.558 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)'
2026-01-29 14:20:05.559 -03:00 [INF] HTTP POST /api/auth/login responded 200 in 371.8279 ms
2026-01-29 14:20:05.560 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:20:05.561 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:20:05.561 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:20:05.562 -03:00 [INF] Request finished HTTP/2 POST https://localhost:7058/api/auth/login - 200 null application/json; charset=utf-8 379.4571ms
2026-01-29 14:21:40.664 -03:00 [INF] Request starting HTTP/2 POST https://localhost:7058/api/auth/login - application/json 69
2026-01-29 14:21:40.665 -03:00 [DBG] 1 candidate(s) found for the request path '/api/auth/login'
2026-01-29 14:21:40.666 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)' with route pattern 'api/Auth/login' is valid for the request path '/api/auth/login'
2026-01-29 14:21:40.667 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)'
2026-01-29 14:21:40.668 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:21:40.669 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:21:40.669 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:21:40.670 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:21:40.670 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)'
2026-01-29 14:21:40.671 -03:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(Project_Gon.Core.DTOs.Auth.LoginDto) on controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api).
2026-01-29 14:21:40.672 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:21:40.673 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:21:40.674 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:21:40.676 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:21:40.676 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:21:40.678 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api)
2026-01-29 14:21:40.679 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api)
2026-01-29 14:21:40.679 -03:00 [DBG] Attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto' ...
2026-01-29 14:21:40.680 -03:00 [DBG] Attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto' using the name '' in request data ...
2026-01-29 14:21:40.684 -03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2026-01-29 14:21:40.685 -03:00 [DBG] Connection id "0HNIVB6RAVRMR", Request id "0HNIVB6RAVRMR:00000003": started reading request body.
2026-01-29 14:21:40.685 -03:00 [DBG] Connection id "0HNIVB6RAVRMR", Request id "0HNIVB6RAVRMR:00000003": done reading request body.
2026-01-29 14:21:40.686 -03:00 [DBG] JSON input formatter succeeded, deserializing to type 'Project_Gon.Core.DTOs.Auth.LoginDto'
2026-01-29 14:21:40.687 -03:00 [DBG] Done attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto'.
2026-01-29 14:21:40.687 -03:00 [DBG] Done attempting to bind parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto'.
2026-01-29 14:21:40.688 -03:00 [DBG] Attempting to validate the bound parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto' ...
2026-01-29 14:21:40.690 -03:00 [DBG] Done attempting to validate the bound parameter 'loginDto' of type 'Project_Gon.Core.DTOs.Auth.LoginDto'.
2026-01-29 14:21:40.690 -03:00 [INF] [LOGIN] Intento de login con: vendedor@empresa.com
2026-01-29 14:21:40.691 -03:00 [INF] [FIND] Buscando por EMAIL: vendedor@empresa.com
2026-01-29 14:21:40.692 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:21:40.694 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:21:40.694 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 14:21:40.695 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:21:40.696 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:21:40.698 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:21:40.699 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:21:40.700 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:21:40.701 -03:00 [DBG] Executing DbCommand [Parameters=[@__emailOrRut_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt"
FROM "Usuarios" AS u
WHERE u."Email" = @__emailOrRut_0 AND u."Activo"
LIMIT 1
2026-01-29 14:21:40.703 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__emailOrRut_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt"
FROM "Usuarios" AS u
WHERE u."Email" = @__emailOrRut_0 AND u."Activo"
LIMIT 1
2026-01-29 14:21:40.704 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:21:40.705 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 14:21:40.706 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:21:40.707 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:21:40.708 -03:00 [INF] [FIND] Usuario encontrado - ID: 3, RUT: 12345678-9
2026-01-29 14:21:40.709 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:21:40.709 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:21:40.710 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:21:40.710 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:21:40.711 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:21:40.712 -03:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt"
FROM "Empresas" AS e
WHERE e."Id" = @__p_0
LIMIT 1
2026-01-29 14:21:40.716 -03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt"
FROM "Empresas" AS e
WHERE e."Id" = @__p_0
LIMIT 1
2026-01-29 14:21:40.718 -03:00 [DBG] Context 'AppDbContext' started tracking 'Empresa' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2026-01-29 14:21:40.719 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:21:40.719 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 1ms reading results.
2026-01-29 14:21:40.720 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:21:40.721 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:21:40.722 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:21:40.723 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:21:40.724 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:21:40.724 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:21:40.725 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:21:40.726 -03:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Sucursales" AS s
WHERE s."Id" = @__p_0
LIMIT 1
2026-01-29 14:21:40.727 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Sucursales" AS s
WHERE s."Id" = @__p_0
LIMIT 1
2026-01-29 14:21:40.731 -03:00 [DBG] Context 'AppDbContext' started tracking 'Sucursal' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2026-01-29 14:21:40.732 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:21:40.733 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 1ms reading results.
2026-01-29 14:21:40.734 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:21:40.735 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:21:40.735 -03:00 [INF] [LOGIN] Usuario encontrado: true
2026-01-29 14:21:40.736 -03:00 [INF] [LOGIN] Usuario ID: 3, RUT: 12345678-9, Email: vendedor@empresa.com, Activo: true
2026-01-29 14:21:40.737 -03:00 [INF] [LOGIN] Verificando contrasea para usuario ID: 3
2026-01-29 14:21:40.945 -03:00 [INF] [LOGIN] Password vlido: true
2026-01-29 14:21:40.946 -03:00 [DBG] Context 'AppDbContext' started tracking 'Usuario' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2026-01-29 14:21:40.947 -03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2026-01-29 14:21:40.947 -03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2026-01-29 14:21:40.948 -03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2026-01-29 14:21:40.949 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:21:40.950 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:21:40.951 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:21:40.951 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:21:40.952 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:21:40.953 -03:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?', @p2='?' (DbType = DateTime), @p3='?', @p4='?' (DbType = Int32), @p5='?', @p6='?', @p7='?' (DbType = Int32), @p8='?', @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Usuarios" SET "Activo" = @p0, "Apellido" = @p1, "CreatedAt" = @p2, "Email" = @p3, "EmpresaId" = @p4, "Nombre" = @p5, "PasswordHash" = @p6, "Rol" = @p7, "Rut" = @p8, "SucursalId" = @p9, "UltimoAcceso" = @p10, "UpdatedAt" = @p11
WHERE "Id" = @p12;
2026-01-29 14:21:40.955 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?', @p2='?' (DbType = DateTime), @p3='?', @p4='?' (DbType = Int32), @p5='?', @p6='?', @p7='?' (DbType = Int32), @p8='?', @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
UPDATE "Usuarios" SET "Activo" = @p0, "Apellido" = @p1, "CreatedAt" = @p2, "Email" = @p3, "EmpresaId" = @p4, "Nombre" = @p5, "PasswordHash" = @p6, "Rol" = @p7, "Rut" = @p8, "SucursalId" = @p9, "UltimoAcceso" = @p10, "UpdatedAt" = @p11
WHERE "Id" = @p12;
2026-01-29 14:21:40.958 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:21:40.958 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 14:21:40.959 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:21:40.960 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:21:40.961 -03:00 [DBG] An entity of type 'Usuario' tracked by 'AppDbContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2026-01-29 14:21:40.962 -03:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2026-01-29 14:21:40.963 -03:00 [INF] [LOGIN] Login exitoso para usuario ID: 3
2026-01-29 14:21:40.964 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:21:40.965 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:21:40.966 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 14:21:40.969 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 14:21:40.970 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 14:21:40.971 -03:00 [INF] Executing OkObjectResult, writing value of type 'Project_Gon.Core.DTOs.Auth.LoginResponseDto'.
2026-01-29 14:21:40.971 -03:00 [INF] Executed action Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api) in 293.962ms
2026-01-29 14:21:40.972 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)'
2026-01-29 14:21:40.973 -03:00 [INF] HTTP POST /api/auth/login responded 200 in 304.5825 ms
2026-01-29 14:21:40.974 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:21:40.975 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:21:40.975 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:21:40.976 -03:00 [INF] Request finished HTTP/2 POST https://localhost:7058/api/auth/login - 200 null application/json; charset=utf-8 312.6222ms
2026-01-29 14:22:36.384 -03:00 [INF] Request starting HTTP/2 POST https://localhost:7058/api/usuarios - application/json 69
2026-01-29 14:22:36.386 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios'
2026-01-29 14:22:36.387 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.Create (Project_Gon.Api)' with route pattern 'api/Usuarios' is valid for the request path '/api/usuarios'
2026-01-29 14:22:36.391 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.Create (Project_Gon.Api)'
2026-01-29 14:22:36.392 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:22:36.393 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:22:36.393 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:22:36.394 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:22:36.398 -03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (AdminGlobal|AdminEmpresa)
2026-01-29 14:22:36.400 -03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2026-01-29 14:22:36.401 -03:00 [INF] HTTP POST /api/usuarios responded 403 in 7.9103 ms
2026-01-29 14:22:36.402 -03:00 [INF] Request finished HTTP/2 POST https://localhost:7058/api/usuarios - 403 0 null 17.2325ms
2026-01-29 14:22:36.406 -03:00 [DBG] Connection id "0HNIVB6RAVRMR", Request id "0HNIVB6RAVRMR:00000005": started reading request body.
2026-01-29 14:22:36.406 -03:00 [DBG] Connection id "0HNIVB6RAVRMR", Request id "0HNIVB6RAVRMR:00000005": done reading request body.
2026-01-29 14:23:18.504 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7058/api/usuarios - application/json 69
2026-01-29 14:23:18.505 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios'
2026-01-29 14:23:18.506 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)' with route pattern 'api/Usuarios' is valid for the request path '/api/usuarios'
2026-01-29 14:23:18.507 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:23:18.508 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:23:18.509 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:23:18.509 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:23:18.510 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:23:18.512 -03:00 [DBG] Authorization was successful.
2026-01-29 14:23:18.512 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:23:18.515 -03:00 [INF] Route matched with {action = "GetAll", controller = "Usuarios"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Project_Gon.Core.DTOs.Usuario.UsuarioDto]]] GetAll() on controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api).
2026-01-29 14:23:18.518 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:23:18.519 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:23:18.520 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:23:18.521 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:23:18.522 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:23:18.523 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:23:18.525 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:23:18.526 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:23:18.529 -03:00 [DBG] Compiling query expression: 
'DbSet<Usuario>()
    .AsNoTracking()'
2026-01-29 14:23:18.533 -03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Usuario>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
        SELECT u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt
        FROM Usuarios AS u) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
        SELECT u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt
        FROM Usuarios AS u, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Usuario entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Usuario instance1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Usuario);
            (object)dataReader.GetInt32(0) != null ? 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]: 
                        {
                            return 
                            {
                                Usuario instance;
                                instance = new Usuario();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<Activo>k__BackingField = dataReader.GetBoolean(1);
                                instance.<Apellido>k__BackingField = dataReader.GetString(2);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(3);
                                instance.<Email>k__BackingField = dataReader.IsDBNull(4) ? default(string) : dataReader.GetString(4);
                                instance.<EmpresaId>k__BackingField = dataReader.GetInt32(5);
                                instance.<Nombre>k__BackingField = dataReader.GetString(6);
                                instance.<PasswordHash>k__BackingField = dataReader.GetString(7);
                                instance.<Rol>k__BackingField = Invoke(((EnumToNumberConverter<RolUsuario, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Usuario.Rol (RolUsuario) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindProperty("Rol")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(8));
                                instance.<Rut>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                instance.<SucursalId>k__BackingField = dataReader.IsDBNull(10) ? default(int?) : (int?)dataReader.GetInt32(10);
                                instance.<UltimoAcceso>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(11);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(12) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(12);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Usuario)
                }
                ;
                return instance1;
            } : 
            {
                object[] keyValues1;
                keyValues1 = new object[]{ (object)dataReader.GetInt32(0) };
                return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                    entityType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")], 
                    properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindPrimaryKey().Properties], 
                    keyValues: keyValues1);
            };
            return instance1;
        };
        return entity;
    }, 
    contextType: Project_Gon.Infrastructure.Data.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2026-01-29 14:23:18.545 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:23:18.545 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 14:23:18.546 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:23:18.547 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:23:18.549 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:23:18.549 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:23:18.550 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:23:18.551 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt"
FROM "Usuarios" AS u
2026-01-29 14:23:18.553 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt"
FROM "Usuarios" AS u
2026-01-29 14:23:18.554 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:23:18.555 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 14:23:18.556 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:23:18.557 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:23:18.566 -03:00 [INF] Retrieved 1 usuarios
2026-01-29 14:23:18.567 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:23:18.568 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:23:18.569 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 14:23:18.570 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 14:23:18.570 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 14:23:18.572 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Project_Gon.Core.DTOs.Usuario.UsuarioDto, Project_Gon.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-29 14:23:18.578 -03:00 [INF] Executed action Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api) in 54.6614ms
2026-01-29 14:23:18.579 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:23:18.580 -03:00 [INF] HTTP GET /api/usuarios responded 200 in 71.2755 ms
2026-01-29 14:23:18.581 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:23:18.582 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:23:18.583 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:23:18.584 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7058/api/usuarios - 200 null application/json; charset=utf-8 79.6926ms
2026-01-29 14:23:18.586 -03:00 [DBG] Connection id "0HNIVB6RAVRMR", Request id "0HNIVB6RAVRMR:00000007": started reading request body.
2026-01-29 14:23:18.586 -03:00 [DBG] Connection id "0HNIVB6RAVRMR", Request id "0HNIVB6RAVRMR:00000007": done reading request body.
2026-01-29 14:25:30.238 -03:00 [DBG] Connection id "0HNIVB6RAVRMR" is closing.
2026-01-29 14:25:30.239 -03:00 [DBG] Connection id "0HNIVB6RAVRMR" is closed. The last processed stream ID was 7.
2026-01-29 14:25:30.240 -03:00 [DBG] The connection queue processing loop for 0HNIVB6RAVRMR completed.
2026-01-29 14:25:30.241 -03:00 [DBG] Connection id "0HNIVB6RAVRMR" stopped.
2026-01-29 14:25:30.241 -03:00 [DBG] Connection id "0HNIVB6RAVRMR" sending FIN because: "The Socket transport's send loop completed gracefully."
2026-01-29 14:37:05.424 -03:00 [DBG] Connection id "0HNIVB6RAVRMS" accepted.
2026-01-29 14:37:05.425 -03:00 [DBG] Connection id "0HNIVB6RAVRMS" started.
2026-01-29 14:37:05.433 -03:00 [DBG] Connection 0HNIVB6RAVRMS established using the following protocol: "Tls12"
2026-01-29 14:37:05.434 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7058/api/usuarios - application/json 69
2026-01-29 14:37:05.435 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios'
2026-01-29 14:37:05.436 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)' with route pattern 'api/Usuarios' is valid for the request path '/api/usuarios'
2026-01-29 14:37:05.437 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:37:05.437 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:37:05.438 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:37:05.438 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:37:05.439 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:37:05.439 -03:00 [DBG] Authorization was successful.
2026-01-29 14:37:05.440 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:37:05.440 -03:00 [INF] Route matched with {action = "GetAll", controller = "Usuarios"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Project_Gon.Core.DTOs.Usuario.UsuarioDto]]] GetAll() on controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api).
2026-01-29 14:37:05.441 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:37:05.442 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:37:05.443 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:37:05.445 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:37:05.446 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:37:05.447 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:37:05.448 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:37:05.449 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:37:05.450 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:37:05.450 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 14:37:05.451 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:05.479 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:05.480 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:37:05.481 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:37:05.481 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:37:05.482 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt"
FROM "Usuarios" AS u
2026-01-29 14:37:05.486 -03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt"
FROM "Usuarios" AS u
2026-01-29 14:37:05.487 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:05.487 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 14:37:05.488 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:05.489 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:37:05.490 -03:00 [INF] Retrieved 1 usuarios
2026-01-29 14:37:05.490 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:37:05.491 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:37:05.492 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 14:37:05.492 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 14:37:05.493 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 14:37:05.494 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Project_Gon.Core.DTOs.Usuario.UsuarioDto, Project_Gon.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-29 14:37:05.495 -03:00 [INF] Executed action Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api) in 47.6763ms
2026-01-29 14:37:05.495 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:37:05.496 -03:00 [INF] HTTP GET /api/usuarios responded 200 in 58.3441 ms
2026-01-29 14:37:05.497 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:37:05.497 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:05.498 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:37:05.499 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7058/api/usuarios - 200 null application/json; charset=utf-8 64.5323ms
2026-01-29 14:37:05.500 -03:00 [DBG] Connection id "0HNIVB6RAVRMS", Request id "0HNIVB6RAVRMS:00000001": started reading request body.
2026-01-29 14:37:05.501 -03:00 [DBG] Connection id "0HNIVB6RAVRMS", Request id "0HNIVB6RAVRMS:00000001": done reading request body.
2026-01-29 14:37:06.775 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7058/api/usuarios - application/json 69
2026-01-29 14:37:06.776 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios'
2026-01-29 14:37:06.776 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)' with route pattern 'api/Usuarios' is valid for the request path '/api/usuarios'
2026-01-29 14:37:06.777 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:37:06.778 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:37:06.779 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:37:06.779 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:37:06.780 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:37:06.780 -03:00 [DBG] Authorization was successful.
2026-01-29 14:37:06.781 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:37:06.781 -03:00 [INF] Route matched with {action = "GetAll", controller = "Usuarios"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Project_Gon.Core.DTOs.Usuario.UsuarioDto]]] GetAll() on controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api).
2026-01-29 14:37:06.782 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:37:06.783 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:37:06.783 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:37:06.785 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:37:06.785 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:37:06.786 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:37:06.787 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:37:06.788 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:37:06.789 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:37:06.789 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 14:37:06.790 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:06.791 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:06.791 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:37:06.792 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:37:06.792 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:37:06.793 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt"
FROM "Usuarios" AS u
2026-01-29 14:37:06.794 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt"
FROM "Usuarios" AS u
2026-01-29 14:37:06.795 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:06.796 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 14:37:06.797 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:06.798 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:37:06.798 -03:00 [INF] Retrieved 1 usuarios
2026-01-29 14:37:06.799 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:37:06.800 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:37:06.800 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 14:37:06.801 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 14:37:06.801 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 14:37:06.802 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Project_Gon.Core.DTOs.Usuario.UsuarioDto, Project_Gon.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-29 14:37:06.803 -03:00 [INF] Executed action Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api) in 16.8209ms
2026-01-29 14:37:06.804 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:37:06.804 -03:00 [INF] HTTP GET /api/usuarios responded 200 in 25.7304 ms
2026-01-29 14:37:06.805 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:37:06.805 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:06.806 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:37:06.807 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7058/api/usuarios - 200 null application/json; charset=utf-8 32.1012ms
2026-01-29 14:37:06.809 -03:00 [DBG] Connection id "0HNIVB6RAVRMS", Request id "0HNIVB6RAVRMS:00000003": started reading request body.
2026-01-29 14:37:06.809 -03:00 [DBG] Connection id "0HNIVB6RAVRMS", Request id "0HNIVB6RAVRMS:00000003": done reading request body.
2026-01-29 14:37:41.540 -03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2026-01-29 14:37:41.938 -03:00 [DBG] The index {'ProductoId'} was not created on entity type 'Stock' as the properties are already covered by the index {'ProductoId', 'SucursalId'}.
2026-01-29 14:37:41.940 -03:00 [DBG] The index {'EmpresaId'} was not created on entity type 'Usuario' as the properties are already covered by the index {'EmpresaId', 'Email'}.
2026-01-29 14:37:41.940 -03:00 [DBG] The index {'EmpresaId'} was not created on entity type 'Usuario' as the properties are already covered by the index {'EmpresaId', 'Rut'}.
2026-01-29 14:37:42.013 -03:00 [DBG] The property 'MovimientoStock.DevolucionId' was created in shadow state because there are no eligible CLR members with a matching name.
2026-01-29 14:37:42.070 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:37:42.081 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:37:42.097 -03:00 [DBG] Created DbConnection. (15ms).
2026-01-29 14:37:42.100 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:42.275 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:42.278 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:37:42.281 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2026-01-29 14:37:42.283 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2026-01-29 14:37:42.287 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:37:42.307 -03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:37:42.325 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:42.330 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 19ms reading results.
2026-01-29 14:37:42.332 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:42.334 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (2ms).
2026-01-29 14:37:42.440 -03:00 [DBG] Migrating using database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:42.442 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:42.444 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:42.591 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:42.592 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:42.594 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (1ms).
2026-01-29 14:37:42.595 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:42.595 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:42.621 -03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2026-01-29 14:37:42.621 -03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2026-01-29 14:37:42.622 -03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2026-01-29 14:37:42.623 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2026-01-29 14:37:42.628 -03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2026-01-29 14:37:42.631 -03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2026-01-29 14:37:42.633 -03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2026-01-29 14:37:42.634 -03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2026-01-29 14:37:42.635 -03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2026-01-29 14:37:42.635 -03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2026-01-29 14:37:42.636 -03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2026-01-29 14:37:42.636 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2026-01-29 14:37:42.638 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2026-01-29 14:37:42.639 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:37:42.639 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:37:42.640 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:37:42.640 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:37:42.642 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:37:42.643 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:42.643 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 14:37:42.648 -03:00 [INF] No migrations were applied. The database is already up to date.
2026-01-29 14:37:42.649 -03:00 [DBG] Committing transaction.
2026-01-29 14:37:42.687 -03:00 [DBG] Committed transaction.
2026-01-29 14:37:42.688 -03:00 [DBG] Disposing transaction.
2026-01-29 14:37:42.688 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:42.689 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:37:42.690 -03:00 [INF] Database migrations applied successfully
2026-01-29 14:37:42.692 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:37:42.693 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:37:42.694 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:37:42.714 -03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2026-01-29 14:37:42.743 -03:00 [DBG] Registered SignalR Protocol: json, implemented by Microsoft.AspNetCore.SignalR.Protocol.JsonHubProtocol.
2026-01-29 14:37:42.754 -03:00 [INF] Project Gon API iniciada en ambiente: Development
2026-01-29 14:37:42.756 -03:00 [DBG] Hosting starting
2026-01-29 14:37:42.764 -03:00 [INF] User profile is available. Using 'C:\Users\Jossan\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2026-01-29 14:37:42.769 -03:00 [DBG] Reading data from file 'C:\Users\Jossan\AppData\Local\ASP.NET\DataProtection-Keys\key-7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c.xml'.
2026-01-29 14:37:42.774 -03:00 [DBG] Found key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c}.
2026-01-29 14:37:42.779 -03:00 [DBG] Considering key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c} with expiration date 2026-04-28 18:20:11Z as default key.
2026-01-29 14:37:42.781 -03:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=9.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2026-01-29 14:37:42.782 -03:00 [DBG] Decrypting secret element using Windows DPAPI.
2026-01-29 14:37:42.783 -03:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=9.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2026-01-29 14:37:42.785 -03:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2026-01-29 14:37:42.785 -03:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2026-01-29 14:37:42.786 -03:00 [DBG] Using key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c} as the default key.
2026-01-29 14:37:42.787 -03:00 [DBG] Key ring with default key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c} was loaded during application startup.
2026-01-29 14:37:42.790 -03:00 [DBG] Middleware loaded
2026-01-29 14:37:42.791 -03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16515 B).
2026-01-29 14:37:42.792 -03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2026-01-29 14:37:42.833 -03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2026-01-29 14:37:42.834 -03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2026-01-29 14:37:42.836 -03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2026-01-29 14:37:42.861 -03:00 [INF] Now listening on: https://localhost:7058
2026-01-29 14:37:42.861 -03:00 [INF] Now listening on: http://localhost:5070
2026-01-29 14:37:42.862 -03:00 [DBG] Loaded hosting startup assembly Project_Gon.Api
2026-01-29 14:37:42.862 -03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2026-01-29 14:37:42.863 -03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2026-01-29 14:37:42.863 -03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2026-01-29 14:37:42.866 -03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2026-01-29 14:37:42.869 -03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2026-01-29 14:37:42.889 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2026-01-29 14:37:42.890 -03:00 [INF] Hosting environment: Development
2026-01-29 14:37:42.890 -03:00 [INF] Content root path: C:\Proyectos\Project_Gon\Project_Gon.Api
2026-01-29 14:37:42.891 -03:00 [DBG] Hosting started
2026-01-29 14:38:15.729 -03:00 [DBG] Connection id "0HNIVBKNF0O4V" accepted.
2026-01-29 14:38:15.730 -03:00 [DBG] Connection id "0HNIVBKNF0O4V" started.
2026-01-29 14:38:15.755 -03:00 [DBG] Connection 0HNIVBKNF0O4V established using the following protocol: "Tls12"
2026-01-29 14:38:15.772 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7058/api/usuarios - application/json 69
2026-01-29 14:38:15.788 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios'
2026-01-29 14:38:15.789 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)' with route pattern 'api/Usuarios' is valid for the request path '/api/usuarios'
2026-01-29 14:38:15.790 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:38:15.794 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:38:15.834 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:38:15.836 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:38:15.837 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:38:15.840 -03:00 [DBG] Authorization was successful.
2026-01-29 14:38:15.841 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:38:15.847 -03:00 [INF] Route matched with {action = "GetAll", controller = "Usuarios"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Project_Gon.Core.DTOs.Usuario.UsuarioDto]]] GetAll() on controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api).
2026-01-29 14:38:15.849 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:38:15.850 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:38:15.851 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:38:15.852 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:38:15.853 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:38:15.854 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:38:15.927 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:38:15.942 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:38:16.006 -03:00 [DBG] Compiling query expression: 
'DbSet<Usuario>()
    .AsNoTracking()
    .Include(u => u.Empresa)
    .Include(u => u.Sucursal)'
2026-01-29 14:38:16.047 -03:00 [DBG] Including navigation: 'Usuario.Empresa'.
2026-01-29 14:38:16.049 -03:00 [DBG] Including navigation: 'Usuario.Sucursal'.
2026-01-29 14:38:16.203 -03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Usuario>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
            1 -> Dictionary<IProperty, int> { [Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Empresa.Activo (bool) Required, 14], [Property: Empresa.Ciudad (string), 15], [Property: Empresa.CreatedAt (DateTime) Required, 16], [Property: Empresa.Direccion (string), 17], [Property: Empresa.Nombre (string) Required MaxLength(255), 18], [Property: Empresa.Region (string), 19], [Property: Empresa.Rut (string), 20], [Property: Empresa.UpdatedAt (DateTime?), 21] }
            2 -> Dictionary<IProperty, int> { [Property: Sucursal.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 22], [Property: Sucursal.Activo (bool) Required, 23], [Property: Sucursal.Ciudad (string), 24], [Property: Sucursal.CreatedAt (DateTime) Required, 25], [Property: Sucursal.Direccion (string), 26], [Property: Sucursal.EmpresaId (int) Required FK Index, 27], [Property: Sucursal.Nombre (string) Required MaxLength(255), 28], [Property: Sucursal.Region (string), 29], [Property: Sucursal.Telefono (string), 30], [Property: Sucursal.UpdatedAt (DateTime?), 31] }
        SELECT u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt, e.Id, e.Activo, e.Ciudad, e.CreatedAt, e.Direccion, e.Nombre, e.Region, e.Rut, e.UpdatedAt, s.Id, s.Activo, s.Ciudad, s.CreatedAt, s.Direccion, s.EmpresaId, s.Nombre, s.Region, s.Telefono, s.UpdatedAt
        FROM Usuarios AS u
        INNER JOIN Empresas AS e ON u.EmpresaId == e.Id
        LEFT JOIN Sucursales AS s ON u.SucursalId == s.Id) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
            1 -> Dictionary<IProperty, int> { [Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Empresa.Activo (bool) Required, 14], [Property: Empresa.Ciudad (string), 15], [Property: Empresa.CreatedAt (DateTime) Required, 16], [Property: Empresa.Direccion (string), 17], [Property: Empresa.Nombre (string) Required MaxLength(255), 18], [Property: Empresa.Region (string), 19], [Property: Empresa.Rut (string), 20], [Property: Empresa.UpdatedAt (DateTime?), 21] }
            2 -> Dictionary<IProperty, int> { [Property: Sucursal.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 22], [Property: Sucursal.Activo (bool) Required, 23], [Property: Sucursal.Ciudad (string), 24], [Property: Sucursal.CreatedAt (DateTime) Required, 25], [Property: Sucursal.Direccion (string), 26], [Property: Sucursal.EmpresaId (int) Required FK Index, 27], [Property: Sucursal.Nombre (string) Required MaxLength(255), 28], [Property: Sucursal.Region (string), 29], [Property: Sucursal.Telefono (string), 30], [Property: Sucursal.UpdatedAt (DateTime?), 31] }
        SELECT u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt, e.Id, e.Activo, e.Ciudad, e.CreatedAt, e.Direccion, e.Nombre, e.Region, e.Rut, e.UpdatedAt, s.Id, s.Activo, s.Ciudad, s.CreatedAt, s.Direccion, s.EmpresaId, s.Nombre, s.Region, s.Telefono, s.UpdatedAt
        FROM Usuarios AS u
        INNER JOIN Empresas AS e ON u.EmpresaId == e.Id
        LEFT JOIN Sucursales AS s ON u.SucursalId == s.Id, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Usuario entity;
        Empresa entity;
        Sucursal entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Usuario instance1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Usuario);
            (object)dataReader.GetInt32(0) != null ? 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]: 
                        {
                            return 
                            {
                                Usuario instance;
                                instance = new Usuario();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<Activo>k__BackingField = dataReader.GetBoolean(1);
                                instance.<Apellido>k__BackingField = dataReader.GetString(2);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(3);
                                instance.<Email>k__BackingField = dataReader.IsDBNull(4) ? default(string) : dataReader.GetString(4);
                                instance.<EmpresaId>k__BackingField = dataReader.GetInt32(5);
                                instance.<Nombre>k__BackingField = dataReader.GetString(6);
                                instance.<PasswordHash>k__BackingField = dataReader.GetString(7);
                                instance.<Rol>k__BackingField = Invoke(((EnumToNumberConverter<RolUsuario, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Usuario.Rol (RolUsuario) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindProperty("Rol")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(8));
                                instance.<Rut>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                instance.<SucursalId>k__BackingField = dataReader.IsDBNull(10) ? default(int?) : (int?)dataReader.GetInt32(10);
                                instance.<UltimoAcceso>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(11);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(12) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(12);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Usuario)
                }
                ;
                return instance1;
            } : 
            {
                object[] keyValues1;
                keyValues1 = new object[]{ (object)dataReader.GetInt32(0) };
                return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                    entityType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")], 
                    properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindPrimaryKey().Properties], 
                    keyValues: keyValues1);
            };
            return instance1;
        };
        entity = 
        {
            MaterializationContext materializationContext2;
            IEntityType entityType2;
            Empresa instance2;
            materializationContext2 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance2 = default(Empresa);
            (object)dataReader.GetInt32(13) != null ? 
            {
                ISnapshot shadowSnapshot2;
                shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType2 = [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")];
                instance2 = switch (entityType2)
                {
                    case [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")]: 
                        {
                            return 
                            {
                                Empresa instance;
                                instance = new Empresa();
                                instance.<Id>k__BackingField = dataReader.GetInt32(13);
                                instance.<Activo>k__BackingField = dataReader.GetBoolean(14);
                                instance.<Ciudad>k__BackingField = dataReader.IsDBNull(15) ? default(string) : dataReader.GetString(15);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(16);
                                instance.<Direccion>k__BackingField = dataReader.IsDBNull(17) ? default(string) : dataReader.GetString(17);
                                instance.<Nombre>k__BackingField = dataReader.GetString(18);
                                instance.<Region>k__BackingField = dataReader.IsDBNull(19) ? default(string) : dataReader.GetString(19);
                                instance.<Rut>k__BackingField = dataReader.IsDBNull(20) ? default(string) : dataReader.GetString(20);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(21) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(21);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext2.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Empresa)
                }
                ;
                return instance2;
            } : 
            {
                object[] keyValues2;
                keyValues2 = new object[]{ (object)dataReader.GetInt32(13) };
                return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                    entityType: [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")], 
                    properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindPrimaryKey().Properties], 
                    keyValues: keyValues2);
            };
            return instance2;
        };
        entity = 
        {
            MaterializationContext materializationContext3;
            IEntityType entityType3;
            Sucursal instance3;
            materializationContext3 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance3 = default(Sucursal);
            dataReader.IsDBNull(22) ? default(object) : (object)dataReader.GetInt32(22) != null ? 
            {
                ISnapshot shadowSnapshot3;
                shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType3 = [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")];
                instance3 = switch (entityType3)
                {
                    case [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")]: 
                        {
                            return 
                            {
                                Sucursal instance;
                                instance = new Sucursal();
                                instance.<Id>k__BackingField = dataReader.IsDBNull(22) ? default(int) : dataReader.GetInt32(22);
                                instance.<Activo>k__BackingField = dataReader.IsDBNull(23) ? default(bool) : dataReader.GetBoolean(23);
                                instance.<Ciudad>k__BackingField = dataReader.IsDBNull(24) ? default(string) : dataReader.GetString(24);
                                instance.<CreatedAt>k__BackingField = dataReader.IsDBNull(25) ? default(DateTime) : dataReader.GetDateTime(25);
                                instance.<Direccion>k__BackingField = dataReader.IsDBNull(26) ? default(string) : dataReader.GetString(26);
                                instance.<EmpresaId>k__BackingField = dataReader.IsDBNull(27) ? default(int) : dataReader.GetInt32(27);
                                instance.<Nombre>k__BackingField = dataReader.IsDBNull(28) ? default(string) : dataReader.GetString(28);
                                instance.<Region>k__BackingField = dataReader.IsDBNull(29) ? default(string) : dataReader.GetString(29);
                                instance.<Telefono>k__BackingField = dataReader.IsDBNull(30) ? default(string) : dataReader.GetString(30);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(31) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(31);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext3.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Sucursal)
                }
                ;
                return instance3;
            } : default(void);
            return instance3;
        };
        ShaperProcessingExpressionVisitor.IncludeReference<Usuario, Usuario, Empresa>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: Usuario.Empresa (Empresa) ToPrincipal Empresa Inverse: Usuarios | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindNavigation("Empresa")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Empresa.Usuarios (ICollection<Usuario>) Collection ToDependent Usuario Inverse: Empresa | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindNavigation("Usuarios")], 
            fixup: (namelessParameter{14}, namelessParameter{15}) => 
            {
                namelessParameter{14}.<Empresa>k__BackingField = namelessParameter{15};
                return [LIFTABLE Constant: ClrICollectionAccessor<Empresa, ICollection<Usuario>, Usuario> | Resolver: namelessParameter{16} => namelessParameter{16}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindNavigation("Usuarios").GetCollectionAccessor()].Add(
                    entity: namelessParameter{15}, 
                    value: namelessParameter{14}, 
                    forMaterialization: True);
            }, 
            trackingQuery: False);
        ShaperProcessingExpressionVisitor.IncludeReference<Usuario, Usuario, Sucursal>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: Usuario.Sucursal (Sucursal) ToPrincipal Sucursal Inverse: Usuarios | Resolver: namelessParameter{17} => namelessParameter{17}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindNavigation("Sucursal")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Sucursal.Usuarios (ICollection<Usuario>) Collection ToDependent Usuario Inverse: Sucursal | Resolver: namelessParameter{18} => namelessParameter{18}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal").FindNavigation("Usuarios")], 
            fixup: (namelessParameter{19}, namelessParameter{20}) => 
            {
                namelessParameter{19}.<Sucursal>k__BackingField = namelessParameter{20};
                return [LIFTABLE Constant: ClrICollectionAccessor<Sucursal, ICollection<Usuario>, Usuario> | Resolver: namelessParameter{21} => namelessParameter{21}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal").FindNavigation("Usuarios").GetCollectionAccessor()].Add(
                    entity: namelessParameter{20}, 
                    value: namelessParameter{19}, 
                    forMaterialization: True);
            }, 
            trackingQuery: False);
        return entity;
    }, 
    contextType: Project_Gon.Infrastructure.Data.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2026-01-29 14:38:16.237 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:38:16.238 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 14:38:16.239 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:38:16.241 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:38:16.241 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:38:16.242 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:38:16.243 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:38:16.243 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
2026-01-29 14:38:16.251 -03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
2026-01-29 14:38:16.263 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:38:16.263 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 10ms reading results.
2026-01-29 14:38:16.265 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:38:16.267 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (1ms).
2026-01-29 14:38:16.276 -03:00 [INF] Retrieved 1 usuarios
2026-01-29 14:38:16.279 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:38:16.281 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:38:16.282 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 14:38:16.282 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 14:38:16.283 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 14:38:16.284 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Project_Gon.Core.DTOs.Usuario.UsuarioDto, Project_Gon.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-29 14:38:16.297 -03:00 [INF] Executed action Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api) in 441.6739ms
2026-01-29 14:38:16.301 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:38:16.303 -03:00 [INF] HTTP GET /api/usuarios responded 200 in 506.6012 ms
2026-01-29 14:38:16.307 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:38:16.314 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:38:16.318 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (4ms).
2026-01-29 14:38:16.320 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7058/api/usuarios - 200 null application/json; charset=utf-8 549.3056ms
2026-01-29 14:38:16.323 -03:00 [DBG] Connection id "0HNIVBKNF0O4V", Request id "0HNIVBKNF0O4V:00000001": started reading request body.
2026-01-29 14:38:16.324 -03:00 [DBG] Connection id "0HNIVBKNF0O4V", Request id "0HNIVBKNF0O4V:00000001": done reading request body.
2026-01-29 14:40:29.086 -03:00 [DBG] Connection id "0HNIVBKNF0O4V" is closing.
2026-01-29 14:40:29.086 -03:00 [DBG] Connection id "0HNIVBKNF0O4V" is closed. The last processed stream ID was 1.
2026-01-29 14:40:29.089 -03:00 [DBG] The connection queue processing loop for 0HNIVBKNF0O4V completed.
2026-01-29 14:40:29.091 -03:00 [DBG] Connection id "0HNIVBKNF0O4V" stopped.
2026-01-29 14:40:29.092 -03:00 [DBG] Connection id "0HNIVBKNF0O4V" sending FIN because: "The Socket transport's send loop completed gracefully."
2026-01-29 14:44:51.508 -03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2026-01-29 14:44:51.842 -03:00 [DBG] The index {'ProductoId'} was not created on entity type 'Stock' as the properties are already covered by the index {'ProductoId', 'SucursalId'}.
2026-01-29 14:44:51.844 -03:00 [DBG] The index {'EmpresaId'} was not created on entity type 'Usuario' as the properties are already covered by the index {'EmpresaId', 'Email'}.
2026-01-29 14:44:51.845 -03:00 [DBG] The index {'EmpresaId'} was not created on entity type 'Usuario' as the properties are already covered by the index {'EmpresaId', 'Rut'}.
2026-01-29 14:44:51.916 -03:00 [DBG] The property 'MovimientoStock.DevolucionId' was created in shadow state because there are no eligible CLR members with a matching name.
2026-01-29 14:44:51.973 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:44:51.985 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:44:52.000 -03:00 [DBG] Created DbConnection. (15ms).
2026-01-29 14:44:52.003 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:44:52.182 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:44:52.185 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:44:52.189 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2026-01-29 14:44:52.190 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2026-01-29 14:44:52.194 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:44:52.218 -03:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:44:52.236 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:44:52.241 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 19ms reading results.
2026-01-29 14:44:52.243 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:44:52.245 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (2ms).
2026-01-29 14:44:52.344 -03:00 [DBG] Migrating using database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:44:52.347 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:44:52.349 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:44:52.386 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:44:52.387 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:44:52.389 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (1ms).
2026-01-29 14:44:52.389 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:44:52.390 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:44:52.416 -03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2026-01-29 14:44:52.417 -03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2026-01-29 14:44:52.418 -03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2026-01-29 14:44:52.418 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2026-01-29 14:44:52.447 -03:00 [INF] Executed DbCommand (29ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2026-01-29 14:44:52.450 -03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2026-01-29 14:44:52.452 -03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2026-01-29 14:44:52.453 -03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2026-01-29 14:44:52.454 -03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2026-01-29 14:44:52.455 -03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2026-01-29 14:44:52.455 -03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2026-01-29 14:44:52.456 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2026-01-29 14:44:52.457 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2026-01-29 14:44:52.458 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:44:52.459 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:44:52.459 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:44:52.460 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:44:52.461 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:44:52.462 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:44:52.463 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 14:44:52.468 -03:00 [INF] No migrations were applied. The database is already up to date.
2026-01-29 14:44:52.469 -03:00 [DBG] Committing transaction.
2026-01-29 14:44:52.472 -03:00 [DBG] Committed transaction.
2026-01-29 14:44:52.473 -03:00 [DBG] Disposing transaction.
2026-01-29 14:44:52.474 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:44:52.475 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:44:52.476 -03:00 [INF] Database migrations applied successfully
2026-01-29 14:44:52.477 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:44:52.478 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:44:52.479 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:44:52.499 -03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2026-01-29 14:44:52.530 -03:00 [DBG] Registered SignalR Protocol: json, implemented by Microsoft.AspNetCore.SignalR.Protocol.JsonHubProtocol.
2026-01-29 14:44:52.542 -03:00 [INF] Project Gon API iniciada en ambiente: Development
2026-01-29 14:44:52.544 -03:00 [DBG] Hosting starting
2026-01-29 14:44:52.552 -03:00 [INF] User profile is available. Using 'C:\Users\Jossan\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2026-01-29 14:44:52.557 -03:00 [DBG] Reading data from file 'C:\Users\Jossan\AppData\Local\ASP.NET\DataProtection-Keys\key-7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c.xml'.
2026-01-29 14:44:52.562 -03:00 [DBG] Found key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c}.
2026-01-29 14:44:52.567 -03:00 [DBG] Considering key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c} with expiration date 2026-04-28 18:20:11Z as default key.
2026-01-29 14:44:52.569 -03:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=9.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2026-01-29 14:44:52.570 -03:00 [DBG] Decrypting secret element using Windows DPAPI.
2026-01-29 14:44:52.571 -03:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=9.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2026-01-29 14:44:52.573 -03:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2026-01-29 14:44:52.574 -03:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2026-01-29 14:44:52.575 -03:00 [DBG] Using key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c} as the default key.
2026-01-29 14:44:52.576 -03:00 [DBG] Key ring with default key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c} was loaded during application startup.
2026-01-29 14:44:52.578 -03:00 [DBG] Middleware loaded
2026-01-29 14:44:52.579 -03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16515 B).
2026-01-29 14:44:52.580 -03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2026-01-29 14:44:52.622 -03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2026-01-29 14:44:52.623 -03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2026-01-29 14:44:52.625 -03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2026-01-29 14:44:52.650 -03:00 [INF] Now listening on: https://localhost:7058
2026-01-29 14:44:52.650 -03:00 [INF] Now listening on: http://localhost:5070
2026-01-29 14:44:52.651 -03:00 [DBG] Loaded hosting startup assembly Project_Gon.Api
2026-01-29 14:44:52.651 -03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2026-01-29 14:44:52.652 -03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2026-01-29 14:44:52.652 -03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2026-01-29 14:44:52.655 -03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2026-01-29 14:44:52.658 -03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2026-01-29 14:44:52.679 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2026-01-29 14:44:52.680 -03:00 [INF] Hosting environment: Development
2026-01-29 14:44:52.680 -03:00 [INF] Content root path: C:\Proyectos\Project_Gon\Project_Gon.Api
2026-01-29 14:44:52.682 -03:00 [DBG] Hosting started
2026-01-29 14:45:00.483 -03:00 [DBG] Connection id "0HNIVBOG31PAH" accepted.
2026-01-29 14:45:00.484 -03:00 [DBG] Connection id "0HNIVBOG31PAH" started.
2026-01-29 14:45:00.508 -03:00 [DBG] Connection 0HNIVBOG31PAH established using the following protocol: "Tls12"
2026-01-29 14:45:00.524 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7058/api/usuarios - application/json 69
2026-01-29 14:45:00.540 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios'
2026-01-29 14:45:00.541 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)' with route pattern 'api/Usuarios' is valid for the request path '/api/usuarios'
2026-01-29 14:45:00.542 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:45:00.546 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:45:00.607 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:45:00.608 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:45:00.609 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:45:00.612 -03:00 [DBG] Authorization was successful.
2026-01-29 14:45:00.613 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:45:00.619 -03:00 [INF] Route matched with {action = "GetAll", controller = "Usuarios"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Project_Gon.Core.DTOs.Usuario.UsuarioDto]]] GetAll() on controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api).
2026-01-29 14:45:00.621 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:45:00.622 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:45:00.623 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:45:00.624 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:45:00.625 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:45:00.627 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:45:00.699 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:45:00.714 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:45:00.743 -03:00 [DBG] Compiling query expression: 
'DbSet<Usuario>()
    .AsNoTracking()
    .Include(u => u.Empresa)
    .Include(u => u.Sucursal)'
2026-01-29 14:45:00.786 -03:00 [DBG] Including navigation: 'Usuario.Empresa'.
2026-01-29 14:45:00.788 -03:00 [DBG] Including navigation: 'Usuario.Sucursal'.
2026-01-29 14:45:00.913 -03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Usuario>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
            1 -> Dictionary<IProperty, int> { [Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Empresa.Activo (bool) Required, 14], [Property: Empresa.Ciudad (string), 15], [Property: Empresa.CreatedAt (DateTime) Required, 16], [Property: Empresa.Direccion (string), 17], [Property: Empresa.Nombre (string) Required MaxLength(255), 18], [Property: Empresa.Region (string), 19], [Property: Empresa.Rut (string), 20], [Property: Empresa.UpdatedAt (DateTime?), 21] }
            2 -> Dictionary<IProperty, int> { [Property: Sucursal.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 22], [Property: Sucursal.Activo (bool) Required, 23], [Property: Sucursal.Ciudad (string), 24], [Property: Sucursal.CreatedAt (DateTime) Required, 25], [Property: Sucursal.Direccion (string), 26], [Property: Sucursal.EmpresaId (int) Required FK Index, 27], [Property: Sucursal.Nombre (string) Required MaxLength(255), 28], [Property: Sucursal.Region (string), 29], [Property: Sucursal.Telefono (string), 30], [Property: Sucursal.UpdatedAt (DateTime?), 31] }
        SELECT u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt, e.Id, e.Activo, e.Ciudad, e.CreatedAt, e.Direccion, e.Nombre, e.Region, e.Rut, e.UpdatedAt, s.Id, s.Activo, s.Ciudad, s.CreatedAt, s.Direccion, s.EmpresaId, s.Nombre, s.Region, s.Telefono, s.UpdatedAt
        FROM Usuarios AS u
        INNER JOIN Empresas AS e ON u.EmpresaId == e.Id
        LEFT JOIN Sucursales AS s ON u.SucursalId == s.Id) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
            1 -> Dictionary<IProperty, int> { [Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Empresa.Activo (bool) Required, 14], [Property: Empresa.Ciudad (string), 15], [Property: Empresa.CreatedAt (DateTime) Required, 16], [Property: Empresa.Direccion (string), 17], [Property: Empresa.Nombre (string) Required MaxLength(255), 18], [Property: Empresa.Region (string), 19], [Property: Empresa.Rut (string), 20], [Property: Empresa.UpdatedAt (DateTime?), 21] }
            2 -> Dictionary<IProperty, int> { [Property: Sucursal.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 22], [Property: Sucursal.Activo (bool) Required, 23], [Property: Sucursal.Ciudad (string), 24], [Property: Sucursal.CreatedAt (DateTime) Required, 25], [Property: Sucursal.Direccion (string), 26], [Property: Sucursal.EmpresaId (int) Required FK Index, 27], [Property: Sucursal.Nombre (string) Required MaxLength(255), 28], [Property: Sucursal.Region (string), 29], [Property: Sucursal.Telefono (string), 30], [Property: Sucursal.UpdatedAt (DateTime?), 31] }
        SELECT u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt, e.Id, e.Activo, e.Ciudad, e.CreatedAt, e.Direccion, e.Nombre, e.Region, e.Rut, e.UpdatedAt, s.Id, s.Activo, s.Ciudad, s.CreatedAt, s.Direccion, s.EmpresaId, s.Nombre, s.Region, s.Telefono, s.UpdatedAt
        FROM Usuarios AS u
        INNER JOIN Empresas AS e ON u.EmpresaId == e.Id
        LEFT JOIN Sucursales AS s ON u.SucursalId == s.Id, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Usuario entity;
        Empresa entity;
        Sucursal entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Usuario instance1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Usuario);
            (object)dataReader.GetInt32(0) != null ? 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]: 
                        {
                            return 
                            {
                                Usuario instance;
                                instance = new Usuario();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<Activo>k__BackingField = dataReader.GetBoolean(1);
                                instance.<Apellido>k__BackingField = dataReader.GetString(2);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(3);
                                instance.<Email>k__BackingField = dataReader.IsDBNull(4) ? default(string) : dataReader.GetString(4);
                                instance.<EmpresaId>k__BackingField = dataReader.GetInt32(5);
                                instance.<Nombre>k__BackingField = dataReader.GetString(6);
                                instance.<PasswordHash>k__BackingField = dataReader.GetString(7);
                                instance.<Rol>k__BackingField = Invoke(((EnumToNumberConverter<RolUsuario, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Usuario.Rol (RolUsuario) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindProperty("Rol")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(8));
                                instance.<Rut>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                instance.<SucursalId>k__BackingField = dataReader.IsDBNull(10) ? default(int?) : (int?)dataReader.GetInt32(10);
                                instance.<UltimoAcceso>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(11);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(12) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(12);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Usuario)
                }
                ;
                return instance1;
            } : 
            {
                object[] keyValues1;
                keyValues1 = new object[]{ (object)dataReader.GetInt32(0) };
                return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                    entityType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")], 
                    properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindPrimaryKey().Properties], 
                    keyValues: keyValues1);
            };
            return instance1;
        };
        entity = 
        {
            MaterializationContext materializationContext2;
            IEntityType entityType2;
            Empresa instance2;
            materializationContext2 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance2 = default(Empresa);
            (object)dataReader.GetInt32(13) != null ? 
            {
                ISnapshot shadowSnapshot2;
                shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType2 = [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")];
                instance2 = switch (entityType2)
                {
                    case [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")]: 
                        {
                            return 
                            {
                                Empresa instance;
                                instance = new Empresa();
                                instance.<Id>k__BackingField = dataReader.GetInt32(13);
                                instance.<Activo>k__BackingField = dataReader.GetBoolean(14);
                                instance.<Ciudad>k__BackingField = dataReader.IsDBNull(15) ? default(string) : dataReader.GetString(15);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(16);
                                instance.<Direccion>k__BackingField = dataReader.IsDBNull(17) ? default(string) : dataReader.GetString(17);
                                instance.<Nombre>k__BackingField = dataReader.GetString(18);
                                instance.<Region>k__BackingField = dataReader.IsDBNull(19) ? default(string) : dataReader.GetString(19);
                                instance.<Rut>k__BackingField = dataReader.IsDBNull(20) ? default(string) : dataReader.GetString(20);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(21) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(21);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext2.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Empresa)
                }
                ;
                return instance2;
            } : 
            {
                object[] keyValues2;
                keyValues2 = new object[]{ (object)dataReader.GetInt32(13) };
                return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                    entityType: [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")], 
                    properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindPrimaryKey().Properties], 
                    keyValues: keyValues2);
            };
            return instance2;
        };
        entity = 
        {
            MaterializationContext materializationContext3;
            IEntityType entityType3;
            Sucursal instance3;
            materializationContext3 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance3 = default(Sucursal);
            dataReader.IsDBNull(22) ? default(object) : (object)dataReader.GetInt32(22) != null ? 
            {
                ISnapshot shadowSnapshot3;
                shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType3 = [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")];
                instance3 = switch (entityType3)
                {
                    case [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")]: 
                        {
                            return 
                            {
                                Sucursal instance;
                                instance = new Sucursal();
                                instance.<Id>k__BackingField = dataReader.IsDBNull(22) ? default(int) : dataReader.GetInt32(22);
                                instance.<Activo>k__BackingField = dataReader.IsDBNull(23) ? default(bool) : dataReader.GetBoolean(23);
                                instance.<Ciudad>k__BackingField = dataReader.IsDBNull(24) ? default(string) : dataReader.GetString(24);
                                instance.<CreatedAt>k__BackingField = dataReader.IsDBNull(25) ? default(DateTime) : dataReader.GetDateTime(25);
                                instance.<Direccion>k__BackingField = dataReader.IsDBNull(26) ? default(string) : dataReader.GetString(26);
                                instance.<EmpresaId>k__BackingField = dataReader.IsDBNull(27) ? default(int) : dataReader.GetInt32(27);
                                instance.<Nombre>k__BackingField = dataReader.IsDBNull(28) ? default(string) : dataReader.GetString(28);
                                instance.<Region>k__BackingField = dataReader.IsDBNull(29) ? default(string) : dataReader.GetString(29);
                                instance.<Telefono>k__BackingField = dataReader.IsDBNull(30) ? default(string) : dataReader.GetString(30);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(31) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(31);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext3.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Sucursal)
                }
                ;
                return instance3;
            } : default(void);
            return instance3;
        };
        ShaperProcessingExpressionVisitor.IncludeReference<Usuario, Usuario, Empresa>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: Usuario.Empresa (Empresa) ToPrincipal Empresa Inverse: Usuarios | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindNavigation("Empresa")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Empresa.Usuarios (ICollection<Usuario>) Collection ToDependent Usuario Inverse: Empresa | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindNavigation("Usuarios")], 
            fixup: (namelessParameter{14}, namelessParameter{15}) => 
            {
                namelessParameter{14}.<Empresa>k__BackingField = namelessParameter{15};
                return [LIFTABLE Constant: ClrICollectionAccessor<Empresa, ICollection<Usuario>, Usuario> | Resolver: namelessParameter{16} => namelessParameter{16}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindNavigation("Usuarios").GetCollectionAccessor()].Add(
                    entity: namelessParameter{15}, 
                    value: namelessParameter{14}, 
                    forMaterialization: True);
            }, 
            trackingQuery: False);
        ShaperProcessingExpressionVisitor.IncludeReference<Usuario, Usuario, Sucursal>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: Usuario.Sucursal (Sucursal) ToPrincipal Sucursal Inverse: Usuarios | Resolver: namelessParameter{17} => namelessParameter{17}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindNavigation("Sucursal")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Sucursal.Usuarios (ICollection<Usuario>) Collection ToDependent Usuario Inverse: Sucursal | Resolver: namelessParameter{18} => namelessParameter{18}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal").FindNavigation("Usuarios")], 
            fixup: (namelessParameter{19}, namelessParameter{20}) => 
            {
                namelessParameter{19}.<Sucursal>k__BackingField = namelessParameter{20};
                return [LIFTABLE Constant: ClrICollectionAccessor<Sucursal, ICollection<Usuario>, Usuario> | Resolver: namelessParameter{21} => namelessParameter{21}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal").FindNavigation("Usuarios").GetCollectionAccessor()].Add(
                    entity: namelessParameter{20}, 
                    value: namelessParameter{19}, 
                    forMaterialization: True);
            }, 
            trackingQuery: False);
        return entity;
    }, 
    contextType: Project_Gon.Infrastructure.Data.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2026-01-29 14:45:00.946 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:45:00.947 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 14:45:00.948 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:00.949 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:00.950 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:45:00.950 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:45:00.951 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:45:00.952 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
2026-01-29 14:45:00.960 -03:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
2026-01-29 14:45:00.972 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:00.973 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 11ms reading results.
2026-01-29 14:45:00.975 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:00.976 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:45:00.985 -03:00 [INF] Retrieved 1 usuarios
2026-01-29 14:45:00.988 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:45:00.990 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:45:00.990 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 14:45:00.991 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 14:45:00.991 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 14:45:00.992 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Project_Gon.Core.DTOs.Usuario.UsuarioDto, Project_Gon.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-29 14:45:01.005 -03:00 [INF] Executed action Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api) in 377.2726ms
2026-01-29 14:45:01.008 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:45:01.010 -03:00 [INF] HTTP GET /api/usuarios responded 200 in 462.0856 ms
2026-01-29 14:45:01.014 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:45:01.016 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:01.017 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (1ms).
2026-01-29 14:45:01.019 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7058/api/usuarios - 200 null application/json; charset=utf-8 496.1313ms
2026-01-29 14:45:01.021 -03:00 [DBG] Connection id "0HNIVBOG31PAH", Request id "0HNIVBOG31PAH:00000001": started reading request body.
2026-01-29 14:45:01.022 -03:00 [DBG] Connection id "0HNIVBOG31PAH", Request id "0HNIVBOG31PAH:00000001": done reading request body.
2026-01-29 14:45:02.313 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7058/api/usuarios - application/json 69
2026-01-29 14:45:02.315 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios'
2026-01-29 14:45:02.315 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)' with route pattern 'api/Usuarios' is valid for the request path '/api/usuarios'
2026-01-29 14:45:02.316 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:45:02.317 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:45:02.318 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:45:02.319 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:45:02.319 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:45:02.321 -03:00 [DBG] Authorization was successful.
2026-01-29 14:45:02.321 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:45:02.322 -03:00 [INF] Route matched with {action = "GetAll", controller = "Usuarios"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Project_Gon.Core.DTOs.Usuario.UsuarioDto]]] GetAll() on controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api).
2026-01-29 14:45:02.323 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:45:02.324 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:45:02.325 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:45:02.326 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:45:02.326 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:45:02.327 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:45:02.329 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:45:02.358 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:45:02.362 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:45:02.362 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 14:45:02.363 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:02.363 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:02.364 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:45:02.364 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:45:02.365 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:45:02.366 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
2026-01-29 14:45:02.368 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
2026-01-29 14:45:02.370 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:02.370 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 1ms reading results.
2026-01-29 14:45:02.371 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:02.372 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:45:02.373 -03:00 [INF] Retrieved 1 usuarios
2026-01-29 14:45:02.373 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:45:02.375 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:45:02.375 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 14:45:02.376 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 14:45:02.376 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 14:45:02.377 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Project_Gon.Core.DTOs.Usuario.UsuarioDto, Project_Gon.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-29 14:45:02.378 -03:00 [INF] Executed action Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api) in 50.6986ms
2026-01-29 14:45:02.379 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:45:02.379 -03:00 [INF] HTTP GET /api/usuarios responded 200 in 61.7950 ms
2026-01-29 14:45:02.380 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:45:02.381 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:02.381 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:45:02.382 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7058/api/usuarios - 200 null application/json; charset=utf-8 69.5956ms
2026-01-29 14:45:02.384 -03:00 [DBG] Connection id "0HNIVBOG31PAH", Request id "0HNIVBOG31PAH:00000003": started reading request body.
2026-01-29 14:45:02.384 -03:00 [DBG] Connection id "0HNIVBOG31PAH", Request id "0HNIVBOG31PAH:00000003": done reading request body.
2026-01-29 14:45:09.209 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7058/api/usuarios - application/json 69
2026-01-29 14:45:09.210 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios'
2026-01-29 14:45:09.211 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)' with route pattern 'api/Usuarios' is valid for the request path '/api/usuarios'
2026-01-29 14:45:09.213 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:45:09.215 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:45:09.217 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:45:09.217 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:45:09.218 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:45:09.220 -03:00 [DBG] Authorization was successful.
2026-01-29 14:45:09.220 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:45:09.221 -03:00 [INF] Route matched with {action = "GetAll", controller = "Usuarios"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Project_Gon.Core.DTOs.Usuario.UsuarioDto]]] GetAll() on controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api).
2026-01-29 14:45:09.222 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:45:09.223 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:45:09.224 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:45:09.225 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:45:09.225 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:45:09.226 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:45:09.228 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:45:09.229 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:45:09.231 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:45:09.232 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 14:45:09.232 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:09.233 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:09.233 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:45:09.234 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:45:09.234 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:45:09.235 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
2026-01-29 14:45:09.238 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
2026-01-29 14:45:09.239 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:09.240 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 14:45:09.241 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:09.241 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:45:09.242 -03:00 [INF] Retrieved 1 usuarios
2026-01-29 14:45:09.243 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:45:09.244 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:45:09.244 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 14:45:09.245 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 14:45:09.245 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 14:45:09.246 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Project_Gon.Core.DTOs.Usuario.UsuarioDto, Project_Gon.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-29 14:45:09.247 -03:00 [INF] Executed action Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api) in 21.0334ms
2026-01-29 14:45:09.248 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetAll (Project_Gon.Api)'
2026-01-29 14:45:09.248 -03:00 [INF] HTTP GET /api/usuarios responded 200 in 32.9966 ms
2026-01-29 14:45:09.249 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:45:09.250 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:09.250 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:45:09.251 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7058/api/usuarios - 200 null application/json; charset=utf-8 42.3432ms
2026-01-29 14:45:09.253 -03:00 [DBG] Connection id "0HNIVBOG31PAH", Request id "0HNIVBOG31PAH:00000005": started reading request body.
2026-01-29 14:45:09.254 -03:00 [DBG] Connection id "0HNIVBOG31PAH", Request id "0HNIVBOG31PAH:00000005": done reading request body.
2026-01-29 14:45:28.849 -03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2026-01-29 14:45:29.189 -03:00 [DBG] The index {'ProductoId'} was not created on entity type 'Stock' as the properties are already covered by the index {'ProductoId', 'SucursalId'}.
2026-01-29 14:45:29.191 -03:00 [DBG] The index {'EmpresaId'} was not created on entity type 'Usuario' as the properties are already covered by the index {'EmpresaId', 'Email'}.
2026-01-29 14:45:29.192 -03:00 [DBG] The index {'EmpresaId'} was not created on entity type 'Usuario' as the properties are already covered by the index {'EmpresaId', 'Rut'}.
2026-01-29 14:45:29.264 -03:00 [DBG] The property 'MovimientoStock.DevolucionId' was created in shadow state because there are no eligible CLR members with a matching name.
2026-01-29 14:45:29.325 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:45:29.336 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:45:29.352 -03:00 [DBG] Created DbConnection. (15ms).
2026-01-29 14:45:29.355 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:29.431 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:29.434 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:45:29.438 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2026-01-29 14:45:29.439 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2026-01-29 14:45:29.443 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:45:29.462 -03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:45:29.480 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:29.485 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 19ms reading results.
2026-01-29 14:45:29.487 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:29.490 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (2ms).
2026-01-29 14:45:29.592 -03:00 [DBG] Migrating using database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:29.595 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:29.597 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:29.630 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:29.631 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:29.633 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (1ms).
2026-01-29 14:45:29.634 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:29.636 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:29.662 -03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2026-01-29 14:45:29.663 -03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2026-01-29 14:45:29.663 -03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2026-01-29 14:45:29.664 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2026-01-29 14:45:29.669 -03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2026-01-29 14:45:29.672 -03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2026-01-29 14:45:29.674 -03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2026-01-29 14:45:29.675 -03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2026-01-29 14:45:29.676 -03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2026-01-29 14:45:29.677 -03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2026-01-29 14:45:29.677 -03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2026-01-29 14:45:29.678 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2026-01-29 14:45:29.679 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2026-01-29 14:45:29.680 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:45:29.681 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:45:29.681 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:45:29.682 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:45:29.683 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:45:29.685 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:29.685 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 14:45:29.690 -03:00 [INF] No migrations were applied. The database is already up to date.
2026-01-29 14:45:29.691 -03:00 [DBG] Committing transaction.
2026-01-29 14:45:29.728 -03:00 [DBG] Committed transaction.
2026-01-29 14:45:29.729 -03:00 [DBG] Disposing transaction.
2026-01-29 14:45:29.730 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:29.730 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:45:29.731 -03:00 [INF] Database migrations applied successfully
2026-01-29 14:45:29.733 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:45:29.734 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:45:29.735 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:45:29.755 -03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2026-01-29 14:45:29.785 -03:00 [DBG] Registered SignalR Protocol: json, implemented by Microsoft.AspNetCore.SignalR.Protocol.JsonHubProtocol.
2026-01-29 14:45:29.798 -03:00 [INF] Project Gon API iniciada en ambiente: Development
2026-01-29 14:45:29.800 -03:00 [DBG] Hosting starting
2026-01-29 14:45:29.808 -03:00 [INF] User profile is available. Using 'C:\Users\Jossan\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2026-01-29 14:45:29.812 -03:00 [DBG] Reading data from file 'C:\Users\Jossan\AppData\Local\ASP.NET\DataProtection-Keys\key-7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c.xml'.
2026-01-29 14:45:29.817 -03:00 [DBG] Found key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c}.
2026-01-29 14:45:29.823 -03:00 [DBG] Considering key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c} with expiration date 2026-04-28 18:20:11Z as default key.
2026-01-29 14:45:29.824 -03:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=9.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2026-01-29 14:45:29.825 -03:00 [DBG] Decrypting secret element using Windows DPAPI.
2026-01-29 14:45:29.826 -03:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=9.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2026-01-29 14:45:29.828 -03:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2026-01-29 14:45:29.829 -03:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2026-01-29 14:45:29.830 -03:00 [DBG] Using key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c} as the default key.
2026-01-29 14:45:29.831 -03:00 [DBG] Key ring with default key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c} was loaded during application startup.
2026-01-29 14:45:29.833 -03:00 [DBG] Middleware loaded
2026-01-29 14:45:29.834 -03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16515 B).
2026-01-29 14:45:29.835 -03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2026-01-29 14:45:29.876 -03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2026-01-29 14:45:29.877 -03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2026-01-29 14:45:29.879 -03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2026-01-29 14:45:29.905 -03:00 [INF] Now listening on: https://localhost:7058
2026-01-29 14:45:29.905 -03:00 [INF] Now listening on: http://localhost:5070
2026-01-29 14:45:29.906 -03:00 [DBG] Loaded hosting startup assembly Project_Gon.Api
2026-01-29 14:45:29.906 -03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2026-01-29 14:45:29.907 -03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2026-01-29 14:45:29.907 -03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2026-01-29 14:45:29.910 -03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2026-01-29 14:45:29.913 -03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2026-01-29 14:45:29.935 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2026-01-29 14:45:29.935 -03:00 [INF] Hosting environment: Development
2026-01-29 14:45:29.936 -03:00 [INF] Content root path: C:\Proyectos\Project_Gon\Project_Gon.Api
2026-01-29 14:45:29.937 -03:00 [DBG] Hosting started
2026-01-29 14:51:01.676 -03:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2026-01-29 14:51:02.038 -03:00 [DBG] The index {'ProductoId'} was not created on entity type 'Stock' as the properties are already covered by the index {'ProductoId', 'SucursalId'}.
2026-01-29 14:51:02.040 -03:00 [DBG] The index {'EmpresaId'} was not created on entity type 'Usuario' as the properties are already covered by the index {'EmpresaId', 'Email'}.
2026-01-29 14:51:02.041 -03:00 [DBG] The index {'EmpresaId'} was not created on entity type 'Usuario' as the properties are already covered by the index {'EmpresaId', 'Rut'}.
2026-01-29 14:51:02.118 -03:00 [DBG] The property 'MovimientoStock.DevolucionId' was created in shadow state because there are no eligible CLR members with a matching name.
2026-01-29 14:51:02.177 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:51:02.189 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:51:02.206 -03:00 [DBG] Created DbConnection. (16ms).
2026-01-29 14:51:02.209 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:02.288 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:02.291 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:51:02.295 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2026-01-29 14:51:02.296 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (6ms).
2026-01-29 14:51:02.301 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:51:02.327 -03:00 [INF] Executed DbCommand (16ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:51:02.347 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:02.353 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 22ms reading results.
2026-01-29 14:51:02.355 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:02.358 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (2ms).
2026-01-29 14:51:02.458 -03:00 [DBG] Migrating using database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:02.461 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:02.463 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:02.609 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:02.610 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:02.611 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (1ms).
2026-01-29 14:51:02.612 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:02.613 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:02.639 -03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2026-01-29 14:51:02.639 -03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2026-01-29 14:51:02.640 -03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2026-01-29 14:51:02.641 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2026-01-29 14:51:02.646 -03:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE IF NOT EXISTS "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
2026-01-29 14:51:02.649 -03:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2026-01-29 14:51:02.651 -03:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2026-01-29 14:51:02.653 -03:00 [INF] Acquiring an exclusive lock for migration application. See https://aka.ms/efcore-docs-migrations-lock for more information if this takes too long.
2026-01-29 14:51:02.653 -03:00 [DBG] Creating DbCommand for 'ExecuteNonQuery'.
2026-01-29 14:51:02.654 -03:00 [DBG] Created DbCommand for 'ExecuteNonQuery' (0ms).
2026-01-29 14:51:02.654 -03:00 [DBG] Initialized DbCommand for 'ExecuteNonQuery' (1ms).
2026-01-29 14:51:02.655 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2026-01-29 14:51:02.656 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
LOCK TABLE "__EFMigrationsHistory" IN ACCESS EXCLUSIVE MODE
2026-01-29 14:51:02.657 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:51:02.658 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:51:02.658 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:51:02.659 -03:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:51:02.660 -03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
2026-01-29 14:51:02.661 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:02.662 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 1ms reading results.
2026-01-29 14:51:02.667 -03:00 [INF] No migrations were applied. The database is already up to date.
2026-01-29 14:51:02.668 -03:00 [DBG] Committing transaction.
2026-01-29 14:51:02.705 -03:00 [DBG] Committed transaction.
2026-01-29 14:51:02.706 -03:00 [DBG] Disposing transaction.
2026-01-29 14:51:02.707 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:02.707 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:51:02.709 -03:00 [INF] Database migrations applied successfully
2026-01-29 14:51:02.710 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:51:02.712 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:02.712 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:51:02.733 -03:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2026-01-29 14:51:02.762 -03:00 [DBG] Registered SignalR Protocol: json, implemented by Microsoft.AspNetCore.SignalR.Protocol.JsonHubProtocol.
2026-01-29 14:51:02.774 -03:00 [INF] Project Gon API iniciada en ambiente: Development
2026-01-29 14:51:02.776 -03:00 [DBG] Hosting starting
2026-01-29 14:51:02.784 -03:00 [INF] User profile is available. Using 'C:\Users\Jossan\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2026-01-29 14:51:02.789 -03:00 [DBG] Reading data from file 'C:\Users\Jossan\AppData\Local\ASP.NET\DataProtection-Keys\key-7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c.xml'.
2026-01-29 14:51:02.794 -03:00 [DBG] Found key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c}.
2026-01-29 14:51:02.799 -03:00 [DBG] Considering key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c} with expiration date 2026-04-28 18:20:11Z as default key.
2026-01-29 14:51:02.801 -03:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=9.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2026-01-29 14:51:02.802 -03:00 [DBG] Decrypting secret element using Windows DPAPI.
2026-01-29 14:51:02.803 -03:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=9.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2026-01-29 14:51:02.805 -03:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2026-01-29 14:51:02.806 -03:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2026-01-29 14:51:02.807 -03:00 [DBG] Using key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c} as the default key.
2026-01-29 14:51:02.808 -03:00 [DBG] Key ring with default key {7e5fd75b-dac7-44c1-ba43-f0abb7c83c5c} was loaded during application startup.
2026-01-29 14:51:02.810 -03:00 [DBG] Middleware loaded
2026-01-29 14:51:02.811 -03:00 [DBG] Middleware loaded. Script /_framework/aspnetcore-browser-refresh.js (16515 B).
2026-01-29 14:51:02.813 -03:00 [DBG] Middleware loaded. Script /_framework/blazor-hotreload.js (799 B).
2026-01-29 14:51:02.855 -03:00 [DBG] Middleware configuration started with options: {AllowedHosts = *, AllowEmptyHosts = True, IncludeFailureMessage = True}
2026-01-29 14:51:02.856 -03:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2026-01-29 14:51:02.858 -03:00 [DBG] Middleware loaded: DOTNET_MODIFIABLE_ASSEMBLIES=debug, __ASPNETCORE_BROWSER_TOOLS=true
2026-01-29 14:51:02.885 -03:00 [INF] Now listening on: https://localhost:7058
2026-01-29 14:51:02.886 -03:00 [INF] Now listening on: http://localhost:5070
2026-01-29 14:51:02.886 -03:00 [DBG] Loaded hosting startup assembly Project_Gon.Api
2026-01-29 14:51:02.887 -03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.ApiEndpointDiscovery
2026-01-29 14:51:02.887 -03:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2026-01-29 14:51:02.888 -03:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2026-01-29 14:51:02.890 -03:00 [DBG] Executing API description provider 'EndpointMetadataApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2026-01-29 14:51:02.893 -03:00 [DBG] Executing API description provider 'DefaultApiDescriptionProvider' from assembly Microsoft.AspNetCore.Mvc.ApiExplorer v9.0.0.0.
2026-01-29 14:51:02.916 -03:00 [INF] Application started. Press Ctrl+C to shut down.
2026-01-29 14:51:02.917 -03:00 [INF] Hosting environment: Development
2026-01-29 14:51:02.918 -03:00 [INF] Content root path: C:\Proyectos\Project_Gon\Project_Gon.Api
2026-01-29 14:51:02.919 -03:00 [DBG] Hosting started
2026-01-29 14:51:03.141 -03:00 [DBG] Connection id "0HNIVBRS5KAG3" accepted.
2026-01-29 14:51:03.142 -03:00 [DBG] Connection id "0HNIVBRS5KAG3" started.
2026-01-29 14:51:03.167 -03:00 [DBG] Connection 0HNIVBRS5KAG3 established using the following protocol: "Tls12"
2026-01-29 14:51:03.183 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7058/api/usuarios/empresa/3 - application/json 69
2026-01-29 14:51:03.200 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios/empresa/3'
2026-01-29 14:51:03.201 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetByEmpresa (Project_Gon.Api)' with route pattern 'api/Usuarios/empresa/{empresaId}' is valid for the request path '/api/usuarios/empresa/3'
2026-01-29 14:51:03.202 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetByEmpresa (Project_Gon.Api)'
2026-01-29 14:51:03.206 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:51:03.309 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:51:03.310 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:51:03.311 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:51:03.315 -03:00 [DBG] Authorization was successful.
2026-01-29 14:51:03.316 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetByEmpresa (Project_Gon.Api)'
2026-01-29 14:51:03.325 -03:00 [INF] Route matched with {action = "GetByEmpresa", controller = "Usuarios"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Project_Gon.Core.DTOs.Usuario.UsuarioDto]]] GetByEmpresa(Int32) on controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api).
2026-01-29 14:51:03.327 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:51:03.328 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:51:03.329 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:51:03.330 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:51:03.331 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:51:03.333 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:51:03.404 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:51:03.407 -03:00 [DBG] Attempting to bind parameter 'empresaId' of type 'System.Int32' ...
2026-01-29 14:51:03.408 -03:00 [DBG] Attempting to bind parameter 'empresaId' of type 'System.Int32' using the name 'empresaId' in request data ...
2026-01-29 14:51:03.409 -03:00 [DBG] Done attempting to bind parameter 'empresaId' of type 'System.Int32'.
2026-01-29 14:51:03.410 -03:00 [DBG] Done attempting to bind parameter 'empresaId' of type 'System.Int32'.
2026-01-29 14:51:03.410 -03:00 [DBG] Attempting to validate the bound parameter 'empresaId' of type 'System.Int32' ...
2026-01-29 14:51:03.416 -03:00 [DBG] Done attempting to validate the bound parameter 'empresaId' of type 'System.Int32'.
2026-01-29 14:51:03.434 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:51:03.477 -03:00 [DBG] Compiling query expression: 
'DbSet<Usuario>()
    .AsNoTracking()
    .Include(u => u.Empresa)
    .Include(u => u.Sucursal)
    .Where(u => u.EmpresaId == __empresaId_0)'
2026-01-29 14:51:03.532 -03:00 [DBG] Including navigation: 'Usuario.Empresa'.
2026-01-29 14:51:03.534 -03:00 [DBG] Including navigation: 'Usuario.Sucursal'.
2026-01-29 14:51:03.671 -03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Usuario>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
            1 -> Dictionary<IProperty, int> { [Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Empresa.Activo (bool) Required, 14], [Property: Empresa.Ciudad (string), 15], [Property: Empresa.CreatedAt (DateTime) Required, 16], [Property: Empresa.Direccion (string), 17], [Property: Empresa.Nombre (string) Required MaxLength(255), 18], [Property: Empresa.Region (string), 19], [Property: Empresa.Rut (string), 20], [Property: Empresa.UpdatedAt (DateTime?), 21] }
            2 -> Dictionary<IProperty, int> { [Property: Sucursal.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 22], [Property: Sucursal.Activo (bool) Required, 23], [Property: Sucursal.Ciudad (string), 24], [Property: Sucursal.CreatedAt (DateTime) Required, 25], [Property: Sucursal.Direccion (string), 26], [Property: Sucursal.EmpresaId (int) Required FK Index, 27], [Property: Sucursal.Nombre (string) Required MaxLength(255), 28], [Property: Sucursal.Region (string), 29], [Property: Sucursal.Telefono (string), 30], [Property: Sucursal.UpdatedAt (DateTime?), 31] }
        SELECT u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt, e.Id, e.Activo, e.Ciudad, e.CreatedAt, e.Direccion, e.Nombre, e.Region, e.Rut, e.UpdatedAt, s.Id, s.Activo, s.Ciudad, s.CreatedAt, s.Direccion, s.EmpresaId, s.Nombre, s.Region, s.Telefono, s.UpdatedAt
        FROM Usuarios AS u
        INNER JOIN Empresas AS e ON u.EmpresaId == e.Id
        LEFT JOIN Sucursales AS s ON u.SucursalId == s.Id
        WHERE u.EmpresaId == @__empresaId_0) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
            1 -> Dictionary<IProperty, int> { [Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Empresa.Activo (bool) Required, 14], [Property: Empresa.Ciudad (string), 15], [Property: Empresa.CreatedAt (DateTime) Required, 16], [Property: Empresa.Direccion (string), 17], [Property: Empresa.Nombre (string) Required MaxLength(255), 18], [Property: Empresa.Region (string), 19], [Property: Empresa.Rut (string), 20], [Property: Empresa.UpdatedAt (DateTime?), 21] }
            2 -> Dictionary<IProperty, int> { [Property: Sucursal.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 22], [Property: Sucursal.Activo (bool) Required, 23], [Property: Sucursal.Ciudad (string), 24], [Property: Sucursal.CreatedAt (DateTime) Required, 25], [Property: Sucursal.Direccion (string), 26], [Property: Sucursal.EmpresaId (int) Required FK Index, 27], [Property: Sucursal.Nombre (string) Required MaxLength(255), 28], [Property: Sucursal.Region (string), 29], [Property: Sucursal.Telefono (string), 30], [Property: Sucursal.UpdatedAt (DateTime?), 31] }
        SELECT u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt, e.Id, e.Activo, e.Ciudad, e.CreatedAt, e.Direccion, e.Nombre, e.Region, e.Rut, e.UpdatedAt, s.Id, s.Activo, s.Ciudad, s.CreatedAt, s.Direccion, s.EmpresaId, s.Nombre, s.Region, s.Telefono, s.UpdatedAt
        FROM Usuarios AS u
        INNER JOIN Empresas AS e ON u.EmpresaId == e.Id
        LEFT JOIN Sucursales AS s ON u.SucursalId == s.Id
        WHERE u.EmpresaId == @__empresaId_0, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Usuario entity;
        Empresa entity;
        Sucursal entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Usuario instance1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Usuario);
            (object)dataReader.GetInt32(0) != null ? 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]: 
                        {
                            return 
                            {
                                Usuario instance;
                                instance = new Usuario();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<Activo>k__BackingField = dataReader.GetBoolean(1);
                                instance.<Apellido>k__BackingField = dataReader.GetString(2);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(3);
                                instance.<Email>k__BackingField = dataReader.IsDBNull(4) ? default(string) : dataReader.GetString(4);
                                instance.<EmpresaId>k__BackingField = dataReader.GetInt32(5);
                                instance.<Nombre>k__BackingField = dataReader.GetString(6);
                                instance.<PasswordHash>k__BackingField = dataReader.GetString(7);
                                instance.<Rol>k__BackingField = Invoke(((EnumToNumberConverter<RolUsuario, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Usuario.Rol (RolUsuario) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindProperty("Rol")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(8));
                                instance.<Rut>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                instance.<SucursalId>k__BackingField = dataReader.IsDBNull(10) ? default(int?) : (int?)dataReader.GetInt32(10);
                                instance.<UltimoAcceso>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(11);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(12) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(12);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Usuario)
                }
                ;
                return instance1;
            } : 
            {
                object[] keyValues1;
                keyValues1 = new object[]{ (object)dataReader.GetInt32(0) };
                return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                    entityType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")], 
                    properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindPrimaryKey().Properties], 
                    keyValues: keyValues1);
            };
            return instance1;
        };
        entity = 
        {
            MaterializationContext materializationContext2;
            IEntityType entityType2;
            Empresa instance2;
            materializationContext2 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance2 = default(Empresa);
            (object)dataReader.GetInt32(13) != null ? 
            {
                ISnapshot shadowSnapshot2;
                shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType2 = [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")];
                instance2 = switch (entityType2)
                {
                    case [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")]: 
                        {
                            return 
                            {
                                Empresa instance;
                                instance = new Empresa();
                                instance.<Id>k__BackingField = dataReader.GetInt32(13);
                                instance.<Activo>k__BackingField = dataReader.GetBoolean(14);
                                instance.<Ciudad>k__BackingField = dataReader.IsDBNull(15) ? default(string) : dataReader.GetString(15);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(16);
                                instance.<Direccion>k__BackingField = dataReader.IsDBNull(17) ? default(string) : dataReader.GetString(17);
                                instance.<Nombre>k__BackingField = dataReader.GetString(18);
                                instance.<Region>k__BackingField = dataReader.IsDBNull(19) ? default(string) : dataReader.GetString(19);
                                instance.<Rut>k__BackingField = dataReader.IsDBNull(20) ? default(string) : dataReader.GetString(20);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(21) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(21);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext2.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Empresa)
                }
                ;
                return instance2;
            } : 
            {
                object[] keyValues2;
                keyValues2 = new object[]{ (object)dataReader.GetInt32(13) };
                return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                    entityType: [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")], 
                    properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindPrimaryKey().Properties], 
                    keyValues: keyValues2);
            };
            return instance2;
        };
        entity = 
        {
            MaterializationContext materializationContext3;
            IEntityType entityType3;
            Sucursal instance3;
            materializationContext3 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance3 = default(Sucursal);
            dataReader.IsDBNull(22) ? default(object) : (object)dataReader.GetInt32(22) != null ? 
            {
                ISnapshot shadowSnapshot3;
                shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType3 = [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")];
                instance3 = switch (entityType3)
                {
                    case [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")]: 
                        {
                            return 
                            {
                                Sucursal instance;
                                instance = new Sucursal();
                                instance.<Id>k__BackingField = dataReader.IsDBNull(22) ? default(int) : dataReader.GetInt32(22);
                                instance.<Activo>k__BackingField = dataReader.IsDBNull(23) ? default(bool) : dataReader.GetBoolean(23);
                                instance.<Ciudad>k__BackingField = dataReader.IsDBNull(24) ? default(string) : dataReader.GetString(24);
                                instance.<CreatedAt>k__BackingField = dataReader.IsDBNull(25) ? default(DateTime) : dataReader.GetDateTime(25);
                                instance.<Direccion>k__BackingField = dataReader.IsDBNull(26) ? default(string) : dataReader.GetString(26);
                                instance.<EmpresaId>k__BackingField = dataReader.IsDBNull(27) ? default(int) : dataReader.GetInt32(27);
                                instance.<Nombre>k__BackingField = dataReader.IsDBNull(28) ? default(string) : dataReader.GetString(28);
                                instance.<Region>k__BackingField = dataReader.IsDBNull(29) ? default(string) : dataReader.GetString(29);
                                instance.<Telefono>k__BackingField = dataReader.IsDBNull(30) ? default(string) : dataReader.GetString(30);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(31) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(31);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext3.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Sucursal)
                }
                ;
                return instance3;
            } : default(void);
            return instance3;
        };
        ShaperProcessingExpressionVisitor.IncludeReference<Usuario, Usuario, Empresa>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: Usuario.Empresa (Empresa) ToPrincipal Empresa Inverse: Usuarios | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindNavigation("Empresa")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Empresa.Usuarios (ICollection<Usuario>) Collection ToDependent Usuario Inverse: Empresa | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindNavigation("Usuarios")], 
            fixup: (namelessParameter{14}, namelessParameter{15}) => 
            {
                namelessParameter{14}.<Empresa>k__BackingField = namelessParameter{15};
                return [LIFTABLE Constant: ClrICollectionAccessor<Empresa, ICollection<Usuario>, Usuario> | Resolver: namelessParameter{16} => namelessParameter{16}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindNavigation("Usuarios").GetCollectionAccessor()].Add(
                    entity: namelessParameter{15}, 
                    value: namelessParameter{14}, 
                    forMaterialization: True);
            }, 
            trackingQuery: False);
        ShaperProcessingExpressionVisitor.IncludeReference<Usuario, Usuario, Sucursal>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: Usuario.Sucursal (Sucursal) ToPrincipal Sucursal Inverse: Usuarios | Resolver: namelessParameter{17} => namelessParameter{17}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindNavigation("Sucursal")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Sucursal.Usuarios (ICollection<Usuario>) Collection ToDependent Usuario Inverse: Sucursal | Resolver: namelessParameter{18} => namelessParameter{18}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal").FindNavigation("Usuarios")], 
            fixup: (namelessParameter{19}, namelessParameter{20}) => 
            {
                namelessParameter{19}.<Sucursal>k__BackingField = namelessParameter{20};
                return [LIFTABLE Constant: ClrICollectionAccessor<Sucursal, ICollection<Usuario>, Usuario> | Resolver: namelessParameter{21} => namelessParameter{21}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal").FindNavigation("Usuarios").GetCollectionAccessor()].Add(
                    entity: namelessParameter{20}, 
                    value: namelessParameter{19}, 
                    forMaterialization: True);
            }, 
            trackingQuery: False);
        return entity;
    }, 
    contextType: Project_Gon.Infrastructure.Data.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2026-01-29 14:51:03.712 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:51:03.713 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 14:51:03.714 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:03.716 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:03.716 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:51:03.717 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:51:03.719 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (2ms).
2026-01-29 14:51:03.721 -03:00 [DBG] Executing DbCommand [Parameters=[@__empresaId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
WHERE u."EmpresaId" = @__empresaId_0
2026-01-29 14:51:03.734 -03:00 [INF] Executed DbCommand (14ms) [Parameters=[@__empresaId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
WHERE u."EmpresaId" = @__empresaId_0
2026-01-29 14:51:03.748 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:03.749 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 13ms reading results.
2026-01-29 14:51:03.751 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:03.752 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:51:03.762 -03:00 [INF] Retrieved 1 usuarios for empresa 3
2026-01-29 14:51:03.765 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:51:03.767 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:51:03.768 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 14:51:03.768 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 14:51:03.769 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 14:51:03.770 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Project_Gon.Core.DTOs.Usuario.UsuarioDto, Project_Gon.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-29 14:51:03.783 -03:00 [INF] Executed action Project_Gon.Api.Controllers.UsuariosController.GetByEmpresa (Project_Gon.Api) in 449.5422ms
2026-01-29 14:51:03.787 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetByEmpresa (Project_Gon.Api)'
2026-01-29 14:51:03.789 -03:00 [INF] HTTP GET /api/usuarios/empresa/3 responded 200 in 580.3463 ms
2026-01-29 14:51:03.792 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:51:03.795 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:03.796 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (1ms).
2026-01-29 14:51:03.798 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7058/api/usuarios/empresa/3 - 200 null application/json; charset=utf-8 616.1088ms
2026-01-29 14:51:03.801 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:00000001": started reading request body.
2026-01-29 14:51:03.801 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:00000001": done reading request body.
2026-01-29 14:51:31.739 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7058/api/usuarios/sucursal/2 - application/json 69
2026-01-29 14:51:31.743 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios/sucursal/2'
2026-01-29 14:51:31.744 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetBySucursal (Project_Gon.Api)' with route pattern 'api/Usuarios/sucursal/{sucursalId}' is valid for the request path '/api/usuarios/sucursal/2'
2026-01-29 14:51:31.748 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetBySucursal (Project_Gon.Api)'
2026-01-29 14:51:31.749 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:51:31.752 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:51:31.753 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:51:31.753 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:51:31.755 -03:00 [DBG] Authorization was successful.
2026-01-29 14:51:31.756 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetBySucursal (Project_Gon.Api)'
2026-01-29 14:51:31.761 -03:00 [INF] Route matched with {action = "GetBySucursal", controller = "Usuarios"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Project_Gon.Core.DTOs.Usuario.UsuarioDto]]] GetBySucursal(Int32) on controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api).
2026-01-29 14:51:31.763 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:51:31.763 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:51:31.764 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:51:31.765 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:51:31.766 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:51:31.767 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:51:31.770 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:51:31.771 -03:00 [DBG] Attempting to bind parameter 'sucursalId' of type 'System.Int32' ...
2026-01-29 14:51:31.772 -03:00 [DBG] Attempting to bind parameter 'sucursalId' of type 'System.Int32' using the name 'sucursalId' in request data ...
2026-01-29 14:51:31.773 -03:00 [DBG] Done attempting to bind parameter 'sucursalId' of type 'System.Int32'.
2026-01-29 14:51:31.774 -03:00 [DBG] Done attempting to bind parameter 'sucursalId' of type 'System.Int32'.
2026-01-29 14:51:31.775 -03:00 [DBG] Attempting to validate the bound parameter 'sucursalId' of type 'System.Int32' ...
2026-01-29 14:51:31.777 -03:00 [DBG] Done attempting to validate the bound parameter 'sucursalId' of type 'System.Int32'.
2026-01-29 14:51:31.812 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:51:31.815 -03:00 [DBG] Compiling query expression: 
'DbSet<Usuario>()
    .AsNoTracking()
    .Include(u => u.Empresa)
    .Include(u => u.Sucursal)
    .Where(u => u.SucursalId == __sucursalId_0)'
2026-01-29 14:51:31.816 -03:00 [DBG] Including navigation: 'Usuario.Empresa'.
2026-01-29 14:51:31.817 -03:00 [DBG] Including navigation: 'Usuario.Sucursal'.
2026-01-29 14:51:31.823 -03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Usuario>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
            1 -> Dictionary<IProperty, int> { [Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Empresa.Activo (bool) Required, 14], [Property: Empresa.Ciudad (string), 15], [Property: Empresa.CreatedAt (DateTime) Required, 16], [Property: Empresa.Direccion (string), 17], [Property: Empresa.Nombre (string) Required MaxLength(255), 18], [Property: Empresa.Region (string), 19], [Property: Empresa.Rut (string), 20], [Property: Empresa.UpdatedAt (DateTime?), 21] }
            2 -> Dictionary<IProperty, int> { [Property: Sucursal.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 22], [Property: Sucursal.Activo (bool) Required, 23], [Property: Sucursal.Ciudad (string), 24], [Property: Sucursal.CreatedAt (DateTime) Required, 25], [Property: Sucursal.Direccion (string), 26], [Property: Sucursal.EmpresaId (int) Required FK Index, 27], [Property: Sucursal.Nombre (string) Required MaxLength(255), 28], [Property: Sucursal.Region (string), 29], [Property: Sucursal.Telefono (string), 30], [Property: Sucursal.UpdatedAt (DateTime?), 31] }
        SELECT u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt, e.Id, e.Activo, e.Ciudad, e.CreatedAt, e.Direccion, e.Nombre, e.Region, e.Rut, e.UpdatedAt, s.Id, s.Activo, s.Ciudad, s.CreatedAt, s.Direccion, s.EmpresaId, s.Nombre, s.Region, s.Telefono, s.UpdatedAt
        FROM Usuarios AS u
        INNER JOIN Empresas AS e ON u.EmpresaId == e.Id
        LEFT JOIN Sucursales AS s ON u.SucursalId == s.Id
        WHERE u.SucursalId == @__sucursalId_0) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
            1 -> Dictionary<IProperty, int> { [Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Empresa.Activo (bool) Required, 14], [Property: Empresa.Ciudad (string), 15], [Property: Empresa.CreatedAt (DateTime) Required, 16], [Property: Empresa.Direccion (string), 17], [Property: Empresa.Nombre (string) Required MaxLength(255), 18], [Property: Empresa.Region (string), 19], [Property: Empresa.Rut (string), 20], [Property: Empresa.UpdatedAt (DateTime?), 21] }
            2 -> Dictionary<IProperty, int> { [Property: Sucursal.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 22], [Property: Sucursal.Activo (bool) Required, 23], [Property: Sucursal.Ciudad (string), 24], [Property: Sucursal.CreatedAt (DateTime) Required, 25], [Property: Sucursal.Direccion (string), 26], [Property: Sucursal.EmpresaId (int) Required FK Index, 27], [Property: Sucursal.Nombre (string) Required MaxLength(255), 28], [Property: Sucursal.Region (string), 29], [Property: Sucursal.Telefono (string), 30], [Property: Sucursal.UpdatedAt (DateTime?), 31] }
        SELECT u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt, e.Id, e.Activo, e.Ciudad, e.CreatedAt, e.Direccion, e.Nombre, e.Region, e.Rut, e.UpdatedAt, s.Id, s.Activo, s.Ciudad, s.CreatedAt, s.Direccion, s.EmpresaId, s.Nombre, s.Region, s.Telefono, s.UpdatedAt
        FROM Usuarios AS u
        INNER JOIN Empresas AS e ON u.EmpresaId == e.Id
        LEFT JOIN Sucursales AS s ON u.SucursalId == s.Id
        WHERE u.SucursalId == @__sucursalId_0, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Usuario entity;
        Empresa entity;
        Sucursal entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Usuario instance1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Usuario);
            (object)dataReader.GetInt32(0) != null ? 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]: 
                        {
                            return 
                            {
                                Usuario instance;
                                instance = new Usuario();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<Activo>k__BackingField = dataReader.GetBoolean(1);
                                instance.<Apellido>k__BackingField = dataReader.GetString(2);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(3);
                                instance.<Email>k__BackingField = dataReader.IsDBNull(4) ? default(string) : dataReader.GetString(4);
                                instance.<EmpresaId>k__BackingField = dataReader.GetInt32(5);
                                instance.<Nombre>k__BackingField = dataReader.GetString(6);
                                instance.<PasswordHash>k__BackingField = dataReader.GetString(7);
                                instance.<Rol>k__BackingField = Invoke(((EnumToNumberConverter<RolUsuario, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Usuario.Rol (RolUsuario) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindProperty("Rol")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(8));
                                instance.<Rut>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                instance.<SucursalId>k__BackingField = dataReader.IsDBNull(10) ? default(int?) : (int?)dataReader.GetInt32(10);
                                instance.<UltimoAcceso>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(11);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(12) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(12);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Usuario)
                }
                ;
                return instance1;
            } : 
            {
                object[] keyValues1;
                keyValues1 = new object[]{ (object)dataReader.GetInt32(0) };
                return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                    entityType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")], 
                    properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindPrimaryKey().Properties], 
                    keyValues: keyValues1);
            };
            return instance1;
        };
        entity = 
        {
            MaterializationContext materializationContext2;
            IEntityType entityType2;
            Empresa instance2;
            materializationContext2 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance2 = default(Empresa);
            (object)dataReader.GetInt32(13) != null ? 
            {
                ISnapshot shadowSnapshot2;
                shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType2 = [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")];
                instance2 = switch (entityType2)
                {
                    case [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")]: 
                        {
                            return 
                            {
                                Empresa instance;
                                instance = new Empresa();
                                instance.<Id>k__BackingField = dataReader.GetInt32(13);
                                instance.<Activo>k__BackingField = dataReader.GetBoolean(14);
                                instance.<Ciudad>k__BackingField = dataReader.IsDBNull(15) ? default(string) : dataReader.GetString(15);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(16);
                                instance.<Direccion>k__BackingField = dataReader.IsDBNull(17) ? default(string) : dataReader.GetString(17);
                                instance.<Nombre>k__BackingField = dataReader.GetString(18);
                                instance.<Region>k__BackingField = dataReader.IsDBNull(19) ? default(string) : dataReader.GetString(19);
                                instance.<Rut>k__BackingField = dataReader.IsDBNull(20) ? default(string) : dataReader.GetString(20);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(21) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(21);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext2.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Empresa)
                }
                ;
                return instance2;
            } : 
            {
                object[] keyValues2;
                keyValues2 = new object[]{ (object)dataReader.GetInt32(13) };
                return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                    entityType: [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")], 
                    properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindPrimaryKey().Properties], 
                    keyValues: keyValues2);
            };
            return instance2;
        };
        entity = 
        {
            MaterializationContext materializationContext3;
            IEntityType entityType3;
            Sucursal instance3;
            materializationContext3 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance3 = default(Sucursal);
            dataReader.IsDBNull(22) ? default(object) : (object)dataReader.GetInt32(22) != null ? 
            {
                ISnapshot shadowSnapshot3;
                shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType3 = [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")];
                instance3 = switch (entityType3)
                {
                    case [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")]: 
                        {
                            return 
                            {
                                Sucursal instance;
                                instance = new Sucursal();
                                instance.<Id>k__BackingField = dataReader.IsDBNull(22) ? default(int) : dataReader.GetInt32(22);
                                instance.<Activo>k__BackingField = dataReader.IsDBNull(23) ? default(bool) : dataReader.GetBoolean(23);
                                instance.<Ciudad>k__BackingField = dataReader.IsDBNull(24) ? default(string) : dataReader.GetString(24);
                                instance.<CreatedAt>k__BackingField = dataReader.IsDBNull(25) ? default(DateTime) : dataReader.GetDateTime(25);
                                instance.<Direccion>k__BackingField = dataReader.IsDBNull(26) ? default(string) : dataReader.GetString(26);
                                instance.<EmpresaId>k__BackingField = dataReader.IsDBNull(27) ? default(int) : dataReader.GetInt32(27);
                                instance.<Nombre>k__BackingField = dataReader.IsDBNull(28) ? default(string) : dataReader.GetString(28);
                                instance.<Region>k__BackingField = dataReader.IsDBNull(29) ? default(string) : dataReader.GetString(29);
                                instance.<Telefono>k__BackingField = dataReader.IsDBNull(30) ? default(string) : dataReader.GetString(30);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(31) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(31);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext3.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Sucursal)
                }
                ;
                return instance3;
            } : default(void);
            return instance3;
        };
        ShaperProcessingExpressionVisitor.IncludeReference<Usuario, Usuario, Empresa>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: Usuario.Empresa (Empresa) ToPrincipal Empresa Inverse: Usuarios | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindNavigation("Empresa")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Empresa.Usuarios (ICollection<Usuario>) Collection ToDependent Usuario Inverse: Empresa | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindNavigation("Usuarios")], 
            fixup: (namelessParameter{14}, namelessParameter{15}) => 
            {
                namelessParameter{14}.<Empresa>k__BackingField = namelessParameter{15};
                return [LIFTABLE Constant: ClrICollectionAccessor<Empresa, ICollection<Usuario>, Usuario> | Resolver: namelessParameter{16} => namelessParameter{16}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindNavigation("Usuarios").GetCollectionAccessor()].Add(
                    entity: namelessParameter{15}, 
                    value: namelessParameter{14}, 
                    forMaterialization: True);
            }, 
            trackingQuery: False);
        ShaperProcessingExpressionVisitor.IncludeReference<Usuario, Usuario, Sucursal>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: Usuario.Sucursal (Sucursal) ToPrincipal Sucursal Inverse: Usuarios | Resolver: namelessParameter{17} => namelessParameter{17}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindNavigation("Sucursal")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Sucursal.Usuarios (ICollection<Usuario>) Collection ToDependent Usuario Inverse: Sucursal | Resolver: namelessParameter{18} => namelessParameter{18}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal").FindNavigation("Usuarios")], 
            fixup: (namelessParameter{19}, namelessParameter{20}) => 
            {
                namelessParameter{19}.<Sucursal>k__BackingField = namelessParameter{20};
                return [LIFTABLE Constant: ClrICollectionAccessor<Sucursal, ICollection<Usuario>, Usuario> | Resolver: namelessParameter{21} => namelessParameter{21}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal").FindNavigation("Usuarios").GetCollectionAccessor()].Add(
                    entity: namelessParameter{20}, 
                    value: namelessParameter{19}, 
                    forMaterialization: True);
            }, 
            trackingQuery: False);
        return entity;
    }, 
    contextType: Project_Gon.Infrastructure.Data.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2026-01-29 14:51:31.844 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:51:31.844 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 14:51:31.845 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:31.846 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:31.846 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:51:31.847 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:51:31.847 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:51:31.848 -03:00 [DBG] Executing DbCommand [Parameters=[@__sucursalId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
WHERE u."SucursalId" = @__sucursalId_0
2026-01-29 14:51:31.850 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__sucursalId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
WHERE u."SucursalId" = @__sucursalId_0
2026-01-29 14:51:31.853 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:31.853 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 1ms reading results.
2026-01-29 14:51:31.854 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:31.855 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:51:31.856 -03:00 [INF] Retrieved 1 usuarios for sucursal 2
2026-01-29 14:51:31.857 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:51:31.858 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:51:31.858 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 14:51:31.859 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 14:51:31.860 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 14:51:31.860 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Project_Gon.Core.DTOs.Usuario.UsuarioDto, Project_Gon.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-29 14:51:31.862 -03:00 [INF] Executed action Project_Gon.Api.Controllers.UsuariosController.GetBySucursal (Project_Gon.Api) in 94.374ms
2026-01-29 14:51:31.862 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetBySucursal (Project_Gon.Api)'
2026-01-29 14:51:31.863 -03:00 [INF] HTTP GET /api/usuarios/sucursal/2 responded 200 in 112.0572 ms
2026-01-29 14:51:31.864 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:51:31.864 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:51:31.865 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:51:31.866 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7058/api/usuarios/sucursal/2 - 200 null application/json; charset=utf-8 127.3365ms
2026-01-29 14:51:31.868 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:00000003": started reading request body.
2026-01-29 14:51:31.868 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:00000003": done reading request body.
2026-01-29 14:53:07.658 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7058/api/usuarios/rol/Vendedor - application/json 69
2026-01-29 14:53:07.659 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios/rol/Vendedor'
2026-01-29 14:53:07.660 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetByRol (Project_Gon.Api)' with route pattern 'api/Usuarios/rol/{rol}' is valid for the request path '/api/usuarios/rol/Vendedor'
2026-01-29 14:53:07.661 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetByRol (Project_Gon.Api)'
2026-01-29 14:53:07.662 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:53:07.664 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:53:07.664 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:53:07.665 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:53:07.666 -03:00 [DBG] Authorization was successful.
2026-01-29 14:53:07.666 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetByRol (Project_Gon.Api)'
2026-01-29 14:53:07.669 -03:00 [INF] Route matched with {action = "GetByRol", controller = "Usuarios"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Project_Gon.Core.DTOs.Usuario.UsuarioDto]]] GetByRol(Project_Gon.Core.Enums.RolUsuario) on controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api).
2026-01-29 14:53:07.671 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:53:07.672 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:53:07.672 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:53:07.673 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:53:07.674 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:53:07.675 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:53:07.677 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:53:07.678 -03:00 [DBG] Attempting to bind parameter 'rol' of type 'Project_Gon.Core.Enums.RolUsuario' ...
2026-01-29 14:53:07.678 -03:00 [DBG] Attempting to bind parameter 'rol' of type 'Project_Gon.Core.Enums.RolUsuario' using the name 'rol' in request data ...
2026-01-29 14:53:07.679 -03:00 [DBG] Done attempting to bind parameter 'rol' of type 'Project_Gon.Core.Enums.RolUsuario'.
2026-01-29 14:53:07.680 -03:00 [DBG] Done attempting to bind parameter 'rol' of type 'Project_Gon.Core.Enums.RolUsuario'.
2026-01-29 14:53:07.680 -03:00 [DBG] Attempting to validate the bound parameter 'rol' of type 'Project_Gon.Core.Enums.RolUsuario' ...
2026-01-29 14:53:07.681 -03:00 [DBG] Done attempting to validate the bound parameter 'rol' of type 'Project_Gon.Core.Enums.RolUsuario'.
2026-01-29 14:53:07.683 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:53:07.685 -03:00 [DBG] Compiling query expression: 
'DbSet<Usuario>()
    .AsNoTracking()
    .Include(u => u.Empresa)
    .Include(u => u.Sucursal)
    .Where(u => (int)u.Rol == (int)__rol_0)'
2026-01-29 14:53:07.686 -03:00 [DBG] Including navigation: 'Usuario.Empresa'.
2026-01-29 14:53:07.687 -03:00 [DBG] Including navigation: 'Usuario.Sucursal'.
2026-01-29 14:53:07.691 -03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Usuario>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
            1 -> Dictionary<IProperty, int> { [Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Empresa.Activo (bool) Required, 14], [Property: Empresa.Ciudad (string), 15], [Property: Empresa.CreatedAt (DateTime) Required, 16], [Property: Empresa.Direccion (string), 17], [Property: Empresa.Nombre (string) Required MaxLength(255), 18], [Property: Empresa.Region (string), 19], [Property: Empresa.Rut (string), 20], [Property: Empresa.UpdatedAt (DateTime?), 21] }
            2 -> Dictionary<IProperty, int> { [Property: Sucursal.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 22], [Property: Sucursal.Activo (bool) Required, 23], [Property: Sucursal.Ciudad (string), 24], [Property: Sucursal.CreatedAt (DateTime) Required, 25], [Property: Sucursal.Direccion (string), 26], [Property: Sucursal.EmpresaId (int) Required FK Index, 27], [Property: Sucursal.Nombre (string) Required MaxLength(255), 28], [Property: Sucursal.Region (string), 29], [Property: Sucursal.Telefono (string), 30], [Property: Sucursal.UpdatedAt (DateTime?), 31] }
        SELECT u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt, e.Id, e.Activo, e.Ciudad, e.CreatedAt, e.Direccion, e.Nombre, e.Region, e.Rut, e.UpdatedAt, s.Id, s.Activo, s.Ciudad, s.CreatedAt, s.Direccion, s.EmpresaId, s.Nombre, s.Region, s.Telefono, s.UpdatedAt
        FROM Usuarios AS u
        INNER JOIN Empresas AS e ON u.EmpresaId == e.Id
        LEFT JOIN Sucursales AS s ON u.SucursalId == s.Id
        WHERE u.Rol == @__rol_0) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
            1 -> Dictionary<IProperty, int> { [Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Empresa.Activo (bool) Required, 14], [Property: Empresa.Ciudad (string), 15], [Property: Empresa.CreatedAt (DateTime) Required, 16], [Property: Empresa.Direccion (string), 17], [Property: Empresa.Nombre (string) Required MaxLength(255), 18], [Property: Empresa.Region (string), 19], [Property: Empresa.Rut (string), 20], [Property: Empresa.UpdatedAt (DateTime?), 21] }
            2 -> Dictionary<IProperty, int> { [Property: Sucursal.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 22], [Property: Sucursal.Activo (bool) Required, 23], [Property: Sucursal.Ciudad (string), 24], [Property: Sucursal.CreatedAt (DateTime) Required, 25], [Property: Sucursal.Direccion (string), 26], [Property: Sucursal.EmpresaId (int) Required FK Index, 27], [Property: Sucursal.Nombre (string) Required MaxLength(255), 28], [Property: Sucursal.Region (string), 29], [Property: Sucursal.Telefono (string), 30], [Property: Sucursal.UpdatedAt (DateTime?), 31] }
        SELECT u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt, e.Id, e.Activo, e.Ciudad, e.CreatedAt, e.Direccion, e.Nombre, e.Region, e.Rut, e.UpdatedAt, s.Id, s.Activo, s.Ciudad, s.CreatedAt, s.Direccion, s.EmpresaId, s.Nombre, s.Region, s.Telefono, s.UpdatedAt
        FROM Usuarios AS u
        INNER JOIN Empresas AS e ON u.EmpresaId == e.Id
        LEFT JOIN Sucursales AS s ON u.SucursalId == s.Id
        WHERE u.Rol == @__rol_0, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Usuario entity;
        Empresa entity;
        Sucursal entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Usuario instance1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Usuario);
            (object)dataReader.GetInt32(0) != null ? 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]: 
                        {
                            return 
                            {
                                Usuario instance;
                                instance = new Usuario();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<Activo>k__BackingField = dataReader.GetBoolean(1);
                                instance.<Apellido>k__BackingField = dataReader.GetString(2);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(3);
                                instance.<Email>k__BackingField = dataReader.IsDBNull(4) ? default(string) : dataReader.GetString(4);
                                instance.<EmpresaId>k__BackingField = dataReader.GetInt32(5);
                                instance.<Nombre>k__BackingField = dataReader.GetString(6);
                                instance.<PasswordHash>k__BackingField = dataReader.GetString(7);
                                instance.<Rol>k__BackingField = Invoke(((EnumToNumberConverter<RolUsuario, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Usuario.Rol (RolUsuario) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindProperty("Rol")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(8));
                                instance.<Rut>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                instance.<SucursalId>k__BackingField = dataReader.IsDBNull(10) ? default(int?) : (int?)dataReader.GetInt32(10);
                                instance.<UltimoAcceso>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(11);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(12) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(12);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Usuario)
                }
                ;
                return instance1;
            } : 
            {
                object[] keyValues1;
                keyValues1 = new object[]{ (object)dataReader.GetInt32(0) };
                return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                    entityType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")], 
                    properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindPrimaryKey().Properties], 
                    keyValues: keyValues1);
            };
            return instance1;
        };
        entity = 
        {
            MaterializationContext materializationContext2;
            IEntityType entityType2;
            Empresa instance2;
            materializationContext2 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance2 = default(Empresa);
            (object)dataReader.GetInt32(13) != null ? 
            {
                ISnapshot shadowSnapshot2;
                shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType2 = [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")];
                instance2 = switch (entityType2)
                {
                    case [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")]: 
                        {
                            return 
                            {
                                Empresa instance;
                                instance = new Empresa();
                                instance.<Id>k__BackingField = dataReader.GetInt32(13);
                                instance.<Activo>k__BackingField = dataReader.GetBoolean(14);
                                instance.<Ciudad>k__BackingField = dataReader.IsDBNull(15) ? default(string) : dataReader.GetString(15);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(16);
                                instance.<Direccion>k__BackingField = dataReader.IsDBNull(17) ? default(string) : dataReader.GetString(17);
                                instance.<Nombre>k__BackingField = dataReader.GetString(18);
                                instance.<Region>k__BackingField = dataReader.IsDBNull(19) ? default(string) : dataReader.GetString(19);
                                instance.<Rut>k__BackingField = dataReader.IsDBNull(20) ? default(string) : dataReader.GetString(20);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(21) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(21);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext2.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Empresa)
                }
                ;
                return instance2;
            } : 
            {
                object[] keyValues2;
                keyValues2 = new object[]{ (object)dataReader.GetInt32(13) };
                return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                    entityType: [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")], 
                    properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindPrimaryKey().Properties], 
                    keyValues: keyValues2);
            };
            return instance2;
        };
        entity = 
        {
            MaterializationContext materializationContext3;
            IEntityType entityType3;
            Sucursal instance3;
            materializationContext3 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance3 = default(Sucursal);
            dataReader.IsDBNull(22) ? default(object) : (object)dataReader.GetInt32(22) != null ? 
            {
                ISnapshot shadowSnapshot3;
                shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType3 = [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")];
                instance3 = switch (entityType3)
                {
                    case [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")]: 
                        {
                            return 
                            {
                                Sucursal instance;
                                instance = new Sucursal();
                                instance.<Id>k__BackingField = dataReader.IsDBNull(22) ? default(int) : dataReader.GetInt32(22);
                                instance.<Activo>k__BackingField = dataReader.IsDBNull(23) ? default(bool) : dataReader.GetBoolean(23);
                                instance.<Ciudad>k__BackingField = dataReader.IsDBNull(24) ? default(string) : dataReader.GetString(24);
                                instance.<CreatedAt>k__BackingField = dataReader.IsDBNull(25) ? default(DateTime) : dataReader.GetDateTime(25);
                                instance.<Direccion>k__BackingField = dataReader.IsDBNull(26) ? default(string) : dataReader.GetString(26);
                                instance.<EmpresaId>k__BackingField = dataReader.IsDBNull(27) ? default(int) : dataReader.GetInt32(27);
                                instance.<Nombre>k__BackingField = dataReader.IsDBNull(28) ? default(string) : dataReader.GetString(28);
                                instance.<Region>k__BackingField = dataReader.IsDBNull(29) ? default(string) : dataReader.GetString(29);
                                instance.<Telefono>k__BackingField = dataReader.IsDBNull(30) ? default(string) : dataReader.GetString(30);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(31) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(31);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext3.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Sucursal)
                }
                ;
                return instance3;
            } : default(void);
            return instance3;
        };
        ShaperProcessingExpressionVisitor.IncludeReference<Usuario, Usuario, Empresa>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: Usuario.Empresa (Empresa) ToPrincipal Empresa Inverse: Usuarios | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindNavigation("Empresa")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Empresa.Usuarios (ICollection<Usuario>) Collection ToDependent Usuario Inverse: Empresa | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindNavigation("Usuarios")], 
            fixup: (namelessParameter{14}, namelessParameter{15}) => 
            {
                namelessParameter{14}.<Empresa>k__BackingField = namelessParameter{15};
                return [LIFTABLE Constant: ClrICollectionAccessor<Empresa, ICollection<Usuario>, Usuario> | Resolver: namelessParameter{16} => namelessParameter{16}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindNavigation("Usuarios").GetCollectionAccessor()].Add(
                    entity: namelessParameter{15}, 
                    value: namelessParameter{14}, 
                    forMaterialization: True);
            }, 
            trackingQuery: False);
        ShaperProcessingExpressionVisitor.IncludeReference<Usuario, Usuario, Sucursal>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: Usuario.Sucursal (Sucursal) ToPrincipal Sucursal Inverse: Usuarios | Resolver: namelessParameter{17} => namelessParameter{17}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindNavigation("Sucursal")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Sucursal.Usuarios (ICollection<Usuario>) Collection ToDependent Usuario Inverse: Sucursal | Resolver: namelessParameter{18} => namelessParameter{18}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal").FindNavigation("Usuarios")], 
            fixup: (namelessParameter{19}, namelessParameter{20}) => 
            {
                namelessParameter{19}.<Sucursal>k__BackingField = namelessParameter{20};
                return [LIFTABLE Constant: ClrICollectionAccessor<Sucursal, ICollection<Usuario>, Usuario> | Resolver: namelessParameter{21} => namelessParameter{21}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal").FindNavigation("Usuarios").GetCollectionAccessor()].Add(
                    entity: namelessParameter{20}, 
                    value: namelessParameter{19}, 
                    forMaterialization: True);
            }, 
            trackingQuery: False);
        return entity;
    }, 
    contextType: Project_Gon.Infrastructure.Data.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2026-01-29 14:53:07.708 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:53:07.708 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 14:53:07.709 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:53:07.710 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:53:07.710 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:53:07.711 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:53:07.712 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:53:07.713 -03:00 [DBG] Executing DbCommand [Parameters=[@__rol_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
WHERE u."Rol" = @__rol_0
2026-01-29 14:53:07.715 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__rol_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
WHERE u."Rol" = @__rol_0
2026-01-29 14:53:07.716 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:53:07.717 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 14:53:07.718 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:53:07.718 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:53:07.719 -03:00 [INF] Retrieved 1 usuarios with rol "Vendedor"
2026-01-29 14:53:07.720 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:53:07.721 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:53:07.722 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 14:53:07.722 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 14:53:07.722 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 14:53:07.723 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Project_Gon.Core.DTOs.Usuario.UsuarioDto, Project_Gon.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-29 14:53:07.724 -03:00 [INF] Executed action Project_Gon.Api.Controllers.UsuariosController.GetByRol (Project_Gon.Api) in 49.3238ms
2026-01-29 14:53:07.725 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetByRol (Project_Gon.Api)'
2026-01-29 14:53:07.725 -03:00 [INF] HTTP GET /api/usuarios/rol/Vendedor responded 200 in 62.8536 ms
2026-01-29 14:53:07.726 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:53:07.727 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:53:07.727 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:53:07.728 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7058/api/usuarios/rol/Vendedor - 200 null application/json; charset=utf-8 69.7971ms
2026-01-29 14:53:07.729 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:00000005": started reading request body.
2026-01-29 14:53:07.730 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:00000005": done reading request body.
2026-01-29 14:53:45.328 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7058/api/usuarios/empresa/3 - application/json 69
2026-01-29 14:53:45.329 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios/empresa/3'
2026-01-29 14:53:45.329 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetByEmpresa (Project_Gon.Api)' with route pattern 'api/Usuarios/empresa/{empresaId}' is valid for the request path '/api/usuarios/empresa/3'
2026-01-29 14:53:45.330 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetByEmpresa (Project_Gon.Api)'
2026-01-29 14:53:45.331 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:53:45.331 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:53:45.332 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:53:45.332 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:53:45.333 -03:00 [DBG] Authorization was successful.
2026-01-29 14:53:45.333 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetByEmpresa (Project_Gon.Api)'
2026-01-29 14:53:45.334 -03:00 [INF] Route matched with {action = "GetByEmpresa", controller = "Usuarios"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Project_Gon.Core.DTOs.Usuario.UsuarioDto]]] GetByEmpresa(Int32) on controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api).
2026-01-29 14:53:45.335 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:53:45.336 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:53:45.336 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:53:45.337 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:53:45.338 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:53:45.339 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:53:45.340 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:53:45.341 -03:00 [DBG] Attempting to bind parameter 'empresaId' of type 'System.Int32' ...
2026-01-29 14:53:45.341 -03:00 [DBG] Attempting to bind parameter 'empresaId' of type 'System.Int32' using the name 'empresaId' in request data ...
2026-01-29 14:53:45.342 -03:00 [DBG] Done attempting to bind parameter 'empresaId' of type 'System.Int32'.
2026-01-29 14:53:45.343 -03:00 [DBG] Done attempting to bind parameter 'empresaId' of type 'System.Int32'.
2026-01-29 14:53:45.343 -03:00 [DBG] Attempting to validate the bound parameter 'empresaId' of type 'System.Int32' ...
2026-01-29 14:53:45.344 -03:00 [DBG] Done attempting to validate the bound parameter 'empresaId' of type 'System.Int32'.
2026-01-29 14:53:45.345 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:53:45.348 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:53:45.348 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 14:53:45.348 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:53:45.349 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:53:45.350 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:53:45.350 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:53:45.351 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:53:45.352 -03:00 [DBG] Executing DbCommand [Parameters=[@__empresaId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
WHERE u."EmpresaId" = @__empresaId_0
2026-01-29 14:53:45.354 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__empresaId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
WHERE u."EmpresaId" = @__empresaId_0
2026-01-29 14:53:45.355 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:53:45.356 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 14:53:45.357 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:53:45.357 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:53:45.358 -03:00 [INF] Retrieved 1 usuarios for empresa 3
2026-01-29 14:53:45.359 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:53:45.360 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:53:45.360 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 14:53:45.361 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 14:53:45.361 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 14:53:45.362 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Project_Gon.Core.DTOs.Usuario.UsuarioDto, Project_Gon.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-29 14:53:45.363 -03:00 [INF] Executed action Project_Gon.Api.Controllers.UsuariosController.GetByEmpresa (Project_Gon.Api) in 23.7143ms
2026-01-29 14:53:45.363 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetByEmpresa (Project_Gon.Api)'
2026-01-29 14:53:45.364 -03:00 [INF] HTTP GET /api/usuarios/empresa/3 responded 200 in 32.6455 ms
2026-01-29 14:53:45.365 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:53:45.365 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:53:45.366 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:53:45.367 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7058/api/usuarios/empresa/3 - 200 null application/json; charset=utf-8 39.2736ms
2026-01-29 14:53:45.370 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:00000007": started reading request body.
2026-01-29 14:53:45.370 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:00000007": done reading request body.
2026-01-29 14:54:11.473 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7058/api/usuarios/sucursal/2 - application/json 69
2026-01-29 14:54:11.475 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios/sucursal/2'
2026-01-29 14:54:11.480 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetBySucursal (Project_Gon.Api)' with route pattern 'api/Usuarios/sucursal/{sucursalId}' is valid for the request path '/api/usuarios/sucursal/2'
2026-01-29 14:54:11.481 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetBySucursal (Project_Gon.Api)'
2026-01-29 14:54:11.482 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:54:11.483 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:54:11.483 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:54:11.484 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:54:11.485 -03:00 [DBG] Authorization was successful.
2026-01-29 14:54:11.485 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetBySucursal (Project_Gon.Api)'
2026-01-29 14:54:11.486 -03:00 [INF] Route matched with {action = "GetBySucursal", controller = "Usuarios"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Project_Gon.Core.DTOs.Usuario.UsuarioDto]]] GetBySucursal(Int32) on controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api).
2026-01-29 14:54:11.487 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:54:11.488 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:54:11.489 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:54:11.490 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:54:11.491 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:54:11.491 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:54:11.492 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:54:11.493 -03:00 [DBG] Attempting to bind parameter 'sucursalId' of type 'System.Int32' ...
2026-01-29 14:54:11.494 -03:00 [DBG] Attempting to bind parameter 'sucursalId' of type 'System.Int32' using the name 'sucursalId' in request data ...
2026-01-29 14:54:11.495 -03:00 [DBG] Done attempting to bind parameter 'sucursalId' of type 'System.Int32'.
2026-01-29 14:54:11.495 -03:00 [DBG] Done attempting to bind parameter 'sucursalId' of type 'System.Int32'.
2026-01-29 14:54:11.496 -03:00 [DBG] Attempting to validate the bound parameter 'sucursalId' of type 'System.Int32' ...
2026-01-29 14:54:11.497 -03:00 [DBG] Done attempting to validate the bound parameter 'sucursalId' of type 'System.Int32'.
2026-01-29 14:54:11.498 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:54:11.500 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:54:11.500 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 14:54:11.501 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:54:11.501 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:54:11.502 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:54:11.503 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:54:11.503 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:54:11.504 -03:00 [DBG] Executing DbCommand [Parameters=[@__sucursalId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
WHERE u."SucursalId" = @__sucursalId_0
2026-01-29 14:54:11.506 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__sucursalId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
WHERE u."SucursalId" = @__sucursalId_0
2026-01-29 14:54:11.508 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:54:11.508 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 14:54:11.509 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:54:11.510 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:54:11.510 -03:00 [INF] Retrieved 1 usuarios for sucursal 2
2026-01-29 14:54:11.511 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:54:11.512 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:54:11.512 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 14:54:11.513 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 14:54:11.513 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 14:54:11.514 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Project_Gon.Core.DTOs.Usuario.UsuarioDto, Project_Gon.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-29 14:54:11.515 -03:00 [INF] Executed action Project_Gon.Api.Controllers.UsuariosController.GetBySucursal (Project_Gon.Api) in 23.6921ms
2026-01-29 14:54:11.516 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetBySucursal (Project_Gon.Api)'
2026-01-29 14:54:11.516 -03:00 [INF] HTTP GET /api/usuarios/sucursal/2 responded 200 in 33.8524 ms
2026-01-29 14:54:11.517 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:54:11.518 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:54:11.519 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:54:11.519 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7058/api/usuarios/sucursal/2 - 200 null application/json; charset=utf-8 45.9616ms
2026-01-29 14:54:11.521 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:00000009": started reading request body.
2026-01-29 14:54:11.522 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:00000009": done reading request body.
2026-01-29 14:54:31.334 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7058/api/usuarios/rol/Vendedor - application/json 69
2026-01-29 14:54:31.335 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios/rol/Vendedor'
2026-01-29 14:54:31.335 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetByRol (Project_Gon.Api)' with route pattern 'api/Usuarios/rol/{rol}' is valid for the request path '/api/usuarios/rol/Vendedor'
2026-01-29 14:54:31.336 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetByRol (Project_Gon.Api)'
2026-01-29 14:54:31.337 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:54:31.337 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:54:31.338 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:54:31.338 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:54:31.339 -03:00 [DBG] Authorization was successful.
2026-01-29 14:54:31.339 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetByRol (Project_Gon.Api)'
2026-01-29 14:54:31.340 -03:00 [INF] Route matched with {action = "GetByRol", controller = "Usuarios"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Project_Gon.Core.DTOs.Usuario.UsuarioDto]]] GetByRol(Project_Gon.Core.Enums.RolUsuario) on controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api).
2026-01-29 14:54:31.341 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:54:31.342 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:54:31.343 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:54:31.344 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:54:31.345 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:54:31.345 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:54:31.346 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:54:31.347 -03:00 [DBG] Attempting to bind parameter 'rol' of type 'Project_Gon.Core.Enums.RolUsuario' ...
2026-01-29 14:54:31.348 -03:00 [DBG] Attempting to bind parameter 'rol' of type 'Project_Gon.Core.Enums.RolUsuario' using the name 'rol' in request data ...
2026-01-29 14:54:31.348 -03:00 [DBG] Done attempting to bind parameter 'rol' of type 'Project_Gon.Core.Enums.RolUsuario'.
2026-01-29 14:54:31.349 -03:00 [DBG] Done attempting to bind parameter 'rol' of type 'Project_Gon.Core.Enums.RolUsuario'.
2026-01-29 14:54:31.349 -03:00 [DBG] Attempting to validate the bound parameter 'rol' of type 'Project_Gon.Core.Enums.RolUsuario' ...
2026-01-29 14:54:31.350 -03:00 [DBG] Done attempting to validate the bound parameter 'rol' of type 'Project_Gon.Core.Enums.RolUsuario'.
2026-01-29 14:54:31.351 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:54:31.352 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:54:31.352 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 14:54:31.353 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:54:31.354 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:54:31.354 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:54:31.355 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:54:31.355 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:54:31.356 -03:00 [DBG] Executing DbCommand [Parameters=[@__rol_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
WHERE u."Rol" = @__rol_0
2026-01-29 14:54:31.358 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__rol_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
WHERE u."Rol" = @__rol_0
2026-01-29 14:54:31.360 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:54:31.360 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 14:54:31.361 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:54:31.361 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:54:31.362 -03:00 [INF] Retrieved 1 usuarios with rol "Vendedor"
2026-01-29 14:54:31.363 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:54:31.364 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:54:31.364 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 14:54:31.365 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 14:54:31.365 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 14:54:31.366 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Project_Gon.Core.DTOs.Usuario.UsuarioDto, Project_Gon.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-29 14:54:31.367 -03:00 [INF] Executed action Project_Gon.Api.Controllers.UsuariosController.GetByRol (Project_Gon.Api) in 21.3117ms
2026-01-29 14:54:31.367 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetByRol (Project_Gon.Api)'
2026-01-29 14:54:31.368 -03:00 [INF] HTTP GET /api/usuarios/rol/Vendedor responded 200 in 30.4530 ms
2026-01-29 14:54:31.369 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:54:31.369 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:54:31.370 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:54:31.371 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7058/api/usuarios/rol/Vendedor - 200 null application/json; charset=utf-8 37.0136ms
2026-01-29 14:54:31.372 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:0000000B": started reading request body.
2026-01-29 14:54:31.373 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:0000000B": done reading request body.
2026-01-29 14:54:51.245 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7058/api/usuarios/activos?activos=true - application/json 69
2026-01-29 14:54:51.247 -03:00 [DBG] 2 candidate(s) found for the request path '/api/usuarios/activos'
2026-01-29 14:54:51.247 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetActivos (Project_Gon.Api)' with route pattern 'api/Usuarios/activos' is valid for the request path '/api/usuarios/activos'
2026-01-29 14:54:51.248 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetById (Project_Gon.Api)' with route pattern 'api/Usuarios/{id}' is valid for the request path '/api/usuarios/activos'
2026-01-29 14:54:51.249 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetActivos (Project_Gon.Api)'
2026-01-29 14:54:51.250 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:54:51.250 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:54:51.250 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:54:51.251 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:54:51.252 -03:00 [DBG] Authorization was successful.
2026-01-29 14:54:51.252 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetActivos (Project_Gon.Api)'
2026-01-29 14:54:51.254 -03:00 [INF] Route matched with {action = "GetActivos", controller = "Usuarios"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Project_Gon.Core.DTOs.Usuario.UsuarioDto]]] GetActivos(Boolean) on controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api).
2026-01-29 14:54:51.256 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:54:51.256 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:54:51.257 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:54:51.258 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:54:51.259 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:54:51.260 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:54:51.261 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:54:51.299 -03:00 [DBG] Attempting to bind parameter 'activos' of type 'System.Boolean' ...
2026-01-29 14:54:51.300 -03:00 [DBG] Attempting to bind parameter 'activos' of type 'System.Boolean' using the name 'activos' in request data ...
2026-01-29 14:54:51.301 -03:00 [DBG] Done attempting to bind parameter 'activos' of type 'System.Boolean'.
2026-01-29 14:54:51.301 -03:00 [DBG] Done attempting to bind parameter 'activos' of type 'System.Boolean'.
2026-01-29 14:54:51.302 -03:00 [DBG] Attempting to validate the bound parameter 'activos' of type 'System.Boolean' ...
2026-01-29 14:54:51.303 -03:00 [DBG] Done attempting to validate the bound parameter 'activos' of type 'System.Boolean'.
2026-01-29 14:54:51.304 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:54:51.305 -03:00 [DBG] Compiling query expression: 
'DbSet<Usuario>()
    .AsNoTracking()
    .Include(u => u.Empresa)
    .Include(u => u.Sucursal)
    .Where(u => u.Activo == __activos_0)'
2026-01-29 14:54:51.307 -03:00 [DBG] Including navigation: 'Usuario.Empresa'.
2026-01-29 14:54:51.307 -03:00 [DBG] Including navigation: 'Usuario.Sucursal'.
2026-01-29 14:54:51.310 -03:00 [DBG] Generated query execution expression: 
'queryContext => SingleQueryingEnumerable.Create<Usuario>(
    relationalQueryContext: (RelationalQueryContext)queryContext, 
    relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
            1 -> Dictionary<IProperty, int> { [Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Empresa.Activo (bool) Required, 14], [Property: Empresa.Ciudad (string), 15], [Property: Empresa.CreatedAt (DateTime) Required, 16], [Property: Empresa.Direccion (string), 17], [Property: Empresa.Nombre (string) Required MaxLength(255), 18], [Property: Empresa.Region (string), 19], [Property: Empresa.Rut (string), 20], [Property: Empresa.UpdatedAt (DateTime?), 21] }
            2 -> Dictionary<IProperty, int> { [Property: Sucursal.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 22], [Property: Sucursal.Activo (bool) Required, 23], [Property: Sucursal.Ciudad (string), 24], [Property: Sucursal.CreatedAt (DateTime) Required, 25], [Property: Sucursal.Direccion (string), 26], [Property: Sucursal.EmpresaId (int) Required FK Index, 27], [Property: Sucursal.Nombre (string) Required MaxLength(255), 28], [Property: Sucursal.Region (string), 29], [Property: Sucursal.Telefono (string), 30], [Property: Sucursal.UpdatedAt (DateTime?), 31] }
        SELECT u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt, e.Id, e.Activo, e.Ciudad, e.CreatedAt, e.Direccion, e.Nombre, e.Region, e.Rut, e.UpdatedAt, s.Id, s.Activo, s.Ciudad, s.CreatedAt, s.Direccion, s.EmpresaId, s.Nombre, s.Region, s.Telefono, s.UpdatedAt
        FROM Usuarios AS u
        INNER JOIN Empresas AS e ON u.EmpresaId == e.Id
        LEFT JOIN Sucursales AS s ON u.SucursalId == s.Id
        WHERE u.Activo == @__activos_0) | Resolver: c => new RelationalCommandCache(
        c.Dependencies.MemoryCache, 
        c.RelationalDependencies.QuerySqlGeneratorFactory, 
        c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
        Client Projections:
            0 -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
            1 -> Dictionary<IProperty, int> { [Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 13], [Property: Empresa.Activo (bool) Required, 14], [Property: Empresa.Ciudad (string), 15], [Property: Empresa.CreatedAt (DateTime) Required, 16], [Property: Empresa.Direccion (string), 17], [Property: Empresa.Nombre (string) Required MaxLength(255), 18], [Property: Empresa.Region (string), 19], [Property: Empresa.Rut (string), 20], [Property: Empresa.UpdatedAt (DateTime?), 21] }
            2 -> Dictionary<IProperty, int> { [Property: Sucursal.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 22], [Property: Sucursal.Activo (bool) Required, 23], [Property: Sucursal.Ciudad (string), 24], [Property: Sucursal.CreatedAt (DateTime) Required, 25], [Property: Sucursal.Direccion (string), 26], [Property: Sucursal.EmpresaId (int) Required FK Index, 27], [Property: Sucursal.Nombre (string) Required MaxLength(255), 28], [Property: Sucursal.Region (string), 29], [Property: Sucursal.Telefono (string), 30], [Property: Sucursal.UpdatedAt (DateTime?), 31] }
        SELECT u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt, e.Id, e.Activo, e.Ciudad, e.CreatedAt, e.Direccion, e.Nombre, e.Region, e.Rut, e.UpdatedAt, s.Id, s.Activo, s.Ciudad, s.CreatedAt, s.Direccion, s.EmpresaId, s.Nombre, s.Region, s.Telefono, s.UpdatedAt
        FROM Usuarios AS u
        INNER JOIN Empresas AS e ON u.EmpresaId == e.Id
        LEFT JOIN Sucursales AS s ON u.SucursalId == s.Id
        WHERE u.Activo == @__activos_0, 
        False, 
        new HashSet<string>(
            new string[]{ }, 
            StringComparer.Ordinal
        )
    )].GetRelationalCommandTemplate(parameters), 
    readerColumns: null, 
    shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
    {
        Usuario entity;
        Empresa entity;
        Sucursal entity;
        entity = 
        {
            MaterializationContext materializationContext1;
            IEntityType entityType1;
            Usuario instance1;
            materializationContext1 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance1 = default(Usuario);
            (object)dataReader.GetInt32(0) != null ? 
            {
                ISnapshot shadowSnapshot1;
                shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType1 = [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")];
                instance1 = switch (entityType1)
                {
                    case [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]: 
                        {
                            return 
                            {
                                Usuario instance;
                                instance = new Usuario();
                                instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                instance.<Activo>k__BackingField = dataReader.GetBoolean(1);
                                instance.<Apellido>k__BackingField = dataReader.GetString(2);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(3);
                                instance.<Email>k__BackingField = dataReader.IsDBNull(4) ? default(string) : dataReader.GetString(4);
                                instance.<EmpresaId>k__BackingField = dataReader.GetInt32(5);
                                instance.<Nombre>k__BackingField = dataReader.GetString(6);
                                instance.<PasswordHash>k__BackingField = dataReader.GetString(7);
                                instance.<Rol>k__BackingField = Invoke(((EnumToNumberConverter<RolUsuario, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Usuario.Rol (RolUsuario) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindProperty("Rol")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(8));
                                instance.<Rut>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                instance.<SucursalId>k__BackingField = dataReader.IsDBNull(10) ? default(int?) : (int?)dataReader.GetInt32(10);
                                instance.<UltimoAcceso>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(11);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(12) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(12);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext1.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Usuario)
                }
                ;
                return instance1;
            } : 
            {
                object[] keyValues1;
                keyValues1 = new object[]{ (object)dataReader.GetInt32(0) };
                return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                    entityType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")], 
                    properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindPrimaryKey().Properties], 
                    keyValues: keyValues1);
            };
            return instance1;
        };
        entity = 
        {
            MaterializationContext materializationContext2;
            IEntityType entityType2;
            Empresa instance2;
            materializationContext2 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance2 = default(Empresa);
            (object)dataReader.GetInt32(13) != null ? 
            {
                ISnapshot shadowSnapshot2;
                shadowSnapshot2 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType2 = [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{5} => namelessParameter{5}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")];
                instance2 = switch (entityType2)
                {
                    case [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{6} => namelessParameter{6}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")]: 
                        {
                            return 
                            {
                                Empresa instance;
                                instance = new Empresa();
                                instance.<Id>k__BackingField = dataReader.GetInt32(13);
                                instance.<Activo>k__BackingField = dataReader.GetBoolean(14);
                                instance.<Ciudad>k__BackingField = dataReader.IsDBNull(15) ? default(string) : dataReader.GetString(15);
                                instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(16);
                                instance.<Direccion>k__BackingField = dataReader.IsDBNull(17) ? default(string) : dataReader.GetString(17);
                                instance.<Nombre>k__BackingField = dataReader.GetString(18);
                                instance.<Region>k__BackingField = dataReader.IsDBNull(19) ? default(string) : dataReader.GetString(19);
                                instance.<Rut>k__BackingField = dataReader.IsDBNull(20) ? default(string) : dataReader.GetString(20);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(21) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(21);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext2.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{7} => namelessParameter{7}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Empresa)
                }
                ;
                return instance2;
            } : 
            {
                object[] keyValues2;
                keyValues2 = new object[]{ (object)dataReader.GetInt32(13) };
                return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                    entityType: [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{8} => namelessParameter{8}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")], 
                    properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindPrimaryKey().Properties], 
                    keyValues: keyValues2);
            };
            return instance2;
        };
        entity = 
        {
            MaterializationContext materializationContext3;
            IEntityType entityType3;
            Sucursal instance3;
            materializationContext3 = new MaterializationContext(
                [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                queryContext.Context
            );
            instance3 = default(Sucursal);
            dataReader.IsDBNull(22) ? default(object) : (object)dataReader.GetInt32(22) != null ? 
            {
                ISnapshot shadowSnapshot3;
                shadowSnapshot3 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                entityType3 = [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{9} => namelessParameter{9}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")];
                instance3 = switch (entityType3)
                {
                    case [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{10} => namelessParameter{10}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")]: 
                        {
                            return 
                            {
                                Sucursal instance;
                                instance = new Sucursal();
                                instance.<Id>k__BackingField = dataReader.IsDBNull(22) ? default(int) : dataReader.GetInt32(22);
                                instance.<Activo>k__BackingField = dataReader.IsDBNull(23) ? default(bool) : dataReader.GetBoolean(23);
                                instance.<Ciudad>k__BackingField = dataReader.IsDBNull(24) ? default(string) : dataReader.GetString(24);
                                instance.<CreatedAt>k__BackingField = dataReader.IsDBNull(25) ? default(DateTime) : dataReader.GetDateTime(25);
                                instance.<Direccion>k__BackingField = dataReader.IsDBNull(26) ? default(string) : dataReader.GetString(26);
                                instance.<EmpresaId>k__BackingField = dataReader.IsDBNull(27) ? default(int) : dataReader.GetInt32(27);
                                instance.<Nombre>k__BackingField = dataReader.IsDBNull(28) ? default(string) : dataReader.GetString(28);
                                instance.<Region>k__BackingField = dataReader.IsDBNull(29) ? default(string) : dataReader.GetString(29);
                                instance.<Telefono>k__BackingField = dataReader.IsDBNull(30) ? default(string) : dataReader.GetString(30);
                                instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(31) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(31);
                                (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                    context: materializationContext3.Context, 
                                    entity: instance, 
                                    queryTrackingBehavior: NoTracking, 
                                    structuralType: [LIFTABLE Constant: EntityType: Sucursal | Resolver: namelessParameter{11} => namelessParameter{11}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal")]) : default(void);
                                return instance;
                            }}
                    default: 
                        default(Sucursal)
                }
                ;
                return instance3;
            } : default(void);
            return instance3;
        };
        ShaperProcessingExpressionVisitor.IncludeReference<Usuario, Usuario, Empresa>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: Usuario.Empresa (Empresa) ToPrincipal Empresa Inverse: Usuarios | Resolver: namelessParameter{12} => namelessParameter{12}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindNavigation("Empresa")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Empresa.Usuarios (ICollection<Usuario>) Collection ToDependent Usuario Inverse: Empresa | Resolver: namelessParameter{13} => namelessParameter{13}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindNavigation("Usuarios")], 
            fixup: (namelessParameter{14}, namelessParameter{15}) => 
            {
                namelessParameter{14}.<Empresa>k__BackingField = namelessParameter{15};
                return [LIFTABLE Constant: ClrICollectionAccessor<Empresa, ICollection<Usuario>, Usuario> | Resolver: namelessParameter{16} => namelessParameter{16}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindNavigation("Usuarios").GetCollectionAccessor()].Add(
                    entity: namelessParameter{15}, 
                    value: namelessParameter{14}, 
                    forMaterialization: True);
            }, 
            trackingQuery: False);
        ShaperProcessingExpressionVisitor.IncludeReference<Usuario, Usuario, Sucursal>(
            queryContext: queryContext, 
            entity: entity, 
            relatedEntity: entity, 
            navigation: [LIFTABLE Constant: Navigation: Usuario.Sucursal (Sucursal) ToPrincipal Sucursal Inverse: Usuarios | Resolver: namelessParameter{17} => namelessParameter{17}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindNavigation("Sucursal")], 
            inverseNavigation: [LIFTABLE Constant: Navigation: Sucursal.Usuarios (ICollection<Usuario>) Collection ToDependent Usuario Inverse: Sucursal | Resolver: namelessParameter{18} => namelessParameter{18}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal").FindNavigation("Usuarios")], 
            fixup: (namelessParameter{19}, namelessParameter{20}) => 
            {
                namelessParameter{19}.<Sucursal>k__BackingField = namelessParameter{20};
                return [LIFTABLE Constant: ClrICollectionAccessor<Sucursal, ICollection<Usuario>, Usuario> | Resolver: namelessParameter{21} => namelessParameter{21}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Sucursal").FindNavigation("Usuarios").GetCollectionAccessor()].Add(
                    entity: namelessParameter{20}, 
                    value: namelessParameter{19}, 
                    forMaterialization: True);
            }, 
            trackingQuery: False);
        return entity;
    }, 
    contextType: Project_Gon.Infrastructure.Data.AppDbContext, 
    standAloneStateManager: False, 
    detailedErrorsEnabled: False, 
    threadSafetyChecksEnabled: True)'
2026-01-29 14:54:51.327 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:54:51.327 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 14:54:51.328 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:54:51.328 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:54:51.329 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:54:51.330 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:54:51.330 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:54:51.331 -03:00 [DBG] Executing DbCommand [Parameters=[@__activos_0='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
WHERE u."Activo" = @__activos_0
2026-01-29 14:54:51.333 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__activos_0='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
WHERE u."Activo" = @__activos_0
2026-01-29 14:54:51.335 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:54:51.335 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 14:54:51.336 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:54:51.337 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:54:51.338 -03:00 [INF] Retrieved 1 usuarios activos
2026-01-29 14:54:51.338 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:54:51.340 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:54:51.340 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 14:54:51.341 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 14:54:51.341 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 14:54:51.342 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Project_Gon.Core.DTOs.Usuario.UsuarioDto, Project_Gon.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-29 14:54:51.343 -03:00 [INF] Executed action Project_Gon.Api.Controllers.UsuariosController.GetActivos (Project_Gon.Api) in 82.7631ms
2026-01-29 14:54:51.343 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetActivos (Project_Gon.Api)'
2026-01-29 14:54:51.344 -03:00 [INF] HTTP GET /api/usuarios/activos responded 200 in 93.7184 ms
2026-01-29 14:54:51.344 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:54:51.345 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:54:51.346 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:54:51.346 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7058/api/usuarios/activos?activos=true - 200 null application/json; charset=utf-8 100.8624ms
2026-01-29 14:54:51.348 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:0000000D": started reading request body.
2026-01-29 14:54:51.349 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:0000000D": done reading request body.
2026-01-29 14:55:12.218 -03:00 [INF] Request starting HTTP/2 GET https://localhost:7058/api/usuarios/activos?activos=false - application/json 69
2026-01-29 14:55:12.219 -03:00 [DBG] 2 candidate(s) found for the request path '/api/usuarios/activos'
2026-01-29 14:55:12.220 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetActivos (Project_Gon.Api)' with route pattern 'api/Usuarios/activos' is valid for the request path '/api/usuarios/activos'
2026-01-29 14:55:12.221 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetById (Project_Gon.Api)' with route pattern 'api/Usuarios/{id}' is valid for the request path '/api/usuarios/activos'
2026-01-29 14:55:12.222 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetActivos (Project_Gon.Api)'
2026-01-29 14:55:12.222 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:55:12.223 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:55:12.223 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:55:12.224 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:55:12.224 -03:00 [DBG] Authorization was successful.
2026-01-29 14:55:12.224 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetActivos (Project_Gon.Api)'
2026-01-29 14:55:12.225 -03:00 [INF] Route matched with {action = "GetActivos", controller = "Usuarios"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.IEnumerable`1[Project_Gon.Core.DTOs.Usuario.UsuarioDto]]] GetActivos(Boolean) on controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api).
2026-01-29 14:55:12.226 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 14:55:12.227 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 14:55:12.228 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 14:55:12.229 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 14:55:12.230 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 14:55:12.231 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:55:12.232 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.UsuariosController (Project_Gon.Api)
2026-01-29 14:55:12.233 -03:00 [DBG] Attempting to bind parameter 'activos' of type 'System.Boolean' ...
2026-01-29 14:55:12.233 -03:00 [DBG] Attempting to bind parameter 'activos' of type 'System.Boolean' using the name 'activos' in request data ...
2026-01-29 14:55:12.234 -03:00 [DBG] Done attempting to bind parameter 'activos' of type 'System.Boolean'.
2026-01-29 14:55:12.235 -03:00 [DBG] Done attempting to bind parameter 'activos' of type 'System.Boolean'.
2026-01-29 14:55:12.235 -03:00 [DBG] Attempting to validate the bound parameter 'activos' of type 'System.Boolean' ...
2026-01-29 14:55:12.236 -03:00 [DBG] Done attempting to validate the bound parameter 'activos' of type 'System.Boolean'.
2026-01-29 14:55:12.237 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 14:55:12.238 -03:00 [DBG] Creating DbConnection.
2026-01-29 14:55:12.239 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 14:55:12.239 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:55:12.240 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:55:12.240 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 14:55:12.241 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 14:55:12.241 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 14:55:12.242 -03:00 [DBG] Executing DbCommand [Parameters=[@__activos_0='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
WHERE u."Activo" = @__activos_0
2026-01-29 14:55:12.244 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__activos_0='?' (DbType = Boolean)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt", e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt", s."Id", s."Activo", s."Ciudad", s."CreatedAt", s."Direccion", s."EmpresaId", s."Nombre", s."Region", s."Telefono", s."UpdatedAt"
FROM "Usuarios" AS u
INNER JOIN "Empresas" AS e ON u."EmpresaId" = e."Id"
LEFT JOIN "Sucursales" AS s ON u."SucursalId" = s."Id"
WHERE u."Activo" = @__activos_0
2026-01-29 14:55:12.246 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:55:12.246 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 14:55:12.247 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:55:12.248 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:55:12.248 -03:00 [INF] Retrieved 0 usuarios inactivos
2026-01-29 14:55:12.249 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 14:55:12.250 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 14:55:12.251 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 14:55:12.251 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 14:55:12.252 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 14:55:12.252 -03:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[Project_Gon.Core.DTOs.Usuario.UsuarioDto, Project_Gon.Core, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-29 14:55:12.253 -03:00 [INF] Executed action Project_Gon.Api.Controllers.UsuariosController.GetActivos (Project_Gon.Api) in 22.4576ms
2026-01-29 14:55:12.254 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.UsuariosController.GetActivos (Project_Gon.Api)'
2026-01-29 14:55:12.254 -03:00 [INF] HTTP GET /api/usuarios/activos responded 200 in 31.8505 ms
2026-01-29 14:55:12.255 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 14:55:12.256 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 14:55:12.256 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 14:55:12.257 -03:00 [INF] Request finished HTTP/2 GET https://localhost:7058/api/usuarios/activos?activos=false - 200 null application/json; charset=utf-8 39.2958ms
2026-01-29 14:55:12.259 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:0000000F": started reading request body.
2026-01-29 14:55:12.260 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:0000000F": done reading request body.
2026-01-29 14:56:32.222 -03:00 [INF] Request starting HTTP/2 POST https://localhost:7058/api/usuarios - application/json 174
2026-01-29 14:56:32.223 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios'
2026-01-29 14:56:32.224 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.Create (Project_Gon.Api)' with route pattern 'api/Usuarios' is valid for the request path '/api/usuarios'
2026-01-29 14:56:32.225 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.Create (Project_Gon.Api)'
2026-01-29 14:56:32.225 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:56:32.226 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:56:32.226 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:56:32.227 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:56:32.228 -03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (AdminGlobal|AdminEmpresa)
2026-01-29 14:56:32.230 -03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2026-01-29 14:56:32.230 -03:00 [INF] HTTP POST /api/usuarios responded 403 in 4.3358 ms
2026-01-29 14:56:32.231 -03:00 [INF] Request finished HTTP/2 POST https://localhost:7058/api/usuarios - 403 0 null 8.738ms
2026-01-29 14:56:32.232 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:00000011": started reading request body.
2026-01-29 14:56:32.233 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:00000011": done reading request body.
2026-01-29 14:57:04.772 -03:00 [INF] Request starting HTTP/2 PUT https://localhost:7058/api/usuarios - application/json 73
2026-01-29 14:57:04.773 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios'
2026-01-29 14:57:04.774 -03:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2026-01-29 14:57:04.774 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:57:04.775 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:57:04.775 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:57:04.776 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:57:04.776 -03:00 [INF] Executing endpoint '405 HTTP Method Not Supported'
2026-01-29 14:57:04.777 -03:00 [INF] Executed endpoint '405 HTTP Method Not Supported'
2026-01-29 14:57:04.777 -03:00 [INF] HTTP PUT /api/usuarios responded 405 in 2.6539 ms
2026-01-29 14:57:04.778 -03:00 [INF] Request finished HTTP/2 PUT https://localhost:7058/api/usuarios - 405 0 null 6.2171ms
2026-01-29 14:57:04.779 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:00000013": started reading request body.
2026-01-29 14:57:04.780 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:00000013": done reading request body.
2026-01-29 14:57:19.640 -03:00 [INF] Request starting HTTP/2 PUT https://localhost:7058/api/usuarios/3 - application/json 73
2026-01-29 14:57:19.641 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios/3'
2026-01-29 14:57:19.642 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.Update (Project_Gon.Api)' with route pattern 'api/Usuarios/{id}' is valid for the request path '/api/usuarios/3'
2026-01-29 14:57:19.642 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.Update (Project_Gon.Api)'
2026-01-29 14:57:19.643 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:57:19.644 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:57:19.644 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:57:19.644 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:57:19.645 -03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (AdminGlobal|AdminEmpresa)
2026-01-29 14:57:19.646 -03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2026-01-29 14:57:19.646 -03:00 [INF] HTTP PUT /api/usuarios/3 responded 403 in 2.8189 ms
2026-01-29 14:57:19.647 -03:00 [INF] Request finished HTTP/2 PUT https://localhost:7058/api/usuarios/3 - 403 0 null 6.9841ms
2026-01-29 14:57:19.648 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:00000015": started reading request body.
2026-01-29 14:57:19.649 -03:00 [DBG] Connection id "0HNIVBRS5KAG3", Request id "0HNIVBRS5KAG3:00000015": done reading request body.
2026-01-29 14:58:18.432 -03:00 [INF] Request starting HTTP/2 DELETE https://localhost:7058/api/usuarios/3 - application/json 0
2026-01-29 14:58:18.433 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios/3'
2026-01-29 14:58:18.434 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.Delete (Project_Gon.Api)' with route pattern 'api/Usuarios/{id}' is valid for the request path '/api/usuarios/3'
2026-01-29 14:58:18.435 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.Delete (Project_Gon.Api)'
2026-01-29 14:58:18.435 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:58:18.436 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:58:18.436 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:58:18.437 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:58:18.437 -03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (AdminGlobal|AdminEmpresa)
2026-01-29 14:58:18.438 -03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2026-01-29 14:58:18.438 -03:00 [INF] HTTP DELETE /api/usuarios/3 responded 403 in 2.5754 ms
2026-01-29 14:58:18.439 -03:00 [INF] Request finished HTTP/2 DELETE https://localhost:7058/api/usuarios/3 - 403 0 null 7.017ms
2026-01-29 14:58:43.685 -03:00 [INF] Request starting HTTP/2 PATCH https://localhost:7058/api/usuarios/3/activar?activo=false - application/json 0
2026-01-29 14:58:43.687 -03:00 [DBG] 1 candidate(s) found for the request path '/api/usuarios/3/activar'
2026-01-29 14:58:43.687 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.UsuariosController.ToggleActivo (Project_Gon.Api)' with route pattern 'api/Usuarios/{id}/activar' is valid for the request path '/api/usuarios/3/activar'
2026-01-29 14:58:43.688 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.UsuariosController.ToggleActivo (Project_Gon.Api)'
2026-01-29 14:58:43.689 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 14:58:43.689 -03:00 [DBG] Successfully validated the token.
2026-01-29 14:58:43.690 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 14:58:43.690 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 14:58:43.691 -03:00 [INF] Authorization failed. These requirements were not met:
RolesAuthorizationRequirement:User.IsInRole must be true for one of the following roles: (AdminGlobal|AdminEmpresa)
2026-01-29 14:58:43.692 -03:00 [INF] AuthenticationScheme: Bearer was forbidden.
2026-01-29 14:58:43.692 -03:00 [INF] HTTP PATCH /api/usuarios/3/activar responded 403 in 2.8979 ms
2026-01-29 14:58:43.693 -03:00 [INF] Request finished HTTP/2 PATCH https://localhost:7058/api/usuarios/3/activar?activo=false - 403 0 null 7.8482ms
2026-01-29 15:00:54.952 -03:00 [DBG] Connection id "0HNIVBRS5KAG3" is closing.
2026-01-29 15:00:54.952 -03:00 [DBG] Connection id "0HNIVBRS5KAG3" is closed. The last processed stream ID was 25.
2026-01-29 15:00:54.955 -03:00 [DBG] The connection queue processing loop for 0HNIVBRS5KAG3 completed.
2026-01-29 15:00:54.957 -03:00 [DBG] Connection id "0HNIVBRS5KAG3" stopped.
2026-01-29 15:00:54.957 -03:00 [DBG] Connection id "0HNIVBRS5KAG3" sending FIN because: "The Socket transport's send loop completed gracefully."
2026-01-29 15:01:41.255 -03:00 [DBG] Connection id "0HNIVBRS5KAG4" accepted.
2026-01-29 15:01:41.256 -03:00 [DBG] Connection id "0HNIVBRS5KAG4" started.
2026-01-29 15:01:41.265 -03:00 [DBG] Connection 0HNIVBRS5KAG4 established using the following protocol: "Tls12"
2026-01-29 15:01:41.267 -03:00 [INF] Request starting HTTP/2 POST https://localhost:7058/api/auth/register - application/json 167
2026-01-29 15:01:41.269 -03:00 [DBG] 1 candidate(s) found for the request path '/api/auth/register'
2026-01-29 15:01:41.270 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.AuthController.Register (Project_Gon.Api)' with route pattern 'api/Auth/register' is valid for the request path '/api/auth/register'
2026-01-29 15:01:41.271 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.AuthController.Register (Project_Gon.Api)'
2026-01-29 15:01:41.274 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 15:01:41.275 -03:00 [DBG] Successfully validated the token.
2026-01-29 15:01:41.275 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 15:01:41.276 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 15:01:41.277 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.AuthController.Register (Project_Gon.Api)'
2026-01-29 15:01:41.280 -03:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(Project_Gon.Core.DTOs.Auth.RegisterDto) on controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api).
2026-01-29 15:01:41.282 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 15:01:41.283 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 15:01:41.283 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 15:01:41.284 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 15:01:41.285 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 15:01:41.286 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api)
2026-01-29 15:01:41.287 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api)
2026-01-29 15:01:41.288 -03:00 [DBG] Attempting to bind parameter 'registerDto' of type 'Project_Gon.Core.DTOs.Auth.RegisterDto' ...
2026-01-29 15:01:41.289 -03:00 [DBG] Attempting to bind parameter 'registerDto' of type 'Project_Gon.Core.DTOs.Auth.RegisterDto' using the name '' in request data ...
2026-01-29 15:01:41.290 -03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2026-01-29 15:01:41.296 -03:00 [DBG] Connection id "0HNIVBRS5KAG4", Request id "0HNIVBRS5KAG4:00000001": started reading request body.
2026-01-29 15:01:41.296 -03:00 [DBG] Connection id "0HNIVBRS5KAG4", Request id "0HNIVBRS5KAG4:00000001": done reading request body.
2026-01-29 15:01:41.302 -03:00 [DBG] JSON input formatter succeeded, deserializing to type 'Project_Gon.Core.DTOs.Auth.RegisterDto'
2026-01-29 15:01:41.302 -03:00 [DBG] Done attempting to bind parameter 'registerDto' of type 'Project_Gon.Core.DTOs.Auth.RegisterDto'.
2026-01-29 15:01:41.303 -03:00 [DBG] Done attempting to bind parameter 'registerDto' of type 'Project_Gon.Core.DTOs.Auth.RegisterDto'.
2026-01-29 15:01:41.304 -03:00 [DBG] Attempting to validate the bound parameter 'registerDto' of type 'Project_Gon.Core.DTOs.Auth.RegisterDto' ...
2026-01-29 15:01:41.334 -03:00 [DBG] Done attempting to validate the bound parameter 'registerDto' of type 'Project_Gon.Core.DTOs.Auth.RegisterDto'.
2026-01-29 15:01:41.335 -03:00 [DBG] The request has model state errors, returning an error response.
2026-01-29 15:01:41.336 -03:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2026-01-29 15:01:41.337 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 15:01:41.338 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 15:01:41.339 -03:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2026-01-29 15:01:41.340 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2026-01-29 15:01:41.340 -03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2026-01-29 15:01:41.348 -03:00 [INF] Executed action Project_Gon.Api.Controllers.AuthController.Register (Project_Gon.Api) in 61.5368ms
2026-01-29 15:01:41.348 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.AuthController.Register (Project_Gon.Api)'
2026-01-29 15:01:41.349 -03:00 [INF] HTTP POST /api/auth/register responded 400 in 74.0838 ms
2026-01-29 15:01:41.350 -03:00 [INF] Request finished HTTP/2 POST https://localhost:7058/api/auth/register - 400 null application/problem+json; charset=utf-8 82.1151ms
2026-01-29 15:02:19.893 -03:00 [INF] Request starting HTTP/2 POST https://localhost:7058/api/auth/register - application/json 191
2026-01-29 15:02:19.895 -03:00 [DBG] 1 candidate(s) found for the request path '/api/auth/register'
2026-01-29 15:02:19.896 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.AuthController.Register (Project_Gon.Api)' with route pattern 'api/Auth/register' is valid for the request path '/api/auth/register'
2026-01-29 15:02:19.896 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.AuthController.Register (Project_Gon.Api)'
2026-01-29 15:02:19.897 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 15:02:19.898 -03:00 [DBG] Successfully validated the token.
2026-01-29 15:02:19.898 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 15:02:19.898 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 15:02:19.899 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.AuthController.Register (Project_Gon.Api)'
2026-01-29 15:02:19.900 -03:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(Project_Gon.Core.DTOs.Auth.RegisterDto) on controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api).
2026-01-29 15:02:19.901 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 15:02:19.901 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 15:02:19.902 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 15:02:19.903 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 15:02:19.904 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 15:02:19.905 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api)
2026-01-29 15:02:19.905 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api)
2026-01-29 15:02:19.906 -03:00 [DBG] Attempting to bind parameter 'registerDto' of type 'Project_Gon.Core.DTOs.Auth.RegisterDto' ...
2026-01-29 15:02:19.907 -03:00 [DBG] Attempting to bind parameter 'registerDto' of type 'Project_Gon.Core.DTOs.Auth.RegisterDto' using the name '' in request data ...
2026-01-29 15:02:19.907 -03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2026-01-29 15:02:19.908 -03:00 [DBG] Connection id "0HNIVBRS5KAG4", Request id "0HNIVBRS5KAG4:00000003": started reading request body.
2026-01-29 15:02:19.909 -03:00 [DBG] Connection id "0HNIVBRS5KAG4", Request id "0HNIVBRS5KAG4:00000003": done reading request body.
2026-01-29 15:02:19.910 -03:00 [DBG] JSON input formatter succeeded, deserializing to type 'Project_Gon.Core.DTOs.Auth.RegisterDto'
2026-01-29 15:02:19.910 -03:00 [DBG] Done attempting to bind parameter 'registerDto' of type 'Project_Gon.Core.DTOs.Auth.RegisterDto'.
2026-01-29 15:02:19.911 -03:00 [DBG] Done attempting to bind parameter 'registerDto' of type 'Project_Gon.Core.DTOs.Auth.RegisterDto'.
2026-01-29 15:02:19.911 -03:00 [DBG] Attempting to validate the bound parameter 'registerDto' of type 'Project_Gon.Core.DTOs.Auth.RegisterDto' ...
2026-01-29 15:02:19.913 -03:00 [DBG] Done attempting to validate the bound parameter 'registerDto' of type 'Project_Gon.Core.DTOs.Auth.RegisterDto'.
2026-01-29 15:02:19.914 -03:00 [DBG] The request has model state errors, returning an error response.
2026-01-29 15:02:19.914 -03:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2026-01-29 15:02:19.915 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 15:02:19.916 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 15:02:19.917 -03:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2026-01-29 15:02:19.918 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2026-01-29 15:02:19.919 -03:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2026-01-29 15:02:19.919 -03:00 [INF] Executed action Project_Gon.Api.Controllers.AuthController.Register (Project_Gon.Api) in 14.7236ms
2026-01-29 15:02:19.920 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.AuthController.Register (Project_Gon.Api)'
2026-01-29 15:02:19.921 -03:00 [INF] HTTP POST /api/auth/register responded 400 in 23.2073 ms
2026-01-29 15:02:19.921 -03:00 [INF] Request finished HTTP/2 POST https://localhost:7058/api/auth/register - 400 null application/problem+json; charset=utf-8 28.3175ms
2026-01-29 15:02:29.176 -03:00 [INF] Request starting HTTP/2 POST https://localhost:7058/api/auth/register - application/json 190
2026-01-29 15:02:29.178 -03:00 [DBG] 1 candidate(s) found for the request path '/api/auth/register'
2026-01-29 15:02:29.178 -03:00 [DBG] Endpoint 'Project_Gon.Api.Controllers.AuthController.Register (Project_Gon.Api)' with route pattern 'api/Auth/register' is valid for the request path '/api/auth/register'
2026-01-29 15:02:29.179 -03:00 [DBG] Request matched endpoint 'Project_Gon.Api.Controllers.AuthController.Register (Project_Gon.Api)'
2026-01-29 15:02:29.180 -03:00 [DBG] Static files was skipped as the request already matched an endpoint.
2026-01-29 15:02:29.180 -03:00 [DBG] Successfully validated the token.
2026-01-29 15:02:29.180 -03:00 [INF] JWT Token validated for user: Unknown, empresa: 3
2026-01-29 15:02:29.181 -03:00 [DBG] AuthenticationScheme: Bearer was successfully authenticated.
2026-01-29 15:02:29.182 -03:00 [INF] Executing endpoint 'Project_Gon.Api.Controllers.AuthController.Register (Project_Gon.Api)'
2026-01-29 15:02:29.182 -03:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(Project_Gon.Core.DTOs.Auth.RegisterDto) on controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api).
2026-01-29 15:02:29.183 -03:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2026-01-29 15:02:29.184 -03:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2026-01-29 15:02:29.184 -03:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2026-01-29 15:02:29.251 -03:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2026-01-29 15:02:29.252 -03:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2026-01-29 15:02:29.253 -03:00 [DBG] Executing controller factory for controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api)
2026-01-29 15:02:29.253 -03:00 [DBG] Executed controller factory for controller Project_Gon.Api.Controllers.AuthController (Project_Gon.Api)
2026-01-29 15:02:29.254 -03:00 [DBG] Attempting to bind parameter 'registerDto' of type 'Project_Gon.Core.DTOs.Auth.RegisterDto' ...
2026-01-29 15:02:29.255 -03:00 [DBG] Attempting to bind parameter 'registerDto' of type 'Project_Gon.Core.DTOs.Auth.RegisterDto' using the name '' in request data ...
2026-01-29 15:02:29.255 -03:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2026-01-29 15:02:29.256 -03:00 [DBG] Connection id "0HNIVBRS5KAG4", Request id "0HNIVBRS5KAG4:00000005": started reading request body.
2026-01-29 15:02:29.257 -03:00 [DBG] Connection id "0HNIVBRS5KAG4", Request id "0HNIVBRS5KAG4:00000005": done reading request body.
2026-01-29 15:02:29.257 -03:00 [DBG] JSON input formatter succeeded, deserializing to type 'Project_Gon.Core.DTOs.Auth.RegisterDto'
2026-01-29 15:02:29.258 -03:00 [DBG] Done attempting to bind parameter 'registerDto' of type 'Project_Gon.Core.DTOs.Auth.RegisterDto'.
2026-01-29 15:02:29.258 -03:00 [DBG] Done attempting to bind parameter 'registerDto' of type 'Project_Gon.Core.DTOs.Auth.RegisterDto'.
2026-01-29 15:02:29.259 -03:00 [DBG] Attempting to validate the bound parameter 'registerDto' of type 'Project_Gon.Core.DTOs.Auth.RegisterDto' ...
2026-01-29 15:02:29.260 -03:00 [DBG] Done attempting to validate the bound parameter 'registerDto' of type 'Project_Gon.Core.DTOs.Auth.RegisterDto'.
2026-01-29 15:02:29.264 -03:00 [DBG] [CLEAN_RUT] Original: 11111111-1 -> Limpio: 11111111-1
2026-01-29 15:02:29.264 -03:00 [INF] [REGISTER] RUT limpio guardado: 11111111-1
2026-01-29 15:02:29.265 -03:00 [DBG] Entity Framework Core 9.0.0 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:9.0.2+697dd7182173ff3450eddc63b44837fba76331df' with options: None
2026-01-29 15:02:29.271 -03:00 [DBG] Compiling query expression: 
'DbSet<Empresa>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2026-01-29 15:02:29.277 -03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Empresa>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Empresa>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Empresa.Activo (bool) Required, 1], [Property: Empresa.Ciudad (string), 2], [Property: Empresa.CreatedAt (DateTime) Required, 3], [Property: Empresa.Direccion (string), 4], [Property: Empresa.Nombre (string) Required MaxLength(255), 5], [Property: Empresa.Region (string), 6], [Property: Empresa.Rut (string), 7], [Property: Empresa.UpdatedAt (DateTime?), 8] }
            SELECT TOP(1) e.Id, e.Activo, e.Ciudad, e.CreatedAt, e.Direccion, e.Nombre, e.Region, e.Rut, e.UpdatedAt
            FROM Empresas AS e
            WHERE e.Id == @__p_0) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Empresa.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Empresa.Activo (bool) Required, 1], [Property: Empresa.Ciudad (string), 2], [Property: Empresa.CreatedAt (DateTime) Required, 3], [Property: Empresa.Direccion (string), 4], [Property: Empresa.Nombre (string) Required MaxLength(255), 5], [Property: Empresa.Region (string), 6], [Property: Empresa.Rut (string), 7], [Property: Empresa.UpdatedAt (DateTime?), 8] }
            SELECT TOP(1) e.Id, e.Activo, e.Ciudad, e.CreatedAt, e.Direccion, e.Nombre, e.Region, e.Rut, e.UpdatedAt
            FROM Empresas AS e
            WHERE e.Id == @__p_0, 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Empresa entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Empresa instance1;
                InternalEntityEntry entry1;
                bool hasNullKey1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Empresa);
                entry1 = queryContext.TryGetEntry(
                    key: [LIFTABLE Constant: Key: Empresa.Id PK | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa").FindPrimaryKey()], 
                    keyValues: new object[]{ (object)dataReader.GetInt32(0) }, 
                    throwOnNullKey: True, 
                    hasNullKey: hasNullKey1);
                !(hasNullKey1) ? entry1 != default(InternalEntityEntry) ? 
                {
                    entityType1 = entry1.EntityType;
                    return instance1 = (Empresa)entry1.Entity;
                } : 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")]: 
                            {
                                return 
                                {
                                    Empresa instance;
                                    instance = new Empresa();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Activo>k__BackingField = dataReader.GetBoolean(1);
                                    instance.<Ciudad>k__BackingField = dataReader.IsDBNull(2) ? default(string) : dataReader.GetString(2);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(3);
                                    instance.<Direccion>k__BackingField = dataReader.IsDBNull(4) ? default(string) : dataReader.GetString(4);
                                    instance.<Nombre>k__BackingField = dataReader.GetString(5);
                                    instance.<Region>k__BackingField = dataReader.IsDBNull(6) ? default(string) : dataReader.GetString(6);
                                    instance.<Rut>k__BackingField = dataReader.IsDBNull(7) ? default(string) : dataReader.GetString(7);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(8) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(8);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: TrackAll, 
                                        structuralType: [LIFTABLE Constant: EntityType: Empresa | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Empresa")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Empresa)
                    }
                    ;
                    entry1 = entityType1 == default(IEntityType) ? default(InternalEntityEntry) : queryContext.StartTracking(
                        entityType: entityType1, 
                        entity: instance1, 
                        snapshot: shadowSnapshot1);
                    return instance1;
                } : default(void);
                return instance1;
            };
            return entity;
        }, 
        contextType: Project_Gon.Infrastructure.Data.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2026-01-29 15:02:29.285 -03:00 [DBG] Creating DbConnection.
2026-01-29 15:02:29.285 -03:00 [DBG] Created DbConnection. (0ms).
2026-01-29 15:02:29.285 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 15:02:29.433 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 15:02:29.434 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 15:02:29.434 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 15:02:29.435 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 15:02:29.436 -03:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt"
FROM "Empresas" AS e
WHERE e."Id" = @__p_0
LIMIT 1
2026-01-29 15:02:29.438 -03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT e."Id", e."Activo", e."Ciudad", e."CreatedAt", e."Direccion", e."Nombre", e."Region", e."Rut", e."UpdatedAt"
FROM "Empresas" AS e
WHERE e."Id" = @__p_0
LIMIT 1
2026-01-29 15:02:29.460 -03:00 [DBG] Context 'AppDbContext' started tracking 'Empresa' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2026-01-29 15:02:29.476 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 15:02:29.477 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 37ms reading results.
2026-01-29 15:02:29.477 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 15:02:29.478 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 15:02:29.480 -03:00 [DBG] Compiling query expression: 
'DbSet<Usuario>()
    .Where(u => u.Rut == __rutLimpio_0 && u.EmpresaId == __8__locals1_registerDto_EmpresaId_1)
    .AsNoTracking()
    .FirstOrDefault()'
2026-01-29 15:02:29.483 -03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Usuario>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Usuario>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
            SELECT TOP(1) u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt
            FROM Usuarios AS u
            WHERE (u.Rut == @__rutLimpio_0) && (u.EmpresaId == @__8__locals1_registerDto_EmpresaId_1)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
            SELECT TOP(1) u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt
            FROM Usuarios AS u
            WHERE (u.Rut == @__rutLimpio_0) && (u.EmpresaId == @__8__locals1_registerDto_EmpresaId_1), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Usuario entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Usuario instance1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Usuario);
                (object)dataReader.GetInt32(0) != null ? 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]: 
                            {
                                return 
                                {
                                    Usuario instance;
                                    instance = new Usuario();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Activo>k__BackingField = dataReader.GetBoolean(1);
                                    instance.<Apellido>k__BackingField = dataReader.GetString(2);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(3);
                                    instance.<Email>k__BackingField = dataReader.IsDBNull(4) ? default(string) : dataReader.GetString(4);
                                    instance.<EmpresaId>k__BackingField = dataReader.GetInt32(5);
                                    instance.<Nombre>k__BackingField = dataReader.GetString(6);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(7);
                                    instance.<Rol>k__BackingField = Invoke(((EnumToNumberConverter<RolUsuario, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Usuario.Rol (RolUsuario) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindProperty("Rol")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(8));
                                    instance.<Rut>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                    instance.<SucursalId>k__BackingField = dataReader.IsDBNull(10) ? default(int?) : (int?)dataReader.GetInt32(10);
                                    instance.<UltimoAcceso>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(11);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(12) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: NoTracking, 
                                        structuralType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Usuario)
                    }
                    ;
                    return instance1;
                } : 
                {
                    object[] keyValues1;
                    keyValues1 = new object[]{ (object)dataReader.GetInt32(0) };
                    return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                        entityType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")], 
                        properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindPrimaryKey().Properties], 
                        keyValues: keyValues1);
                };
                return instance1;
            };
            return entity;
        }, 
        contextType: Project_Gon.Infrastructure.Data.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2026-01-29 15:02:29.491 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 15:02:29.491 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 15:02:29.492 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 15:02:29.492 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 15:02:29.493 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 15:02:29.494 -03:00 [DBG] Executing DbCommand [Parameters=[@__rutLimpio_0='?', @__8__locals1_registerDto_EmpresaId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt"
FROM "Usuarios" AS u
WHERE u."Rut" = @__rutLimpio_0 AND u."EmpresaId" = @__8__locals1_registerDto_EmpresaId_1
LIMIT 1
2026-01-29 15:02:29.498 -03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__rutLimpio_0='?', @__8__locals1_registerDto_EmpresaId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt"
FROM "Usuarios" AS u
WHERE u."Rut" = @__rutLimpio_0 AND u."EmpresaId" = @__8__locals1_registerDto_EmpresaId_1
LIMIT 1
2026-01-29 15:02:29.500 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 15:02:29.500 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 15:02:29.501 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 15:02:29.501 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 15:02:29.502 -03:00 [DBG] Compiling query expression: 
'DbSet<Usuario>()
    .Where(u => u.Email == __8__locals1_registerDto_Email_0 && u.EmpresaId == __8__locals1_registerDto_EmpresaId_1)
    .AsNoTracking()
    .FirstOrDefault()'
2026-01-29 15:02:29.505 -03:00 [DBG] Generated query execution expression: 
'queryContext => ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync<Usuario>(
    asyncEnumerable: SingleQueryingEnumerable.Create<Usuario>(
        relationalQueryContext: (RelationalQueryContext)queryContext, 
        relationalCommandResolver: parameters => [LIFTABLE Constant: RelationalCommandCache.QueryExpression(
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
            SELECT TOP(1) u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt
            FROM Usuarios AS u
            WHERE (u.Email == @__8__locals1_registerDto_Email_0) && (u.EmpresaId == @__8__locals1_registerDto_EmpresaId_1)) | Resolver: c => new RelationalCommandCache(
            c.Dependencies.MemoryCache, 
            c.RelationalDependencies.QuerySqlGeneratorFactory, 
            c.RelationalDependencies.RelationalParameterBasedSqlProcessorFactory, 
            Projection Mapping:
                EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Usuario.Activo (bool) Required, 1], [Property: Usuario.Apellido (string) Required, 2], [Property: Usuario.CreatedAt (DateTime) Required, 3], [Property: Usuario.Email (string) Index MaxLength(255), 4], [Property: Usuario.EmpresaId (int) Required FK Index, 5], [Property: Usuario.Nombre (string) Required, 6], [Property: Usuario.PasswordHash (string) Required, 7], [Property: Usuario.Rol (RolUsuario) Required, 8], [Property: Usuario.Rut (string) Index MaxLength(12), 9], [Property: Usuario.SucursalId (int?) FK Index, 10], [Property: Usuario.UltimoAcceso (DateTime?), 11], [Property: Usuario.UpdatedAt (DateTime?), 12] }
            SELECT TOP(1) u.Id, u.Activo, u.Apellido, u.CreatedAt, u.Email, u.EmpresaId, u.Nombre, u.PasswordHash, u.Rol, u.Rut, u.SucursalId, u.UltimoAcceso, u.UpdatedAt
            FROM Usuarios AS u
            WHERE (u.Email == @__8__locals1_registerDto_Email_0) && (u.EmpresaId == @__8__locals1_registerDto_EmpresaId_1), 
            False, 
            new HashSet<string>(
                new string[]{ }, 
                StringComparer.Ordinal
            )
        )].GetRelationalCommandTemplate(parameters), 
        readerColumns: null, 
        shaper: (queryContext, dataReader, resultContext, resultCoordinator) => 
        {
            Usuario entity;
            entity = 
            {
                MaterializationContext materializationContext1;
                IEntityType entityType1;
                Usuario instance1;
                materializationContext1 = new MaterializationContext(
                    [LIFTABLE Constant: ValueBuffer | Resolver: _ => (object)ValueBuffer.Empty], 
                    queryContext.Context
                );
                instance1 = default(Usuario);
                (object)dataReader.GetInt32(0) != null ? 
                {
                    ISnapshot shadowSnapshot1;
                    shadowSnapshot1 = [LIFTABLE Constant: Snapshot | Resolver: _ => Snapshot.Empty];
                    entityType1 = [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{0} => namelessParameter{0}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")];
                    instance1 = switch (entityType1)
                    {
                        case [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{1} => namelessParameter{1}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]: 
                            {
                                return 
                                {
                                    Usuario instance;
                                    instance = new Usuario();
                                    instance.<Id>k__BackingField = dataReader.GetInt32(0);
                                    instance.<Activo>k__BackingField = dataReader.GetBoolean(1);
                                    instance.<Apellido>k__BackingField = dataReader.GetString(2);
                                    instance.<CreatedAt>k__BackingField = dataReader.GetDateTime(3);
                                    instance.<Email>k__BackingField = dataReader.IsDBNull(4) ? default(string) : dataReader.GetString(4);
                                    instance.<EmpresaId>k__BackingField = dataReader.GetInt32(5);
                                    instance.<Nombre>k__BackingField = dataReader.GetString(6);
                                    instance.<PasswordHash>k__BackingField = dataReader.GetString(7);
                                    instance.<Rol>k__BackingField = Invoke(((EnumToNumberConverter<RolUsuario, int>)((IReadOnlyProperty)[LIFTABLE Constant: Property: Usuario.Rol (RolUsuario) Required | Resolver: namelessParameter{2} => namelessParameter{2}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindProperty("Rol")]).GetTypeMapping().Converter).ConvertFromProviderTyped, dataReader.GetInt32(8));
                                    instance.<Rut>k__BackingField = dataReader.IsDBNull(9) ? default(string) : dataReader.GetString(9);
                                    instance.<SucursalId>k__BackingField = dataReader.IsDBNull(10) ? default(int?) : (int?)dataReader.GetInt32(10);
                                    instance.<UltimoAcceso>k__BackingField = dataReader.IsDBNull(11) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(11);
                                    instance.<UpdatedAt>k__BackingField = dataReader.IsDBNull(12) ? default(DateTime?) : (DateTime?)dataReader.GetDateTime(12);
                                    (instance is IInjectableService) ? ((IInjectableService)instance).Injected(
                                        context: materializationContext1.Context, 
                                        entity: instance, 
                                        queryTrackingBehavior: NoTracking, 
                                        structuralType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{3} => namelessParameter{3}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")]) : default(void);
                                    return instance;
                                }}
                        default: 
                            default(Usuario)
                    }
                    ;
                    return instance1;
                } : 
                {
                    object[] keyValues1;
                    keyValues1 = new object[]{ (object)dataReader.GetInt32(0) };
                    return ShapedQueryCompilingExpressionVisitor.CreateNullKeyValueInNoTrackingQuery(
                        entityType: [LIFTABLE Constant: EntityType: Usuario | Resolver: namelessParameter{4} => namelessParameter{4}.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario")], 
                        properties: [LIFTABLE Constant: List<RuntimeProperty> { Property: Usuario.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd } | Resolver: c => c.Dependencies.Model.FindEntityType("Project_Gon.Core.Entities.Usuario").FindPrimaryKey().Properties], 
                        keyValues: keyValues1);
                };
                return instance1;
            };
            return entity;
        }, 
        contextType: Project_Gon.Infrastructure.Data.AppDbContext, 
        standAloneStateManager: False, 
        detailedErrorsEnabled: False, 
        threadSafetyChecksEnabled: True), 
    cancellationToken: queryContext.CancellationToken)'
2026-01-29 15:02:29.512 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 15:02:29.512 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 15:02:29.513 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 15:02:29.514 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 15:02:29.514 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 15:02:29.515 -03:00 [DBG] Executing DbCommand [Parameters=[@__8__locals1_registerDto_Email_0='?', @__8__locals1_registerDto_EmpresaId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt"
FROM "Usuarios" AS u
WHERE u."Email" = @__8__locals1_registerDto_Email_0 AND u."EmpresaId" = @__8__locals1_registerDto_EmpresaId_1
LIMIT 1
2026-01-29 15:02:29.517 -03:00 [INF] Executed DbCommand (2ms) [Parameters=[@__8__locals1_registerDto_Email_0='?', @__8__locals1_registerDto_EmpresaId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u."Id", u."Activo", u."Apellido", u."CreatedAt", u."Email", u."EmpresaId", u."Nombre", u."PasswordHash", u."Rol", u."Rut", u."SucursalId", u."UltimoAcceso", u."UpdatedAt"
FROM "Usuarios" AS u
WHERE u."Email" = @__8__locals1_registerDto_Email_0 AND u."EmpresaId" = @__8__locals1_registerDto_EmpresaId_1
LIMIT 1
2026-01-29 15:02:29.518 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 15:02:29.518 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 0ms reading results.
2026-01-29 15:02:29.519 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 15:02:29.520 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 15:02:30.095 -03:00 [DBG] 'AppDbContext' generated a temporary value for the property 'Usuario.Id'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2026-01-29 15:02:30.121 -03:00 [DBG] The navigation 'Usuario.Empresa' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2026-01-29 15:02:30.125 -03:00 [DBG] Context 'AppDbContext' started tracking 'Usuario' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2026-01-29 15:02:30.127 -03:00 [DBG] SaveChanges starting for 'AppDbContext'.
2026-01-29 15:02:30.129 -03:00 [DBG] DetectChanges starting for 'AppDbContext'.
2026-01-29 15:02:30.144 -03:00 [DBG] DetectChanges completed for 'AppDbContext'.
2026-01-29 15:02:30.173 -03:00 [DBG] Opening connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 15:02:30.174 -03:00 [DBG] Opened connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 15:02:30.175 -03:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2026-01-29 15:02:30.176 -03:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2026-01-29 15:02:30.176 -03:00 [DBG] Initialized DbCommand for 'ExecuteReader' (1ms).
2026-01-29 15:02:30.177 -03:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Boolean), @p1='?', @p2='?' (DbType = DateTime), @p3='?', @p4='?' (DbType = Int32), @p5='?', @p6='?', @p7='?' (DbType = Int32), @p8='?', @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Usuarios" ("Activo", "Apellido", "CreatedAt", "Email", "EmpresaId", "Nombre", "PasswordHash", "Rol", "Rut", "SucursalId", "UltimoAcceso", "UpdatedAt")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING "Id";
2026-01-29 15:02:30.186 -03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = Boolean), @p1='?', @p2='?' (DbType = DateTime), @p3='?', @p4='?' (DbType = Int32), @p5='?', @p6='?', @p7='?' (DbType = Int32), @p8='?', @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "Usuarios" ("Activo", "Apellido", "CreatedAt", "Email", "EmpresaId", "Nombre", "PasswordHash", "Rol", "Rut", "SucursalId", "UltimoAcceso", "UpdatedAt")
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING "Id";
2026-01-29 15:02:30.192 -03:00 [DBG] The foreign key property 'Usuario.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2026-01-29 15:02:30.197 -03:00 [DBG] Closing data reader to 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 15:02:30.198 -03:00 [DBG] A data reader for 'gon_db' on server 'tcp://localhost:5432' is being disposed after spending 10ms reading results.
2026-01-29 15:02:30.199 -03:00 [DBG] Closing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 15:02:30.200 -03:00 [DBG] Closed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 15:02:30.205 -03:00 [DBG] An entity of type 'Usuario' tracked by 'AppDbContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2026-01-29 15:02:30.207 -03:00 [DBG] SaveChanges completed for 'AppDbContext' with 1 entities written to the database.
2026-01-29 15:02:30.208 -03:00 [INF] [REGISTER] Usuario creado - ID: 4, RUT: 11111111-1, Email: admin@test.com
2026-01-29 15:02:30.215 -03:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2026-01-29 15:02:30.216 -03:00 [DBG] No information found on request to perform content negotiation.
2026-01-29 15:02:30.217 -03:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2026-01-29 15:02:30.217 -03:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2026-01-29 15:02:30.218 -03:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2026-01-29 15:02:30.218 -03:00 [INF] Executing CreatedAtActionResult, writing value of type 'Project_Gon.Core.DTOs.Auth.LoginResponseDto'.
2026-01-29 15:02:30.229 -03:00 [DBG] Found the endpoints ["Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)"] for address (action=[Login],controller=[Auth])
2026-01-29 15:02:30.232 -03:00 [DBG] Successfully processed template api/Auth/login for Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api) resulting in /api/Auth/login and 
2026-01-29 15:02:30.233 -03:00 [DBG] Link generation succeeded for endpoints ["Project_Gon.Api.Controllers.AuthController.Login (Project_Gon.Api)"] with result /api/Auth/login
2026-01-29 15:02:30.236 -03:00 [INF] Executed action Project_Gon.Api.Controllers.AuthController.Register (Project_Gon.Api) in 983.1061ms
2026-01-29 15:02:30.236 -03:00 [INF] Executed endpoint 'Project_Gon.Api.Controllers.AuthController.Register (Project_Gon.Api)'
2026-01-29 15:02:30.237 -03:00 [INF] HTTP POST /api/auth/register responded 201 in 1057.0426 ms
2026-01-29 15:02:30.238 -03:00 [DBG] 'AppDbContext' disposed.
2026-01-29 15:02:30.238 -03:00 [DBG] Disposing connection to database 'gon_db' on server 'tcp://localhost:5432'.
2026-01-29 15:02:30.239 -03:00 [DBG] Disposed connection to database 'gon_db' on server 'tcp://localhost:5432' (0ms).
2026-01-29 15:02:30.240 -03:00 [INF] Request finished HTTP/2 POST https://localhost:7058/api/auth/register - 201 null application/json; charset=utf-8 1063.2836ms
2026-01-29 15:04:41.872 -03:00 [DBG] Connection id "0HNIVBRS5KAG4" is closing.
2026-01-29 15:04:41.873 -03:00 [DBG] Connection id "0HNIVBRS5KAG4" is closed. The last processed stream ID was 5.
2026-01-29 15:04:41.874 -03:00 [DBG] The connection queue processing loop for 0HNIVBRS5KAG4 completed.
2026-01-29 15:04:41.874 -03:00 [DBG] Connection id "0HNIVBRS5KAG4" stopped.
2026-01-29 15:04:41.875 -03:00 [DBG] Connection id "0HNIVBRS5KAG4" sending FIN because: "The Socket transport's send loop completed gracefully."
